<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head>

<title>curn User's Guide</title>
<style type="text/css">
<!--
body
{
    background-color: white;
    color: black;
}

a
{
    text-decoration: none;
}

a:hover
{
    color: red;
    background-color: #eeeeee;
    text-decoration: underline;
}

h1
{
    color: #000000;
    font-family: serif;
}

p.title
{
    text-align: center;
    font-family: serif;
    font-weight: bold;
    font-style: roman;
    font-size: 20pt;
}

p.author
{
    text-align: center;
}

h1
{
    color: #990000;
    font-family: sans-serif;
    font-size: 18pt;
}

h2
{
    color: #000000;
    font-family: sans-serif;
    font-size: 16pt;
}

h3
{
    color: #000000;
    font-family: sans-serif;
}

h4
{
    color: #000000;
    font-family: sans-serif;
    font-size: 12pt;
}

h5
{
    color: #000000;
    font-family: serif;
    text-decoration: underline;
    margin-top: 3em;
    font-size: 9pt;
}

h6
{
    color: #000000;
    margin-top: 3em;
    font-family: sans-serif;
}

.code
{
    font-family: monospace, Courier New, Courier;
}

.env_var
{
    font-family: monospace, Courier New, Courier;
}

.filename
{
    font-family: monospace, Courier New, Courier;
}

.exampleHeader
{
    font-weight: bold;
    text-decoration: underline;
}

.url
{
    font-style: italic;
}

dl.dlSummary
{
    padding: 0.5em;
}

dl.dlSummary dt
{
    float: left;
    clear: left;
    width: 100px;
    text-align: right;
    font-weight: bold;
    color: black;
}

dl.dlSummary dt:after
{
    content: ":";
}

dl.dlSummary dd
{
    margin: 0 0 0 110px;
    padding: 0 0 0.5em 0;
}

ul.toc
{
    list-style-type: none;
    font-weight: bold;
}

ul.toc ul
{
    list-style-type: none;
    font-weight: bold;
}

ul.nobullet
{
    list-style-type: none;
}

ul.nobullet li
{
    margin-bottom: 5px;
    margin-left: -10px;
}

pre
{
    font-family: monospace, Courier New, Courier;
    padding-top: 0;
    padding-bottom: 0;
    margin-top: 0;
    margin-bottom: 0;
}

p.endnote
{
    text-indent: -2em;
    margin-left: 2em;
}

div.endnote
{
    margin-left: 2em;
}

table.outlined
{
    margin-top: 1em;
    border-width: 1px;
    border-spacing: 5px;
    border-style: solid;
    border-color: black;
    border-collapse: collapse;
}

table.outlined tr td
{
    padding: 3px;
}

table.cell-outlined td
{
    border: 1px solid black;
    padding-left: 5px;
    padding-right: 10px;
}

tr.col-headers
{
    background-color: white;
    border-bottom: 1px solid black;
}

table.cell-outlined tr.col-headers th
{
    border-left: 1px solid black;
    border-right: 1px solid black;
    border-top: 1px dashed black;
    padding-left: 5px;
    padding-right: 10px;
}

tr.title
{
    letter-spacing: 2pt;
    text-align: center;
    background-color: white;
    font-weight: bold;
    border: 1px dashed black;
}

table.colored
{
    background-color: #e9e9e9;
    border-collapse: collapse;
}

table.colored tr td
{
    padding-left: 15px;
}

table.uncolored
{
    background-color: white;
}

table.bordered
{
    border-collapse: collapse;
    border: 1px solid black;
}

table.uncolored tr td
{
    border: 1px solid black;
    padding: 2px;
    background-color: white;
}

table.unbordered
{
    border-collapse: collapse;
    border: none;
    background-color: white;
}

table.unbordered tr td
{
    border: none;
    padding-right: 8px;
    background-color: white;
}

/* Doesn't work yet in most browsers */
/*
tr:nth-child(odd)
{
    background-color: white;
}
*/

/* Doesn't work yet in most browsers */
/*
tr:nth-child(even)
{
    background-color: #c9c9c9;
}
*/

th
{
    font-weight: bold;
}

.plug-in-flag
{
    font-style: italic
}

.alert
{
    margin-left: 15em;
    margin-right: 15em;

    padding-bottom: 5px;
    padding-top: 5px;
    padding-left: 5px;
    padding-right: 5px;
    
    border-width: 3px;
    border-spacing: 5px;
    border-style: solid;
    border-color: red;
    border-collapse: collapse;

    background-color: #d9d9d9;
}

a.sectionRef
{
    font-weight: bold;
}

-->
</style>
<script language="JavaScript" type="text/javascript">
<!--
var ODD_COLOR = "#e9e9e9";
var EVEN_COLOR = "#ffffff";

// stripe() and hasClass(): adapted from
// http://www.alistapart.com/articles/zebratables/

function hasClass(obj)
{
     var result = false;
     if (obj.getAttributeNode("class") != null)
         result = obj.getAttributeNode("class").value;

     return result;
}

function supportsDOM()
{
    return document.getElementById &&
           document.childNodes &&
           document.createElement;
}

function stripe(id)
{
    // obtain a reference to the desired table
    // if no such table exists, abort
    var table = document.getElementById(id);
    if (! table)
        return;

    stripe(table);
}

function stripe(table)
{
    if (! supportsDOM())
        return;

    // the flag we'll use to keep track of
    // whether the current row is odd or even
    var even = false;

    //alert ("striping table with id " + table.getAttribute ("id"));

    // by definition, tables can have more than one tbody
    // element, so we'll have to get the list of child
    // <tbody> elements
    var tbodies = table.getElementsByTagName("tbody");

    // and iterate through them...
    for (var i = 0; i < tbodies.length; i++)
    {
        // Find all the <tr> elements.

        for (var j = 0; j < tbodies[i].rows.length; j++)
        {
	    var tr = tbodies[i].rows[j];

            // avoid rows that have a class attribute
            // or backgroundColor style
            if (tr.className  || tr.style.backgroundColor)
                continue;

            tr.style.backgroundColor = (even ? EVEN_COLOR : ODD_COLOR);

            // flip from odd to even, or vice-versa
            even =  ! even;
        }
    }
}

// Not adapted from

function stripeAll()
{
    var tables = document.getElementsByTagName ("table");
    for (var i = 0; i < tables.length; i++)
    {
        var classNames = tables[i].className;
        var classNameTokens = classNames.split (" ");
        var found = false;
        for (var j = 0; j < classNameTokens.length; j++)
        {
            if (classNameTokens[j] == "striped")
            {
                found = true;
	        break;
	    }
        }
        if (found)
            stripe (tables[i]);
    }
}

function init()
{
    stripeAll();
}
-->
</script>
</head>

<body onload="init()">

<p class="title"><i>curn</i>: Customizable Utilitarian RSS Notifier<br/>User's Guide</p>
<p class="author">Brian M. Clapper<br/>
<i>bmc&nbsp;@&nbsp;clapper&nbsp;.&nbsp;org</i><br/>
<span class="code">$Id$</span>
</p>
<hr/>

<!-- ********************************************************************** -->
<h1><a name="TOC"></a>Table of Contents</h1>

<ul class="toc">
  <li><a href="#Introduction">Introduction</a></li>

  <li><a href="#Terminology">Terminology</a></li>

  <li><a href="#CommandLine"><i>curn</i> Command Line Syntax</a>
      <ul class="toc">
        <li><a href="#CommandLineOptions">Command Line Options</a></li>
        <li><a href="#CommandLineParams">Command Line Parameters</a></li>
      </ul>
  </li>

  <li><a href="#ConfigFile">The <i>curn</i> Configuration File</a>
      <ul class="toc">
        <li><a href="#ConfigFileSyntax">Configuration File Syntax</a>
            <ul class="toc">
              <li><a href="#CfgSectionNameSyntax">Section Name Syntax</a></li>
              <li><a href="#CfgVariableNameSyntax">Variable Name Syntax</a></li>
              <li><a href="#CfgContinuationLines">Continuation Lines</a></li>

              <li><a href="#CfgExpansions">Expansions of Variable Values</a>
                  <ul class="toc">
                    <li><a href="#CfgMetacharacters">Metacharacter Expansion</a></li>
                    <li><a href="#CfgVariableSubst">Variable Substitution</a></li>
                    <li><a href="#CfgRawValues">Suppressing Metacharacter Expansion and Variable Substitution</a></li>
                  </ul>
              </li>
              <li><a href="#CfgPathNames">Path Names</a>
              <li><a href="#CfgIncludes">Includes</a></li>
              <li><a href="#CfgComments">Comments and Blank Lines</a></li>
            </ul>
        </li>

        <li><a href="#CurnConfigFile">Overview of <i>curn</i>'s Configuration File</a></li>
        <li><a href="#CfgCurnSection">The <span class="code">[curn]</span> Section</a></li>
        <li><a href="#CfgRSSFeeds">Configuring the RSS Feeds</a></li>
        <li><a href="#CfgOutputHandlers">Configuring Output Handlers</a>
            <ul class="toc">
              <li><a href="#CfgOutputHandlerSections">Output Handler Sections</a></li>
              <li><a href="#CfgPredefinedOutputHandlers">Predefined Output Handlers</a>
                  <ul class="toc">
                    <li><a href="#FreeMarkerOutputHandler" class="code">FreeMarkerOutputHandler</a>
                    <li><a href="#HTMLOutputHandler" class="code">HTMLOutputHandler</a>
                    <li><a href="#TextOutputHandler" class="code">TextOutputHandler</a>
                    <li><a href="#SimpleSummaryOutputHandler" class="code">SimpleSummaryOutputHandler</a>
                    <li><a href="#ScriptOutputHandler" class="code">ScriptOutputHandler</a>
                  </ul>
              <li><a href="#CfgOutputHandlerExamples">Examples</a>
            </ul>
        </li>
      </ul>
  </li>

  <li><a href="#SchedulingCurn">Having <i>curn</i> Run on a Schedule</a>
      <ul class="toc">
        <li><a href="#UsingCron">Running <i>curn</i> from <i>cron</i>(8) on UNIX-like Systems</a></li>
        <li><a href="#UsingWindowsScheduler">Running <i>curn</i> via the Windows Scheduler</a></li>
      </ul>
  </li>

  <li><a href="#Bandwidth">Being "Bandwidth Friendly"</a>
      <ul class="toc">
        <li><a href="#NotTooOften">Don't Run <i>curn</i> Too Often</a>
        <li><a href="#ConsolidateCommonFeeds">Consolidate Common Feeds</a>
      </ul>
  </li>

  <li><a href="#ExtendingCurn">Extending <i>curn</i></a>
      <ul class="toc">
        <li><a href="#UnsupportedParser">Using an Unsupported RSS Parser</a></li>
	<li><a href="#Plug-ins">Plug-ins</a>
	    <ul class="toc">
	      <li><a href="#PlugInOverview">Overview of Plug-In Support</a>
	      <li><a href="#StockPlugIns">Stock Plug-ins</a>
	      <li><a href="#PlugInInstallation">Installing New Plug-ins</a>
	      <li><a href="#PlugInWriting">Writing <i>curn</i> Plug-ins</a>
	      <ul class="toc">
		<li><a href="#PlugInAPI">The <i>curn</i> Plug-in API</a>
		<li><a href="#ExamplePlugIn">A Simple Example Plug-in</a>
		<li><a href="#PlugInMetadata">Persisting Data from a Plug-in</a>
	      </ul>
	    </ul>

        <li><a href="#CustomizingOutput">Customizing <i>curn</i>'s Output</a>

	    <ul>
	      <li><a href="#WriteFreeMarkerTemplate">Writing Your Own FreeMarker Template</a>
	      <li><a href="#NewOutputHandler">Writing Your Own Output Handler</a>
	          <ul class="toc">
		    <li><a href="#NewJavaOutputHandler">Writing a Java Output Handler</a></li>
		    <li><a href="#NewScriptOutputHandler">Writing a Script Output Handler</a>
  		        <ul class="toc">
			  <li><a href="#SupportedScriptingLanguages">Supported Scripting Languages</a>
			  <li><a href="#AdditionalScriptingLanguages">Supporting Additional Scripting Languages</a>
			  <li><a href="#WritingScript">Writing the Script</a>
			  <li><a href="#ConfigScriptOutputHandler">Configuring the Script Output Handler</a>
			</ul>
                  </ul>
                </li>
            </ul>
        </li>
	<li><a href="#InstallingSupportSoftware">Installing Supporting Software</a>
      </ul>
  </li>

  <li><a href="#Troubleshooting">Troubleshooting</a>
      <ul>
        <li><a href="#Logging">Logging</a>
	    <ul>
	      <li><a href="#java.util.logging" class="code">java.util.logging</a></li>
	      <li><a href="#Log4J">Log4J</a></li>
	    </ul></li>
      </ul></li>

  <li><a href="#AppendixA">Appendix A: Similar Products and Tools</a></li>
  <li><a href="#AppendixB">Appendix B: Copyrights</a></li>
  <li><a href="#EndNotes">End Notes</a></li>
</ul>

<!-- ********************************************************************** -->
<h1><a name="Introduction"></a>Introduction</h1>

<p><i>curn</i> is an RSS reader. It scans a configured set of URLs, each
one representing an RSS feed, and summarizes the results. By default,
<i>curn</i> keeps track of individual items within each RSS feed, using an
on-disk cache; when using the cache, it will suppress displaying information
for items it has already processed (though that behavior can be disabled).</p>

<p>Unlike many RSS readers, <i>curn</i> does not use a graphical user
interface. It is a command-line utility, intended to be run periodically in
the background by a command scheduler such as
<a href="http://www.freebsd.org/cgi/man.cgi?query=cron&amp;apropos=0&amp;sektion=0&amp;manpath=FreeBSD+5.2-RELEASE+and+Ports&amp;format=html"><i>cron</i>(8)</a>
(on UNIX-like systems) or the Windows Scheduler Service (on Windows).</p>

<p><i>curn</i> can read RSS feeds from any URL that's supported by Java's
runtime. When querying HTTP sites, <i>curn</i> uses the HTTP
<span class="code">If-Modified-Since</span> and
<span class="code">Last-Modified</span> headers to suppress
retrieving and processing feeds that haven't changed. By default, it also
requests that the remote HTTP server <i>gzip</i> the XML before sending it.
(Some HTTP servers honor the request; some don't.) These measures both minimize
network bandwidth and ensure that <i>curn</i> is as kind as possible to the
remote RSS servers. (There are some <a href="#Bandwidth">additional steps</a>
you can take to be more bandwidth-friendly.)</p>

<i>curn</i> comes with built-in adapters for the
<a href="https://rome.dev.java.net/">ROME</a> and
<a href="http://informa.sourceforge.net/">Informa</a> feed parsers, but
it can easily be extended to use any RSS parser.
By default, <i>curn</i> uses the
<a href="https://rome.dev.java.net/">ROME</a> parser, which
handles all known RSS feed formats.
See the <a href="#Cfg_ParserClass" class="code">ParserClass</a> configuration
item for information on how to specify which parser <i>curn</i> should use.
See the section entitled
<a href="#UnsupportedParser" class="sectionRef">Using an Unsupported RSS Parser</a> for more
details on adapting <i>curn</i> to use other RSS parsers.</p>

<p><i>curn</i> supports a several output formats; you can configure
one or more output handlers in <i>curn</i>'s
<a href="#ConfigFile">configuration file</a>. In addition, someone conversant
with Java programming or comfortable with a scripting language, such as
Python or Ruby, can easily extend <i>curn</i> to handle a new output
format. See the section entitled
<a href="#NewOutputHandler" class="sectionRef">Writing Your Own Output Handler</a> for more
details. Finally, as of version 2.6, <i>curn</i> has a built-in template-driven
output handler, based on the
<a href="http://freemarker.sourceforge.net/">FreeMarker</a> template engine;
The <a href="#FreeMarkerOutputHandler" class="code">FreeMarkerOutputHandler</a>
this handler uses a text template
to generate output, so anyone conversant with FreeMarker can easily write
his own template to generate custom output. See the section describing the
<a href="#FreeMarkerOutputHandler" class="code, sectionRef">FreeMarkerOutputHandler</a>
for more details.</p>

<p><i>curn</i>'s predefined output handlers can generate:</p>

<ul>
  <li><a href="output/TextOutput.txt">plain text output</a>,
      suitable for emailing to people who can't handle HTML email
  <li>a <a href="output/SummaryOutput.txt">plain text summary</a> of
      the number of new items in each feed
  <li>rich <a href="output/HTMLOutput.html">rich HTML output</a>, with
      hyperlinks to the actual items on the web.
</ul>

<p>In addition, <i>curn</i> supports emailing its output. If email
addresses are specified <a href="#MailOutputTo">in the configuration file</a>,
then <i>curn</i> creates a MIME multipart/alternative email
message&nbsp;<a href="#Note1">[1]</a>, using
the output of each output handler as one of the alternative attachments.</p>

<!-- ********************************************************************** -->
<h1><a name="Terminology"></a>Terminology</h1>

<p>Throughout this document, the following terms are used:</p>

<ul>
  <li><i>curn_home</i> is the <i>curn</i> installation directory.
  <li><i>user_home</i> is the home directory of the user who's running
      <i>curn</i>.(On Windows, the
       <a href="#curn-script" class="code">curn.bat</a> front-end command
       script uses the value of the <span class="env_var">%HOME%</span> variable
       to override the Java VM's notion of the user's home directory, if
       <span class="env_var">%HOME%</span> is set.)
</ul>

<!-- ********************************************************************** -->
<h1><a name="CommandLine"></a><i>curn</i> Command Line Syntax</h1>

<p><i>curn</i> is invoked from the command line as follows:</p>

<blockquote><pre>curn</pre></blockquote>

<p><a name="curn-script"></a>
The <i>curn</i> graphical installer automatically creates a Unix shell
script (called <span class="code">curn</span>) or a Windows command file
(<span class="code">curn.bat</span>) in the
<span class="filename">bin</span> directory beneath the <i>curn</i> installation
directory. You must put the <i>curn</i> <span class="filename">bin</span> directory
in your path.</p>

<div class="alert">
<a name="PleaseUseTheScript"></a>
<p>Note: While it is possible to invoke <i>curn</i> via the <i>java</i>
command, it's not recommended. For <i>curn</i>'s
<a href="#Plug-ins">plug-ins</a> to work properly, <i>curn</i> must do some
fancy <a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/ClassLoader.html">class loader</a> footwork.
Basically, <i>curn</i> uses a special bootstrap class to
find all plug-ins and create a special
<a name="ClassLoader"></a>class loader that can load 
everything&#8212;plug-ins, core code, etc. If you don't invoke <i>curn</i> via
the bootstrap class, the plug-ins don't load properly.
The <i>curn</i> shell script and command file handle invoking <i>curn</i>
so that plug-ins will work properly.</p>
</div>

<p><i>curn</i>'s command line uses a UNIX-like syntax. If you invoke
<i>curn</i> without any parameters, you get the following usage display.

<br/><br/>
<table summary="" class="bordered uncolored" align="center">
  <tr valign="top">
    <td align="left">
<blockquote><pre>
Usage: curn [options] config

OPTIONS:

-B, --build-info  Show full build information, then exit. This option shows a
                  bit more information than the --version option. This option
                  can be combined with the --plug-ins option to show the
                  loaded plug-ins.
-C, --no-cache    Don't use a cache file at all.
--logging         Enable logging via Jakarta Commons Logging.
-p, --plug-ins    Show the list of located plug-ins and output handlers, then
                  exit. This option can be combined with either --build-info
                  or --version to show version information, as well.
-t, --time &lt;time&gt; For the purposes of cache expiration, pretend the current
                  time is &lt;time&gt;. &lt;time&gt; may be in one of the following
                  formats.
                  2006/06/08 02:59:36 PM
                  2006/06/08 02:59:36
                  2006/06/08 02:59 PM
                  2006/06/08 02:59
                  2006/06/08 2:59 PM
                  2006/06/08 2:59
                  2006/06/08 02 PM
                  2006/06/08 2 PM
                  2006/06/08 14:59:36
                  2006/06/08 14:59
                  2006/06/08
                  06/06/08
                  02:59:36 PM
                  02:59:36
                  02:59 PM
                  02:59
                  2:59 PM
                  2:59
                  02 PM
                  2 PM
                  14:59:36 PM
                  14:59:36
                  14:59 PM
                  14:59
-u, --no-update   Read the cache, but don't update it.
-v, --version     Show version information, then exit. This option can be
                  combined with the --plug-ins option to show the loaded
                  plug-ins.

PARAMETERS:

config  Path to configuration file
</pre></blockquote>
    </td>
  </tr>
</table>
<br clear="all"/>

<p>Many of <i>curn</i>'s command-line options simply override settings in the
<a href="#ConfigFile"><i>curn</i> configuration file</a>.
Each option and argument is discussed in more detail, below.</p>

<h2><a name="CommandLineOptions"></a>Command Line Options</h2>

<table summary="" class="outlined striped" align="center" width="90%">
  <tr valign="top" class="title">
    <th align="center" colspan="3">OPTIONS</th>
  </tr>

  <tr valign="bottom" class="col-headers">
    <th align="left">Short Option</th>
    <th align="left">Long Option</th>
    <th align="left">Explanation</th>
  </tr>

  <tbody>
  <tr valign="top">
    <td align="left" class="code">-B</td>
    <td align="left" class="code"><a name="opt-build-info"></a>--build-info</td>
    <td>Display detailed information about how and when <i>curn</i>
        was built, then exit without doing anything. Useful primarily
        when debugging or submitting problem reports. For instance,
        the command
        <blockquote><pre>curn -B</pre></blockquote>
        products output similar to the following:
        <blockquote><pre>curn, version 3.0 (build 20060608.185936.321)

Build:          20060608.185936.321
Build date:     2006/06/08 14:59:36 EDT
Built by:       bmc on sunball.inside.clapper.org
Built on:       Linux 2.6.16-1.2122_FC5smp (i386)
Build Java VM:  Java HotSpot(TM) Client VM 1.5.0_07-b03 (Sun Microsystems Inc.)
Build compiler: javac
Ant version:    Apache Ant version 1.6.5 compiled on June 2 2005</pre>
</blockquote>
        <p>For a simple one-line version display, use the
        <a href="#opt-version" class="code">--version</a> option.</p>
    </td>
  </tr>

  <tr valign="top">
    <td align="left" class="code">-C</td>
    <td align="left" class="code"><a name="opt-no-cache"></a>--no-cache</td>
    <td>Run without a cache. Each RSS item <i>curn</i> encounters will
        appear to be new and will be passed to the output handlers.
        Also see the <a href="#Cfg_CacheFile" class="code">CacheFile</a>
        configuration directive.
    </td>
  </tr>

  <tr valign="top">
    <td align="left">&nbsp;</td>
    <td><a name="opt-logging" class="code">--logging</a></td>
    <td>Enable logging via the <span class="code">java.util.logging</span>
        API. You will also have to specify a logging configuration file
        via a <span class="code">-Djava.util.logging.config.file</span>
        system property. For instance,
        <blockquote><pre>java -Djava.util.logging.config.file=/tmp/logging.properties org.clapper.curn.Tool --logging ...</pre></blockquote>
      See the section entitled <a href="#Logging" class="sectionRef">Logging</a>
      for more details on specifying logging parameters.
    </td>
  </tr>

  <tr valign="top">
    <td align="left" class="code">-t&nbsp;&lt;time&gt;</td>
    <td align="left" class="code">--time&nbsp;&lt;time&gt;</td>
    <td><p>For the purposes of cache expiration, pretend the current time
        is &lt;time&gt;, instead of the wall clock time. &lt;time&gt;
        may be specified in one of the following formats:</p>

        <blockquote>
        <p>2004/07/22 09:37:29 AM<br/>
        2004/07/22 09:37:29<br/>
        2004/07/22 09:37 AM<br/>
        2004/07/22 09:37<br/>
        2004/07/22 9:37 AM<br/>
        2004/07/22 9:37<br/>
        2004/07/22 09 AM<br/>
        2004/07/22 9 AM<br/>
        2004/07/22<br/>
        04/07/22<br/>
        09:37:29 AM<br/>
        09:37:29<br/>
        09:37 AM<br/>
        09:37<br/>
        9:37 AM<br/>
        9:37<br/>
        09 AM<br/>
        9 AM</p>

        <p>This option is useful primarily for debugging. Before reading
        the RSS feeds, <i>curn</i> first loads its cache and prunes any
        cache entries that are out of date. When pruning
        its cache of out-of-date items, or when loading cache items,
        <i>curn</i> will behave as if the current time is the specified
        time.</p>
        </blockquote>
    </td>
  </tr>

  <tr valign="top">
    <td align="left" class="code">-u</td>
    <td align="left" class="code"><a name="opt-no-update"></a>--no-update</td>
    <td>Load (and prune) the cache file before processing the RSS feeds,
        but do not save the modified in-memory cache back to disk. Useful
        primarily for debugging.
    </td>
  </tr>

  <tr valign="top">
    <td align="left" class="code">-v</td>
    <td align="left" class="code"><a name="opt-version"></a>--version</td>
    <td>Show just the one-line version information, then exit. For
        more detailed <i>curn</i> build and version information, use
        the <a href="#opt-build-info" class="code">--build-info</a>
        option.
    </td>
  </tr>

  </tbody>

</table>
<br clear="all"/>

<h2><a name="CommandLineParameters"></a>Command Line Parameters</h2>

<p>A list of <i>curn</i>'s positional parameters follows.</p>

<table summary="" class="outlined striped" align="center" width="90%">

  <tr valign="top" class="title">
    <th align="center" colspan="3">PARAMETERS</th>
  </tr>

  <tr valign="bottom" class="col-headers">
    <th align="left">Positional Parameter</th>
    <th align="left">Explanation</th>
  </tr>

  <tbody>
  <tr valign="top">
    <td align="left" class="code">config</td>
    <td>The path or URL to the <i>curn</i>
        <a href="#ConfigFile">configuration file</a>. This parameter
        is required.
    </td>
  </tr>
  </tbody>
</table>
<br clear="all"/>

<!-- ********************************************************************** -->
<h1><a name="ConfigFile">The <i>curn</i> Configuration File</a></h1>

<p><i>curn's</i> configuration file controls all aspects of <i>curn</i>'s
behavior. The configuration file contains parameters that control <i>curn</i>'s
behavior, the output handlers, and the individual RSS feed sites. This
section first describes the overall configuration file syntax, and then
describes each <i>curn</i> configuration item in detail.</p>

<p>You can view a sample <i>curn</i> configuration file by following
<a href="sample.cfg">this link</a>.</p>

<h2><a name="ConfigFileSyntax"></a>Configuration File Syntax</h2>

<p><i>curn</i>'s configuration file is a simple text file. It resembles
a standard Java properties file, but it is broken into individual sections,
each of which has its own variable namespace. At a glance, the configuration
file is reminiscent of a Windows .INI file, but there are quite a few
differences.&nbsp;<a href="#Note2">[2]</a>.</p>

<p>Like a .INI file, each section in the configuration file consists of
a name surrounded by brackets. Each section contains variable assignments;
the variable assignment syntax is similar to that of a Java properties file.
For example:</p>

<table summary="" class="bordered uncolored" align="center">
  <tr valign="top">
    <td align="left">
<blockquote><pre>
[curn]
CacheFile: /home/bmc/.curn/cache
DaysToCache: NoLimit
ParserClass: org.clapper.curn.parser.rome.RSSParserAdapter
...
</pre></blockquote>
    </td>
  </tr>
</table>
<br clear="all"/>

<h3><a name="CfgSectionNameSyntax"></a>Section Name Syntax</h3>

<p>There can be any amount of whitespace before and after the brackets in a
section name; the whitespace is ignored. That is.
"<span class="code">[curn]</span>",
"<span class="code">[  curn]</span>" and
"<span class="code">[   curn   ]</span>" all specify a section named
"curn".</p>

<h3><a name="CfgVariableNameSyntax"></a>Variable Name Syntax</h3>

<p>Each section contains zero or more variable settings. Similar to a Java
properties file, the variables are specified as name/value pairs, separated
by an equals sign ("=") or a colon (":"). Variable names are case-sensitive
and may contain any printable character (including white space), other than
'$' '{', and '}'. Variable values may contain anything at all. The parser
ignores whitespace on either side of the "=" or ":"; that is, leading
whitespace in the value is skipped. The way to include leading whitespace
in a value is escape the whitespace characters with backslashes. (See
below).</p>

<h3><a name="CfgContinuationLines"></a></h3>

<p>Variable definitions may span multiple lines; each line to be continued
must end with a backslash ("\") character, which escapes the meaning of the
newline, causing it to be treated like a space character. The following
line is treated as a logical continuation of the first line; however, any
leading whitespace is removed from continued lines. For example, the
following four variable assignments all have the same value:</p>

<table summary="" class="bordered uncolored" align="center">
  <tr valign="top">
    <td align="left">
<blockquote><pre>
[test]
a: one two three
b:            one two three
c: one two \
three
d:        one \
two \
three
</pre></blockquote>
    </td>
  </tr>
</table>
<br clear="all"/>

<p>Because leading whitespace is skipped, all four variables have the
value "one two three".</p>

<p>Only variable definition lines may be continued. Section header
lines, comment lines (see below) and include directives (see below)
cannot span multiple lines.</p>


<h3><a name="CfgExpansions"></a>Expansions of Variable Values</h3>

<p>The configuration parser preprocesses each variable's value, expanding
embedded metacharacter sequences and substituting variable references. (See
below.) You
can use backslashes to escape the special characters that the parser uses
to recognize metacharacter and variable sequences; you can also use single
quotes. See <a href="#CfgRawValues">Suppressing Metacharacter Expansion and
Variable Substitution</a>, below, for more details.</p>

<h4><a name="CfgMetacharacters"></a>Metacharacter Expansion</h4>

<p>Within a variable's value, Java-style ASCII escape sequences
<span class="code">\t</span>, <span class="code">\n</span>,
<span class="code">\r</span>, <span class="code">\\</span>,
<span class="code">\&#0034;</span>, <span class="code">\'</span>,
<span class="code">\&nbsp;</span> (a backslash and a space), and
<span class="code">\u</span><i>xxxx</i> are recognized and converted to
single characters. Note that metacharacter expansion is performed
<i>before</i> variable substitution.</p>

<h4><a name="CfgVariableSubst"></a>Variable Substitution</h4>

<p>A variable's value can interpolate the values of other variables, using a
variable substitution syntax reminiscent of the Unix shell (The syntax is
also similar to the 
<a href="http://ant.apache.org/"><i>ant</i></a> variable
substitution syntax).
The general form of a variable reference is
<span class="code">${sectionName:varName}</span>.
<span class="code">sectionName</span> is the name of the section containing the
variable to substitute; if omitted, it defaults to the current section.
<span class="code">varName</span> is the name of the variable to
substitute. If the variable has an empty value, an empty string is
substituted. If the variable (or the referenced section) does not exist,
the <i>curn</i> will abort. If a variable reference
specifies a section name, the referenced section must precede the current
section. It is not possible to substitute the value of a variable in a
section that occurs later in the file.</p>

<p>The section names "system", "env", and "program" are reserved for
special "pseudosections."</p>

<p>The "system" pseudosection is used to interpolate values from Java's
<span class="code">System.properties</span> class. For instance,
<span class="code">${system:user.home}</span> substitutes the value of the
<span class="code">user.home</span> system property (typically, the home directory of the
user running <i>curn</i>). Similarly,
<span class="code">${system:user.name}</span> substitutes the user's
name.</p>

<p>The "env" pseudosection is used to interpolate values from the environment.
On UNIX systems, for instance, <span class="code">${env:HOME}</span>
substitutes user's home directory (and is, therefore, a synonym for
<span class="code">${system:user.home}</span>. On some versions of Windows,
<span class="code">${env:USERNAME}</span> will substitute the name of
the user running <i>curn</i>. Note: On UNIX systems, environment variable
names are typically case-sensitive; for instance,
<span class="code">${env:USER}</span> and
<span class="code">${env:user}</span> refer to different environment
variables. On Windows systems, environment variable names are typically
case-insensitive;
<span class="code">${env:USERNAME}</span> and
<span class="code">${env:username}</span> are equivalent.</p>

<p>The "program" pseudosection is a placeholder for various special variables
provided by the <span class="code">Configuration</span> class at runtime.
Those variables are:</p>

<table summary="" class="outlined striped" width="90%" align="center">

  <tr valign="bottom" class="col-headers">
    <th align="left">"<span class="code">program</span>" Section Variable</th>
    <th align="left">Explanation</th>
  </tr>

  <tbody>
  <tr valign="top">
    <td align="left" class="code">cwd</td>
    <td align="left">The program's current working directory. Thus,
      <span class="code">${program:cwd}</span> will substitute the
      current working directory, with an appropriate path separator for
      the host operating system (e.g., "\" for Windows, "/" for UNIX.)
    </td>
  </tr>

  <tr valign="top">
    <td align="left" class="code">cwd.url</td>
    <td align="left">The program's current working directory, as a
      <span class="code">file</span> URL, without the trailing "/".
      Useful when you need to create a URL reference to something
      relative to the current directory. This is especially helpful
      on Windows, where
      <blockquote><pre>file://${program:cwd}/something.txt</pre></blockquote>
      produces an invalid URL, with a mixture of backslashes and
      forward slashes.  By contrast,
      <blockquote><pre>${program:cwdURL}/something.txt</pre></blockquote>
      always produces a valid URL, regardless of the underlying host
      operating system.
    </td>
  </tr>

  <tr valign="top">
    <td align="left" class="code">now</td>
    <td align="left">The current time, formatted by calling
    <span class="code">java.util.Date.toString()</span> with the default locale.
      The program's current working directory. For example,
      <span class="code">${program:now}</span> would produce something
      like "Fri Aug 20 15:18:56 EDT 2004" on a machine with a default
      English locale.
    </td>
  </tr>

  <tr valign="top">
    <td align="left" class="code">now&nbsp;<i>delim</i>&nbsp;<i>fmt</i>&nbsp;[<i>delim</i>&nbsp;<i>lang&nbsp;delim&nbsp;country</i>]]</td>
    <td align="left">
      The current date/time, formatted with the specified
      <span class="code">java.text.SimpleDateFormat</span>
      format string. If specified, the given locale and country code
      will be used; otherwise, the default system locale will be
      used. <i>lang</i> is a Java language code, such as "en", "fr",
      etc. <i>country</i> is a 2-letter country code, e.g., "UK",
      "US", "CA", etc. <i>delim</i> is a user-chosen delimiter that
      separates the variable name ("<span class="code">now</span>")
      from the format and the optional locale fields. The delimiter
      can be anything that doesn't appear in the format string, the
      variable name, or the locale. For example:
      <blockquote>
      <table summary="" class="bordered uncolored" align="center">
        <tr valign="top">
          <td class="code" nowrap>${program:now|yyyy.MM.dd 'at' hh:mm:ss z}</td>
          <td>2004.08.20 at 03:26:27 EDT</td>
        </tr>
        <tr valign="top">
          <td class="code" nowrap>${program:now/yyyy.MM.dd 'at' HH:mm:ss z/en/US}</td>
          <td>2004/08/20 at 15:28:37 EDT</td>
        </tr>
        <tr valign="top">
          <td class="code" nowrap>${program:now|dd MMM, yyyy HH:mm:ss z|fr|FR}</td>
          <td>20 ao&auml;t, 2004 at 03:30:29 EDT</td>
        </tr>
      </table>
      </blockquote>

      <p>Note: <span class="code">SimpleDateFormat</span> requires
      that literal strings (i.e., strings that should not be
      processed as part of the format) be enclosed in quotes. For
      instance:</p>

      <blockquote><pre>yyyy.MM.dd 'at' hh:mm:ss z</pre></blockquote>

      <p>Because single quotes are special characters in
      configuration files, it's important to escape them if you use
      them inside date formats. So, to include the above string in a
      configuration file's <span class="code">${program:now}</span>
      reference, use the following:</p>

      <blockquote><pre>${program:now/yyyy.MM.dd \'at\' hh:mm:ss z}</pre></blockquote>

      <p>See <a href="#CfgRawValues">Suppressing Metacharacter Expansion
      and Variable Substitution</a>, below, for more details.</p>
    </td>
  </tr>
</table>
<br clear="all"/>

<p>For example:</p>

<table summary="" class="outlined striped" width="90%" align="center">

  <tr valign="bottom" class="col-headers">
    <th align="left">Variable Reference</th>
    <th align="left">Explanation</th>
    <th align="left">Sample</th>
  </tr>

  <tbody>
  <tr valign="top">
    <td align="left" class="code">${system:user.home}</td>
    <td align="left">Substitutes the value of the system property
      "<span class="code">user.home</span>" (usually set to the current
      user's home directory).
    </td>
    <td align="left">
    <pre>[curn]
myCurnDir = <b>${system:user.home}</b>/.curn</pre>
    </td>
  </tr>

  <tr valign="top">
    <td align="left" class="code">${curn:myCurnDir}</td>
    <td align="left">Substitutes the value of variable
      "<span class="code">myCurnDir</span>" from section the
      <span class="code">[curn]</span> section.</td>
    <td><pre>[Feed_Wired]
URL: http://www.wired.com/news_drop/netcenter/netcenter.rdf
SaveAs: <b>${curn:myCurnDir}/feeds/wired.rdf</b></pre>
    </td>
  </tr>

  <tr valign="top">
    <td align="left" class="code">${myCurnDir}</td>
    <td align="left">Substitutes the value of variable
      "<span class="code">myCurnDir</span>" from the current section.
    </td>
    <td><pre>[curn]
myCurnDir = ${system:user.home}/.curn
CacheFile = <b>${myCurnDir}</b>/cache</pre>
    </td>
  </tr>

  </tbody>
</table>
<br clear="all"/>

<p>The configuration file also supports a simple conditional-substitution
logic, which allows you to specify a default value to be substituted if a
variable is empty or does not have a value. The general form of a conditional
substitution is:</p>

<blockquote><pre>
${var?some default value}
</pre></blockquote>

If ${var} does not have a value, or has an empty string as its value,
the string "some default value" will be substituted.</p>

<h4><a name="CfgRawValues"></a>Suppressing Metacharacter Expansion and Variable Substitution</h4>

<p>To prevent the parser from interpreting metacharacter sequences,
variable substitutions and other special characters, enclose part or
all of the value in single quotes. (See <a href="#Note3">[3]</a> for additional
comments.) For example, suppose you want to set variable "prompt" to the
literal value "Enter value. To specify a newline, use \n." The following
configuration file line will do the trick:</p>

<blockquote><pre>prompt: 'Enter value. To specify a newline, use \n'</pre></blockquote>

<p>Similarly, to set variable "abc" to the literal string "${foo}"
suppressing the parser's attempts to expand "${foo}" as a variable
reference, you could use:</p>

<blockquote><pre>abc: '${foo}'</pre></blockquote>

<p>To include a literal single quote, you must escape it with a backslash.</p>

<h3><a name="CfgPathNames"></a>Path Names</h3>

<p>Regardless of the underlying operating system, path names in the
<i>curn</i> configuration file can always use Unix-style forward slash ("/")
characters. At runtime <i>curn</i> will convert the path names to use the
appropriate file separator (e.g., "\" on Windows). This capability provides
two benefits:</p>

<ol>
  <li>It enhances the portability of <i>curn</i> configuration files.</li>
  <li>It provides a means to avoid using (and, therefore, having to escape)
  backslash characters in the configuration file.</li>
</ol>

<h3><a name="CfgIncludes"></a>Includes</h3>

<p>A special <i>include</i> directive permits inline inclusion of another
configuration file. The include directive takes two forms:

<blockquote><pre>
%include "path"
%include "URL"
</pre></blockquote>

<p>For example:</p>

<blockquote><pre>
%include "/home/bmc/mytools/common.cfg"
%include "file:///home/bmc/mytools/common.cfg"
</pre></blockquote>

<p>The included file may contain any content that is valid for this parser.
It may contain just variable definitions (i.e., the contents of a section,
without the section header), or it may contain a complete configuration
file, with individual sections. Since the parser recognizes a variable
syntax that is essentially identical to Java's properties file syntax, it's
also legal to include a properties file, provided it's included within a
valid section.</p>

<p>Attempting to include a file from itself, either directly or indirectly,
will cause <i>curn</i> to abort processing.</p>

<h3><a name="CfgComments"></a>Comments and Blank Lines</h3>

<p>A comment line is a one whose first non-whitespace character is a "#" or
a "!". This comment syntax is identical to the one supported by a Java
properties file. A blank line is a line containing no content, or one
containing only whitespace. Blank lines and comments are ignored. For
example:</p>

<table summary="" class="outlined" align="center" width="60%">
  <tr valign="top">
    <td align="left">
<blockquote><pre>
[curn]

# ---------------------------------------------------------------------------
# CacheFile: The full path to the file in which curn should cache URLs.
#            curn uses the cache file to keep track of which URLs it
#            has already received and displayed, and when it received them.
#            Under normal operation, curn won't display a URL it has
#            already displayed and cached.
#
#            This path may contain the ~ metacharacter, to denote the
#            invoking user's home directory.
#
#            The use of a cache can be disabled by omitting this parameter.
#            Use the "NoCacheUpdate" parameter to tell curn to read,
#            but not update, the cache.
#
# See also: Configuration parameter "NoCacheUpdate"
#           Command line parameter -C, --nocache
#
# OPTIONAL. Default: None

CacheFile: test.cache
</pre></blockquote>
    </td>
  </tr>
</table>
<br clear="all"/>

<h2><a name="CurnConfigFile">Overview of <i>curn's</i> Configuration File</a></h2>

<p><i>curn</i>'s configuration file has three kinds of sections:</p>

<ul>
  <li>The main section, named "curn", contains global parameters. Some of
      these parameters can be overridden on the command-line. Others can
      be overridden on a per-feed basis.

  <li>Output handler sections, each specifying an output handler that will
      process parsed feed data and (presumably) produce output.
      There can be any number of these sections.

  <li>Feed sections, each specifying a single RSS feed to be downloaded,
      parsed and processed.
</ul>

<p>All other sections in the configuration file are parsed (and subject to
syntactic constraints), but otherwise ignored. Thus, it's perfectly legal
to have a separate section, e.g., "<span class="code">[var]</span>", where
you define variables that exist solely to be substituted into other
sections.</p>

<p>Any boolean parameter (i.e., one documented as taking a <span class="code">true</span> or <span class="code">false</span>
value) can also take a value of "0" (false), "1" (true), "no" (false) or
"yes" (true).</p>

<h2><a name="CfgCurnSection">The <span class="code">[curn]</span> Section</a></h2>

<p>This section contains variable global parameters. Each is described in
detail, below. (Parameters marked with
<span class="plug-in-flag">plug-in</span> are handled by one of <i>curn</i>'s
<a href="#StockPlugIns">stock plug-ins</a>, rather than by the core code.)</p>

<table summary="" class="outlined striped" align="center" width="90%">

  <tr valign="bottom" class="col-headers">
    <th align="left">Variable</th>
    <th align="left">Argument type</th>
    <th align="left">Description</th>
    <th align="left">Required?</th>
    <th align="left">Default value</th>
    <th align="left">See also</th>
  </tr>

  <tbody>
  <tr valign="top">
    <td align="left"><a name="Cfg_AllowEmbeddedHTML"></a><span class="code">AllowEmbeddedHTML</span><br/><a href="#PlugIn_AllowEmbeddedHTML" class="plug-in-flag">plug-in</a></td>
    <td align="left">Boolean</td>
    <td align="left">Default setting for whether or not to allow
      embedded HTML in certain RSS feed elements, such as description,
      author, etc. Some RSS formats permit embedded HTML. Setting this
      parameter to <span class="code">true</span> preserves any embedded
      HTML markup within a feed; setting this parameter to
      <span class="code">false</span> causes embedded HTML to be stripped.
      <br/><br/>
      Note that certain output handlers will strip HTML regardless of this
      setting. An output handler that produces text, for instance, is not
      required to support embedded HTML.

      This global parameter can be <a href="#Feed_AllowEmbeddedHTML">overridden on a per-feed basis.</a>
      <br/><br/>
      Notes:

      <ul>
	<li>Use this parameter with care. If supported, the raw HTML is
	copied <i>directly</i> into the resulting output, without
	modification. With HTML output, malformed embedded HTML can
	screw up the resulting HTML document.
      </ul>

    </td>
    <td align="left">No</td>
    <td align="left"><span class="code">false</span></td>
    <td>&nbsp;</td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Cfg_CacheFile"></a><span class="code">CacheFile</span></td>
    <td align="left">File name or path name</td>
    <td align="left">The full path to the file in which <i>curn</i>
      should cache feed item data. <i>curn</i> uses the cache file to
      keep track of which feed items it has already received and
      displayed, and when it received them. Under normal operation,
      <i>curn</i> won't display a feed item it has already displayed
      and cached.
      <br/><br/>
      The use of a cache can be disabled by omitting this parameter.
      Use the
      <a href="#Cfg_NoCacheUpdate" class="code">NoCacheUpdate</a>
      parameter, or the
      <a href="#opt-no-update" class="code">--no-update</a>
      command line option, to tell <i>curn</i> to read, but not update,
      the cache.
      <br/><br/>
      The cache file is an XML file. However, since it is generated
      automatically, you should not edit it.
    </td>
    <td align="left">No</td>
    <td align="left">None. (If not specified, no cache is used.)</td>
    <td align="left">
      <a href="#Cfg_NoCacheUpdate" class="code">NoCacheUpdate</a><br/>
      <a href="#Cfg_CacheBackup" class="code">CacheBackup</a><br/>
      <a href="#opt-no-cache" class="code">--no-cache</a><br/>
      <a href="#opt-no-update" class="code">--no-update</a>
    </td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Cfg_CacheBackup"></a><span class="code">CacheBackup</span></td>
    <td align="left"><p>File name or path name.</p>
    </td>
    <td align="left">The full path to a cache backup file. If this
      parameter is defined, <i>curn</i> will copy the cache to this
      backup file before updating the cache on disk.
      <p><b>Warning</b>: This parameter was replaced with
      <a href="#Cfg_TotalCacheBackups" class="code">TotalCacheBackups</a>
      in <i>curn</i> version 2.6.</p>
    </td>
    <td align="left">No</td>
    <td align="left">None.</td>
    <td align="left">
      <a href="#Cfg_CacheFile" class="code">CacheFile</a><br/>
      <a href="#Cfg_TotalCacheBackups" class="code">TotalCacheBackups</a><br/>
    </td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Cfg_CommonXMLFixups"></a><span class="code">CommonXMLFixups</span><br/><a  href="#PlugIn_CommonXMLFixups" class="plug-in-flag">plug-in</a></td>
    <td align="left">Boolean</td>
    <td align="left">Enables or disables the Common XML Fixups plug-in,
      which attempts to fix common syntax problems in downloaded XML feeds.
      There is some XML badness that is surprisingly common across feeds,
      including (but not limited to):

      <ul>
	<li>Using a "naked" ampersand (&amp;) without escaping it.
	<li>Use of nonexistent entities (e.g., &amp;ouml;, &amp;nbsp;)
	<li>Improperly formatted entity escapes
      </ul>

      This plug-in attempts to fix those problems.
      <br/><br/>
      This global parameter can be <a href="#Feed_CommonXMLFixups">overridden on a per-feed basis.</a>
      This global setting defines the default value for all feeds that
      don't explicitly set it themselves.
    </td>
    <td align="left">No</td>
    <td align="left"><span class="code">false</span></td>
    <td>The per-feed <a href="#Feed_CommonXMLFixups" class="code">CommonXMLFixups</a> setting</td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Cfg_DaysToCache"></a><span class="code">DaysToCache</span></td>
    <td align="left">Positive integer</td>
    <td align="left">
      Default maximum number of days to cache an already-read item.
      This parameter is used when the configuration section for a
      particular site lacks its own
      <a href="#Feed_DaysToCache" class="code">DaysToCache</a>
      value. Items older than this many days are tossed from the
      cache when it's read, which means <i>curn</i> forgets that it saw
      them before. A value of 0 renders the cache is essentially
      useless (i.e., 0 ensures that <i>curn</i> always forgets items
      that are cached). The special value "NoLimit" causes <i>curn</i>
      to leave items in the cache forever.
    </td>
    <td align="left">No</td>
    <td align="left">365 (days)</td>
    <td align="left">Per-feed <a href="#Feed_DaysToCache" class="code">DaysToCache</a> parameter</td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Cfg_GzipDownload"></a><span class="code">GzipDownload</span><br/><a href="#PlugIn_GzipDownload" class="plug-in-flag">plug-in</a></td>
    <td align="left">Boolean</td>
    <td align="left">
      If set to <span class="code">true</span>, this parameter directs <i>curn</i> to use the
      "<span class="code">Accept-Encoding:&nbsp;gzip</span>"
      HTTP header when retrieving an RSS feed from an HTTP server.
      Since RSS feeds are XML, they typically compress well;
      retrieving gzipped data, rather than the uncompressed HTML, can
      save a significant amount of time and network bandwidth. (Note,
      however, that HTTP servers are not obligated to honor a request
      to <i>gzip</i> the feed.) This parameter can be
      <a href="#Feed_GzipDownload">overridden on a per-feed basis</a>.
      This global value sets the default value.
      <br/><br/>
      For backward compatibility, this parameter can also be specified
      as <span class="code">GetGzippedFeeds</span>.
    </td>
    <td align="left">No</td>
    <td align="left" class="code">true</td>
    <td align="left">
    </td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Cfg_IgnoreArticlesOlderThan"></a><span class="code">IgnoreArticlesOlderThan</span><br/><a href="#PlugIn_IgnoreOldArticles" class="plug-in-flag">plug-in</a></td>
    <td align="left">String</td>
    <td align="left">Provides a way to ignore articles that are
  older than a certain interval. Intervals are
  expressed in a natural language syntax. For 
  instance:

<blockquote><pre>
IgnoreArticlesOlderThan: 3 days
IgnoreArticlesOlderThan: 1 week
IgnoreArticlesOlderThan: 365 days
IgnoreArticlesOlderThan: 12 hours, 30 minutes
</pre></blockquote>

                      Valid interval names (in English) are:

  <ul>
    <li>millisecond, milliseconds, ms
    <li>second, seconds, sec, secs
    <li>minute, minutes, min, mins
    <li>hour, hours, hr, hrs
    <li>day, days
    <li>week, weeks
  </ul>

  If you're running <i>curn</i> in a Spanish or French locale, the appropriate
  Spanish or French equivalents are also available, as well as the English
  versions. 
  <br><br>
  "year" and "month" are not supported, to avoid
  the irregularity of leaps years and different
  month lengths, respectively.
  <br><br>
  The actual conversion of the strings is done by the
  <a href="http://www.clapper.org/software/java/util/">org.clapper.util</a>
  library's
  <a href="http://www.clapper.org/software/java/util/javadocs/util/api/org/clapper/util/misc/Duration.html" class="code">Duration</a> class.
  See that class for more details.
  <br><br>
  This global value sets the default value.
    </td>
    <td align="left">No</td>
    <td align="left">None (i.e., Articles are not ignored based on age)</td>
    <td align="left">Per-feed <a href="#Feed_IgnoreArticlesOlderThan" class="code">IgnoreArticlesOlderThan</a> parameter</td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="MailOutputTo"></a><span class="code">MailOutputTo</span><br/><a href="#PlugIn_EmailOutput" class="plug-in-flag">plug-in</a></td>
    <td align="left">String</td>
    <td>One or more comma-separated email addresses to receive the output.
        This parameter is optional. If any email addresses are specified, then
        <i>curn</i> constructs a MIME multipart/alternative email
        message&nbsp;<a href="#Note1">[1]</a>, attaching the output from
        each configured output handler as a separate
        multipart/alternative attachment. (<i>curn</i> assumes that
        each output handler is generating an alternate form of the
        same information.) Output handlers that don't generate output
        are skipped. If none of the configured output handlers
        generate any output, then <i>curn</i> doesn't send an email
        message.
    </td>
    <td align="left">No</td>
    <td align="left">Output is not emailed.</td>
    <td align="left">
        <a href="#Cfg_SMTPHost" class="code">SMTPHost</a><br/>
        <a href="#Cfg_MailFrom" class="code">MailFrom</a><br/>
        <a href="#Cfg_MailSubject" class="code">MailSubject</a>
    </td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Cfg_MailFrom"></a><span class="code">MailFrom</span><br/><a href="#PlugIn_EmailOutput" class="plug-in-flag">plug-in</a></td>
    <td align="left">String</td>
    <td align="left">
      The email address to use as the sender, when mailing output.
      The address can be a full RFC 2822-compliant address (e.g.,
      "Joe&nbsp;Blow&nbsp;&lt;joe@example.org&gt;") or just a simple address
      (e.g., "joe@example.org"). This parameter is only honored when at
      least one email address is specified via the
      <a href="#MailOutputTo" class="code">MailOutputTo</a> configuration
      parameter.
    </td>
    <td align="left">No</td>
    <td align="left">
      <i>curn</i> constructs its own "from" address from the user name
      associated with running process and the current host name.
    </td>
    <td align="left">
      <a href="#Cfg_SMTPHost" class="code">SMTPHost</a><br/>
      <a href="#Cfg_MailSubject" class="code">MailSubject</a><br/>
      <a href="#MailOutputTo" class="code">MailOutputTo</a>
    </td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Cfg_MailSubject"></a><span class="code">MailSubject</span><br/><a href="#PlugIn_EmailOutput" class="plug-in-flag">plug-in</a></td>
    <td align="left">String</td>
    <td align="left">
      The subject line to use when mailing output.
      This parameter is only honored when at
      least one email address is specified via the
      <a href="#MailOutputTo" class="code">MailOutputTo</a> configuration
      parameter.
    </td>
    <td align="left">No</td>
    <td align="left"><span class="code">curn output</span></td>
    <td align="left">
      <a href="#Cfg_SMTPHost" class="code">SMTPHost</a><br/>
      <a href="#Cfg_MailFrom" class="code">MailFrom</a><br/>
      <a href="#MailOutputTo" class="code">MailOutputTo</a>
    </td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Cfg_MaxSummarySize"></a><span class="code">MaxSummarySize</span><br/><a href="#PlugIn_EmailOutput" class="plug-in-flag">plug-in</a></td>
    <td align="left">Positive integer</td>
    <td align="left">
      If an article has a summary,
      you can optionally set a maximum size for the summary. If a summary
      exceeds the maximum size, <i>curn</i> will truncate it and add
      a trailing ellipsis ("...") to indicate the truncation. A value of
      0 effectively disables this option. This parameter can be
      <a href="#Feed_MaxSummarySize">overridden on a per-feed basis</a>.
      This global value sets the default value.
    </td>
    <td align="left">No</td>
    <td align="left">0 (i.e., no limit on summary size)</td>
    <td align="left"><a href="#Cfg_ReplaceEmptySummaryWith" class="code">ReplaceEmptySummaryWith</a></td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Cfg_MaxThreads"></a><span class="code">MaxThreads</span></td>
    <td align="left">Positive integer</td>
    <td align="left">Defines the number of concurrent download threads.
        If this value is greater than 1, then <i>curn</i> will spawn
        that many worker threads to handle the downloading and parsing of
        the RSS feeds concurrently. If this value is 1, <i>curn</i> will
        process the feeds sequentially. If this value is greater than 1,
        but less than the total number of feeds, some of the worker
        threads will end up processing more than one feed (sequentially).
        Values less than 1 are illegal.
    </td>
    <td align="left">No</td>
    <td align="left" class="code">false</td>
    <td align="left">
    </td>
  </tr>

  <tr valign="top">
    <td align="left" class="code"><a name="Cfg_NoCacheUpdate"></a>NoCacheUpdate</td>
    <td align="left">Boolean</td>
    <td align="left">If set to <span class="code">true</span> (and if a cache file is specified),
      this parameter tells curn to read the cache file and honor its
      contents, but not to save the modified in-memory cache back to
      disk.
    </td>
    <td align="left">No</td>
    <td align="left" class="code">false</td>
    <td align="left">
      <a href="#Cfg_CacheFile" class="code">CacheFile</a><br/>
      <a href="#opt-no-update" class="code">--no-update</a>
    </td>
  </tr>

  <tr valign="top">
    <td align="left" class="code"><a name="Cfg_ParserClass"></a>ParserClass</td>
    <td align="left">String</td>
    <td align="left">
      The full name of the underlying RSS parser class to be used.
      This class must implement the
      <a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/parser/RSSParser.html" class="code">org.clapper.curn.parser.RSSParser</a>
      interface. It can be a first-class parser of its own, or
      it can be nothing more than an adapter for a third party
      RSS parser class.
      <br/><br/>
      Two parsers are bundled with <i>curn</i>:

      <dl>
        <dt><a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/parser/rome/RSSParserAdapter.html" class="code">org.clapper.curn.parser.rome.RSSParserAdapter</a>

        <dd>An adapter class that makes the
            <a href="https://rome.dev.java.net/">Rome RSS parser</a>
            work with <i>curn</i>.
            (The Rome adapter is only available if the appropriate
            Rome jar files are in <i>curn</i>'s class path. Note also
            that Rome requires version 1.0 of the
            <a href="http://www.jdom.org/">JDOM</a> library.)

        <dt><a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/parser/informa/RSSParserAdapter.html" class="code">org.clapper.curn.parser.informa.RSSParserAdapter</a>

        <dd>An adapter class that makes the
            <a href="http://informa.sourceforge.net/">Informa RSS parser</a>
            work with <i>curn</i>.
            (The Informa adapter is only available if the appropriate
            Informa jar files are in <i>curn</i>'s class path.)
	    <br/><br/>
            WARNING: As of the last time this document was
            updated, the Informa parser, version 0.6, does not
            support Atom 1.0 properly. Specifically, it assumes that
            a <span class="code">&lt;feed&gt;</span> element will
            always have a <span class="code">version</span> attribute.
            That was true for Atom 0.3, but it's not true for Atom
            1.0.

      </dl>

      <p>Any class that implements
      <a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/parser/RSSParser.html" class="code">org.clapper.curn.parser.RSSParser</a>
      may be used as a value for <span class="code">ParserClass</span>.
    </td>
    <td align="left">No</td>
    <td align="left" class="code"><a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/parser/rome/RSSParserAdapter.html" class="code">org.clapper.curn.parser.rome.RSSParserAdapter</a></td>
    <td align="left">&nbsp;</td>
  </tr>

  <tr valign="top">
    <td align="left" class="code"><a name="Cfg_Quiet"></a>Quiet</td>
    <td align="left">Boolean</td>
    <td align="left">
      Normally, if an RSS feed contains no new items, most
      <i>curn</i> output handlers display the site's name and URL,
      followed by something like "No new items." Similarly, if
      <i>curn</i> can't contact a feed site, or if the site's XML is
      unparseable, <i>curn</i> displays an error message. This option
      tells <i>curn</i> to silently ignore sites with no data or bad
      XML. Setting <span class="code">Quiet</span> to <span class="code">true</span> tells
      <i>curn</i> to suppress both of the above displays.
    </td>
    <td align="left">No</td>
    <td align="left" class="code">false</td>
    <td align="left">
      <a href="#opt-quiet" class="code">--quiet</a><br/>
      <a href="#opt-no-quiet" class="code">--no-quiet</a>
    </td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Cfg_ReplaceEmptySummaryWith"></a><span class="code">ReplaceEmptySummaryWith</span><br/><a href="#PlugIn_EmptyArticleSummary" class="plug-in-flag">plug-in</a></td>
    <td align="left">String</td>
    <td align="left">
      Tells <i>curn</i> what to do when the summary for a feed
      article is missing. Legal values:

      <ul>
	<li><i>nothing</i>: Leave the summary blank. This is the default.
	<li><i>content</i>: Replace the summary with the article's content,
            if there is any content.
	<li><i>title</i>: Replace the summary with the article's title.
      </ul>

      <a href="#Feed_ReplaceEmptySummaryWith">overridden on a per-feed basis</a>.
      This global value sets the default value.
    </td>
    <td align="left">No</td>
    <td align="left" class="code">nothing</td>
    <td align="left">
      Per-feed <a href="#Feed_SortBy" class="code">SortBy</a> parameter
    </td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Cfg_ShowAuthors"></a><span class="code">ShowAuthors</span><br/><a href="#PlugIn_ShowAuthors" class="plug-in-flag">plug-in</a></td>
    <td align="left">Boolean</td>
    <td align="left">
      If set to <span class="code">true</span>, this configuration item instructs <i>curn</i>
      to display author version for each feed item, if available.
      This global value can be
      <a href="#Feed_ShowAuthors">overridden on a per-feed basis</a>.
    </td>
    <td align="left">No</td>
    <td align="left" class="code">false</td>
    <td align="left">
    </td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Cfg_ShowDates"></a><span class="code">ShowDates</span><br/><a href="#PlugIn_ShowDates" class="plug-in-flag">plug-in</a></td>
    <td align="left">Boolean</td>
    <td align="left">
      Some RSS feeds or the individual items within each feed
      contain dates (usually corresponding to the publication
      dates for the feed or item). If this option is set to <span class="code">true</span>,
      then <i>curn</i> will display the date for each item that
      provides a date.
      This global value can be
      <a href="#Feed_ShowDates">overridden on a per-feed basis</a>.
    </td>
    <td align="left">No</td>
    <td align="left" class="code">false</td>
    <td align="left">
    </td>
  </tr>

  <tr valign="top">
    <td align="left" class="code"><a name="Cfg_ShowRSSVersion"></a>ShowRSSVersion</td>
    <td align="left">Boolean</td>
    <td align="left">Display the RSS version for each feed.</td>
    <td align="left">No</td>
    <td align="left" class="code">false</td>
    <td align="left">
    </td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Cfg_SummaryOnly"></a><span class="code">SummaryOnly</span><br/><a href="#PlugIn_FeedSummaryOnly" class="plug-in-flag">plug-in</a></td>
    <td align="left">Boolean</td>
    <td align="left">
      Some RSS feeds provide a description for each item, in addition
      to the (brief) title. Setting <span class="code">SummaryOnly</span>
      to <span class="code">true</span> suppresses display of the description. This parameter
      can be <a href="#Feed_SummaryOnly">overridden on a per-feed basis</a>.
      This global value sets the default value.
      <br/><br/>
      <b>WARNING:</b> This parameter is deprecated. Use the
      <a href="#Feed_ReplaceEmptySummaryWith" class="code">ReplaceEmptySummaryWith</a>
      parameter, instead.
    </td>
    <td align="left">No</td>
    <td align="left" class="code">false</td>
    <td align="left"><a href="#Cfg_ReplaceEmptySummaryWith" class="code">ReplaceEmptySummaryWith</a></td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Cfg_SMTPHost"></a><span class="code">SMTPHost</span><br/><a href="#PlugIn_EmailOutput" class="plug-in-flag">plug-in</a></td>
    <td align="left">String</td>
    <td align="left">
      The SMTP host to use when mailing output.
      This parameter is only honored when at
      least one email address is specified via the
      <a href="#MailOutputTo" class="code">MailOutputTo</a> configuration
      parameter.
    </td>
    <td align="left">No</td>
    <td align="left" class="code">localhost</td>
    <td align="left">
      per-feed <a href="#Feed_ReplaceEmptySummaryWith" class="code">ReplaceEmptySummaryWith</a> parameter
    </td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Cfg_SortBy"></a><span class="code">SortBy</span><br/><a href="#PlugIn_SortArticles" class="plug-in-flag">plug-in</span></td>
    <td align="left">String</td>
    <td align="left">
      Default method to use to sort items within each feed. This
      parameter is used when the configuration section for a particular
      site lacks its own <a href="#Feed_SortBy" class="code">SortBy</a>
      value. Legal values:

      <ul>
        <li><span class="code">time</span>: Sort by timestamp, if
            present. Current time is assumed for items that don't have
            timestamps.
        <li><span class="code">title</span>: Sort by item title, if
            present. Any item without a title is sorted as if its
            title were the empty string ("").
        <li><span class="code">none</span>: Don't sort (i.e., leave
            items in the order they appear in the XML).
      </ul>
    </td>
    <td align="left">No</td>
    <td align="left" class="code">none</td>
    <td align="left">
      Per-feed <a href="#Feed_SortBy" class="code">SortBy</a> parameter
    </td>
  </tr>

  <tr valign="top">
    <td align="left" class="code"><a name="Cfg_TotalCacheBackups"></a>TotalCacheBackups</td>
    <td align="left">Positive integer</td>
    <td align="left">
      The total number of cache backup copies to keep. If this parameter
      is greater than 0, then <i>curn</i> will keep that many numbered backups
      of the cache. If the cache exists when <i>curn</i> attempts to update
      it, <i>curn</i> will copy the existing cache to
      <span class="filename">cacheFile.0</span>. If
      <span class="filename">cacheFile.0</span> exists, it will be moved to
      <span class="filename">cacheFile.1</span> first, and so on down the line,
      until the maximum number of cache backup files exists.
      The newest cache is always the one without a numeric extension.
      the oldest file is the one with the largest numeric extension.
      This parameter is useful if you want to roll back to a previous cache.
      <br/><br/>
      If this parameter is not specified, or is 0, then no cache backups
      are made.
    </td>
    <td align="left">No</td>
    <td align="left">0</td>
    <td align="left">
      <a href="#Cfg_CacheFile" class="code">CacheFile</a>
     </td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Cfg_UserAgent"></a><span class="code">UserAgent</span><br/><a href="#PlugIn_UserAgent" class="plug-in-flag">plug-in</a></td>
    <td align="left">String</td>
    <td align="left">
      Specifies the default HTTP <span class="code">User-Agent</span> header to use.
      This configuration parameter permits you to have <i>curn</i>
      masquerade as a known browser, for sites that refuse access to
      robots and spiders and other unknown web clients. This global
      value is used when the section for a particular feed does not
      supply its own <span class="code">UserAgent</span> value.
    </td>
    <td align="left">No</td>
    <td align="left">A string that identifies <i>curn</i>
     as the user agent.</td>
    <td align="left">
      Per-feed <a href="#Feed_UserAgent" class="code">UserAgent</a>
      parameter.</td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Cfg_ZipOutputTo"></a><span class="code">ZipOutputTo</span><br/><a href="#PlugIn_ZipOutput" class="plug-in-flag">plug-in</a></td>
    <td align="left">String</td>
    <td align="left">
      Path to a zip file to receive all output generated by output handlers.
    </td>
    <td align="left">No</td>
    <td align="left" class="code">None</td>
    <td align="left">&nbsp;</td>
  </tr>


  </tbody>
</table>
<br clear="all"/>

<!-- ********************************************************************** -->
<h2><a name="CfgRSSFeeds"></a>Configuring the RSS Feeds</h2>

<p>The <i>curn</i> configuration file also contains a list of RSS feeds to
be polled. Each feed must be specified in its own section in the
configuration file. The name of the section must start with the string
"Feed". If more than one feed is present, then each section name must also
have additional characters, to make the section name unique. The following
section names are all valid for RSS feed sections.</p>

<ul>
  <li><span class="code">Feed</span> (if there's only one configured feed)
  <li><span class="code">Feed1</span>
  <li><span class="code">Feed_0</span>
  <li><span class="code">Feed_Wired</span>
  <li><span class="code">Feed.NYTimes.Top</span>
</ul>

<p>Each feed section supports the following parameters. (Parameters marked
with <span class="plug-in-flag">plug-in</span> are handled by one of
<i>curn</i>'s <a href="#StockPlugIns">stock plug-ins</a>, rather than by
the core code.)</p>

<table summary="" class="outlined striped" align="center" width="90%">

  <tr valign="bottom" class="col-headers">
    <th align="left">Variable</th>
    <th align="left">Argument type</th>
    <th align="left">Description</th>
    <th align="left">Required?</th>
    <th align="left">Default Value</th>
  </tr>

  <tbody>
  <tr valign="top">
    <td align="left"><a name="Feed_AllowEmbeddedHTML"></a><span class="code">AllowEmbeddedHTML</span><br/><a href="#PlugIn_AllowEmbeddedHTML" class="plug-in-flag">plug-in</a></td>
    <td align="left">Boolean</td>
    <td align="left">Whether or not to allow
    embedded HTML in certain RSS feed elements, such as description,
    author, etc, for this feed. Some RSS formats permit embedded HTML; setting this
    parameter to <span class="code">true</span> tells <i>curn</i>
    <a href="#CfgOutputHandlers">output handlers</a> that they should
    preserve such embedded HTML markup, if possible. If this parameter
    is <span class="code">false</span>, any embedded HTML is stripped.
      <br/><br/>
      Note that certain output handlers will strip HTML regardless of this
      setting. An output handler that produces text, for instance, is not
      required to support embedded HTML.

    <p>Notes:</p>

    <ul>
      <li>Use this parameter with care. If supported, the raw HTML is
          copied <i>directly</i> into the resulting output, without
          modification. With HTML output, malformed embedded HTML can
          screw up the resulting HTML document.
    </ul>

    This parameter overrides the
    <a href="#Cfg_AllowEmbeddedHTML" class="code">AllowEmbeddedHTML</a>
    setting in the main configuration section.
    </td>
    <td align="left">No</td>
    <td align="left"><span class="code">false</span></td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Feed_ArticleFilter"></a><span class="code">ArticleFilter</span><br/><a href="#PlugIn_ArticleFilter" class="plug-in-flag">plug-in</a></td>
    <td align="left">Strings</td>
    <td align="left">Specifies a set of filters to discard feed item (article)
      content, based on regular expressions.
      <br/><br/>
      The filtering syntax is (shamelessly) adapted from the
      <a href="http://offog.org/code/rawdog.html" target="_top"><i>rawdog</i></a>
      RSS reader's
      <a href="http://offog.org/files/rawdog-plugins/article-filter.py" target="_top"><i>article-filter</i></a>
      plug-in. A feed filter is configured by adding an
      <tt>ArticleFilter</tt> property to the feed's configuration section.
      The property's value consists of one or more filter command
      sequences, separated by ";" characters. (The ";" must be surrounded
      by white space; see below.) Each filter command sequence is of this
      form:

      <blockquote>show|hide [<i>field</i> '<i>regexp</i>' [<i>field</i>
      '<i>regexp</i>' ...]]</blockquote>

      <i>field</i> can be one of:

      <ul>
	<li> author: search the author field
	<li> title: search the title field
	<li> summary: search the summary, or description, field
	<li> text: search the full content, if available
	<li> category: search the article's category (or categories)
	<li> any: search all fields
      </ul>

      Each regular expression <i>must</i> be enclosed in single quotes.
      For example:

      <blockquote><pre>
hide author 'Raymond Luxury-yacht' ; \
show author 'Arthur +.Two-sheds. +Jackson'
      </pre></blockquote>

      If the command is "hide", then the entry will be hidden if the
      specified field matches the regular expression. If the command is
      "show", then the entry will be shown if the field matches the regular
      expression. If there are no fields or regular expressions, then the
      command is a wildcard match. That is:

      <blockquote><pre>hide</pre></blockquote>

      is equivalent to:

      <blockquote><pre>hide any '.*'</pre></blockquote>

      and:

      <blockquote><pre>show</pre></blockquote>

      is equivalent to:

      <blockquote><pre>show any '.*'</pre></blockquote>

      Wildcard matches are useful in situations where you want to
      hide or show "everything but ...". See the examples, below, for
      details.
      <br/><br/>
      All filtering commands are processed, and the end result is what defines
      whether a given entry is suppressed or not. Regular expressions are
      matched in a case-blind fashion. The match logic also:

      <ul>
	<li>ignores any embedded newlines in article contents
	<li>(temporarily) strips all HTML from the article text before matching
      </ul>

      You can use multiple <span class="code">ArticleFilter</span>
      parameters per feed, as long as they have unique suffixes (e.g.,
      <span class="code">ArticleFilter1</span>,
      <span class="code">ArticleFilter2</span>, etc.).
      All filters are applied to each article to
      determine whether the article should be filtered out or not.
      <br/><br/>

      <b>Examples</b>
      <br/><br/>

      Some examples will help clarify the syntax.
      <br/><br/>

      For example, the following set of commands hide all articles with the
      phrase "mash-up" (because mash-ups bore me):

      <blockquote>
<pre>
ArticleFilter: hide any 'mash[- \t]?up'
</pre>
      </blockquote>

      The following, more complicated, entry hides everything by author
      "Joe Blow", unless the title has the word "rant" in it ('cause his rants
      are hilarious):

      <blockquote>
<pre>
ArticleFilter: hide author '^joe *blow$' ; \
               show author '^joe *blow$' title rant
</pre>
      </blockquote>

      Finally, this example hides everything except articles by Moe Howard:

      <blockquote>
<pre>
ArticleFilter: hide ; show author '^moe *howard$'
</pre>
      </blockquote>
    </td>
    <td align="left">No</td>
    <td align="left">Articles are not filtered</td>
  </tr>

  <tr valign="top">

    <td align="left"><a name="Feed_CommonXMLFixups"></a><span class="code">CommonXMLFixups</span><br/><a href="#PlugIn_CommonXMLFixups" class="plug-in-flag">plug-in</a></td>
    <td align="left">Boolean</td>
    <td align="left">
      Enables or disables the Common XML Fixups plug-in, which attempts
      to fix common syntax problems in downloaded XML feeds. Among the
      corrections this plug-in makes:

    <ul>
      <li>Conversion of unescaped ampersand ("&amp;") characters
      <li>Conversion of certain commonly seen, but nonexistent, XML
	  entities, such as <span class="code">&amp;mdash;</span> and
	  <span class="code">&amp;ouml;</span>
      <li>Conversion of illegal character entities (which are usually
	  leaked unescaped from embedded HTML text)
      <li>"<a href="http://www.fourmilab.ch/webtools/demoroniser/">Demoronizing</a>"
	  text by converting Microsoft Windows-specific characters (such as
	  smart quotes) to something that will display in any browser. (The
	  term "demoronize" is borrowed from John Walker's <i>demoroniser</i>
	  command-line Unix tool.)
     </ul>

      This per-feed setting overrides the
      <a href="#Cfg_CommonXMLFixups">global default value</a>.
    </td>
    <td align="left">No</td>
    <td align="left">
      The value of the global
      <a href="#Cfg_CommonXMLFixups" class="code">CommonXMLFixups</a>
      parameter in the <span class="code">[curn]</span> section, or
      <tt>false</tt>, if that value is not set.</td>
  </tr>

  <tr valign="top">

    <td align="left" class="code"><a name="Feed_DaysToCache"></a>DaysToCache</td>
    <td align="left">Positive integer</td>
    <td align="left">
      Maximum number of days to cache an already-read item for this
      feed. This value locally overrides the global
      <a href="#Cfg_DaysToCache" class="code">DaysToCache</a> default
      in the <a href="#CfgCurnSection" class="code">[curn]</a> section.
      Items older than this many days are tossed from the
      cache when it's read, which means <i>curn</i> forgets that it saw
      them before. A value of 0 renders the cache is essentially useless
      for this feed (i.e., 0 ensures that <i>curn</i> always forgets
      items that are cached for this feed). The special value "NoLimit"
      causes <i>curn</i> to leave items in the cache forever.
    </td>
    <td align="left">No</td>
    <td align="left">
      The value of the global
      <a href="#Cfg_DaysToCache" class="code">DaysToCache</a>
      parameter in the <span class="code">[curn]</span> section or 365
      if that value is not set.</td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Feed_Disabled"></a><span class="code">Disabled</span><br/><a href="#PlugIn_DisableFeed" class="plug-in-flag">plug-in</a></td>
    <td align="left">Boolean</td>
    <td align="left">If <span class="code">true</span>, then the feed is skipped.
    If <span class="code">false</span>, the feed is processed. This variable
    provides a simple way to disable a feed without having
    to comment its entire section out.
    </td>
    <td align="left">No</td>
    <td align="left" class="code">false</td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Feed_EditFeedURL"></a><span class="code">EditFeedURL</span><br/>
      <a name="Feed_EditItemURL"></a><span class="code">EditItemURL</span><br/>
      <a href="#PlugIn_EditParsedFeedURL" class="plug-in-flag">plug-in</a></td>
    <td align="left">String</td>
    <td align="left">
        Apply the specified regular expression edit to the site's
        feed URL (<span class="code">EditFeedURL</span>) or to each of the
        site's RSS item URLs (<span class="code">EditItemURL</span>).
        The value for this option consists of
        a Perl 5-style substitution applied to the URL. For example:

        <p>Remove all the parameters from the URL:</p>

        <blockquote><pre>'s/?.*$//'</pre></blockquote>

        <p>(The <a href="#Feed_PruneURLs" class="code">PruneURLs</a>
        parameter provides a simpler mechanism for this common
        operation.)</p>

        <p>Remove a "redirect" CGI from a site whose URLs look
           like: <span class="code">http://www.example.com/redir.cgi?http://...</span></p>

        <blockquote><pre>s+http://www.example.com/cgi-bin/redir.cgi?++</pre></blockquote>

        <p>The substitution syntax supports perl's $1, $2, etc.,
        grouping syntax. However, because the "$" character also
        introduces a configuration file variable reference, you must
        escape the "$" to use it in a regular expression. For
        instance, use either:</p>

        <blockquote><pre>s/^([a-z]+)foo(.*)\$/\$1bar\$2/</pre></blockquote>
        <p>or</p>

        <blockquote><pre>'s/^([a-z]+)foo(.*)$/$1bar$2/'</pre></blockquote>

        <p>If there are backslashes in the string, you must escape
        them, as well, preferably by single-quoting the value. See
        <a href="#CfgRawValues">Suppressing Metacharacter Expansion and Variable Substitution</a>
        for more details. To get the equivalent
        of Perl 5 expression.</p>

        <blockquote><pre>s/^\*.*$//</pre></blockquote>

        <p>you must specify</p>

        <blockquote><pre>'s/^\*.*$//'</pre></blockquote>

        <p>This substitution syntax supports the following Perl-like
        modifiers, which are appended to the end of the substitution
        command:</p>

        <blockquote>
        <table summary="" class="bordered uncolored" id="foo-nested">
          <tr valign="top">
            <td align="left" class="code">g&nbsp;</td>
            <td>Substitute for all occurrences of the regular
                expression, not just the first one</td>
          </tr>

          <tr valign="top">
            <td align="left" class="code">i&nbsp;</td>
            <td>Do case-insensitive pattern matching. Case-sensitive
              pattern matching is the default.</td>
          </tr>

          <tr valign="top">
            <td align="left" class="code">m&nbsp;</td>
            <td>Treat the string is consisting of multiple lines.
                This modifier changes the meaning of "^" and "$" so that
                they match just after or just before, respectively, a
                line terminator or the end of the input sequence. By
                default these expressions only match at the beginning
                and the end of the entire input sequence.</td>
          </tr>
        </table>
        </blockquote>

        <p>The modifiers can be concatenated. Thus,</p>

        <blockquote><pre>'s/abc/xyz/ig'</pre></blockquote>

        <p>will match and replace all occurrences of the string "abc",
        whether upper-, lower- or mixed-case.</p>

        <p>Hint: When <a href="#opt-logging">logging is enabled</a>,
        <i>curn</i> will log the parsed expression at the "debug"
        log level.</p>
    </td>
    <td align="left">No</td>
    <td align="left">None</td>
  </tr>

  <tr valign="top">
    <td align="left" class="code"><a name="Feed_ForceEncoding"></a>ForceEncoding</td>
    <td align="left">String</td>
    <td align="left">Force <i>curn</i> to ignore the character set
      encoding advertised by the remote server (if any), and use the
      character set specified by this configuration item, instead.
      This is useful in the following cases:

      <ul>
        <li>the remote HTTP server doesn't supply an HTTP
            Content-Encoding header, and the local (Java) default
            encoding doesn't match the document's encoding
        <li>the remote HTTP server supplies the wrong encoding
        <li>the feed is coming from a file or an FTP server, and the
            default encoding (see below) isn't correct
      </ul>

      <p>This value should be a character set encoding that is recognized
      by the Java runtime environment.</p>

      <p><span class="code">ForceCharacterEncoding</span> is a synonym
      for this parameter, retained for backward compatibility.</p>
    </td>
    <td align="left">No</td>
    <td align="left">
      <ul>
        <li>For <span class="code">http</span> and
            <span class="code">https</span> URLs, the encoding comes
            from the HTTP Content-Encoding header; if that header isn't
            present, then the Java VM's default encoding (usually
            "ISO-8859-1" on UNIX, and "Cp1252" on Windows) is used.
        <li>For <span class="code">file</span> URLs, the default encoding
            is "utf-8", the same as the default value for the
            <a href="#Feed_SaveAsEncoding" class="code">SaveAsEncoding</a>
            parameter.
        <li>For all other URL types, the Java VM's default encoding is
            used.
      </ul>
    </td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Feed_GzipDownload"></a><span class="code">GzipDownload</span><br/><a href="#PlugIn_GzipDownload" class="plug-in-flag">plug-in</a></td>
    <td align="left">Boolean</td>
    <td align="left">
      If set to <span class="code">true</span>, this parameter directs <i>curn</i> to use the
      "<span class="code">Accept-Encoding:&nbsp;gzip</span>"
      HTTP header when retrieving this RSS feed from an HTTP server.
      Since RSS feeds are XML, they typically compress well;
      retrieving gzipped data, rather than the uncompressed HTML, can
      save a significant amount of time and network bandwidth. (Note,
      however, that HTTP servers are not obligated to honor a request
      to <i>gzip</i> the feed.) This parameter overrides the global
      <a href="#Cfg_GzipDownload" class="code">GzipDownload</a>.
    </td>
    <td align="left">No</td>
    <td align="left" class="code">true</td>
  </tr>

  <tr valign="top">

  <tr valign="top">
    <td align="left"><a name="Feed_IgnoreArticlesOlderThan"></a><span class="code">IgnoreArticlesOlderThan</span><br/><a href="#PlugIn_IgnoreOldArticles" class="plug-in-flag">plug-in</a></td>
    <td align="left">String</td>
    <td align="left">Provides a way to ignore articles that are
  older than a certain interval. Intervals are
  expressed in a natural language syntax. For 
  instance:

<blockquote><pre>
IgnoreArticlesOlderThan: 3 days
IgnoreArticlesOlderThan: 1 week
IgnoreArticlesOlderThan: 365 days
IgnoreArticlesOlderThan: 12 hours, 30 minutes
</pre></blockquote>

                      Valid interval names (in English) are:

  <ul>
    <li>millisecond, milliseconds, ms
    <li>second, seconds, sec, secs
    <li>minute, minutes, min, mins
    <li>hour, hours, hr, hrs
    <li>day, days
    <li>week, weeks
  </ul>

  If you're running <i>curn</i> in a Spanish or French locale, the appropriate
  Spanish or French equivalents are also available, as well as the English
  versions. (Supporting additional locales requires modifying the
  <a href="http://www.clapper.org/software/java/util/">org.clapper.util</a>
  library, but it's easy enough to do.)
  <br><br>
  "year" and "month" are not supported, to avoid
  the irregularity of leaps years and different
  month lengths, respectively.
  <br><br>
  The actual conversion of the strings is done by the
  <a href="http://www.clapper.org/software/java/util/">org.clapper.util</a>
  library's
  <a href="http://www.clapper.org/software/java/util/javadocs/util/api/org/clapper/util/misc/Duration.html" class="code">Duration</a> class.
  See that class for more details.
    </td>
    <td align="left">No</td>
    <td align="left">The default, as defined by the global
    <a href="#Cfg_IgnoreArticlesOlderThan" class="code">IgnoreArticlesOlderThan</a> parameter</td>
  </tr>

    <td align="left"><a name="Feed_IgnoreDuplicateTitles"></a><span class="code">IgnoreDuplicateTitles</span><br/><a href="#PlugIn_IgnoreDuplicateArticles" class="plug-in-flag">plug-in</a></td>
    <td align="left">Boolean</td>
    <td align="left">
      If <span class="code">true</span>, <i>curn</i> will ignore any item
      whose title matches the title of another item in the feed. It
      only compares titles within the feed itself; it does not
      compare against titles of cached items.) Titles are compared
      without regard to upper or lower case.

      <p>This feature (hack, really) is useful for sites
      whose feeds often contain duplicate items (with the same titles)
      that have different IDs and different URLs, and thus appear to be
      unique. (<a href="http://news.yahoo.com/">Yahoo! News</a> feeds
      sometimes exhibit this trait.)</p>
    </td>
    <td align="left">No</td>
    <td align="left" class="code">false</td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Feed_MaxSummarySize"></a><span class="code">MaxSummarySize</span><br/><a href="#PlugIn_FeedMaxSummarySize" class="plug-in-flag">plug-in</a></td>
    <td align="left">Positive integer</td>
    <td align="left">
      If an article has a summary,
      you can optionally set a maximum size for the summary. If a summary
      exceeds the maximum size, <i>curn</i> will truncate it and add a
      trailing ellipsis ("...") to indicate the truncation. A value of 0
      effectively disables this option. This parameter overrides the global
      <a href="#Cfg_MaxSummarySize" class="code">MaxSummarySize</a>
      parameter.
    </td>
    <td align="left">No</td>
    <td align="left">0 (i.e., no limit on summary size)</td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Feed_PreparseEdit"></a><span class="code">PreparseEdit<i>suffix</i></span><br/><a href="#PlugIn_RawFeedEdit" class="plug-in-flag">plug-in</a></td>
    <td align="left">String</td>
    <td align="left">
        A parameter in a Feed section that starts with
        <span class="code">PreparseEdit</span> (e.g.,
        <span class="code">PreparseEdit1</span>,
        <span class="code">PreparseEditFoo</span>, etc.)
        defines a substitution to be applied to the downloaded XML
        file before it is parsed. As with the
        <a href="#Feed_EditItemURL" class="code">EditItemURL</a> and
        <a href="#Feed_EditFeedURL" class="code">EditFeedURL</a>
        options, the value for this option this option consists of a
        Perl 5-style substitution.

        <p>This capability is rarely needed, but it's sometimes
        useful for sites that serve unparseable, but easily
        fixed, XML. (Though the
        <a href="#Feed_CommonXMLFixups" class="code">CommonXMLFixups</a>
        capability covers a lot of these errors with less configuration.)</p>

        <p>For instance, one news site I read has an
        RSS channel whose title always contains an unescaped
        "&amp;". The XML parser will not parse that feed; however,
        a simple preparse edit command of:</p>

        <blockquote><pre>'s/&nbsp;&amp;&nbsp;/&nbsp;\&amp;amp;&nbsp;/g'</pre></blockquote>

        <p>fixes the problem. (Again, this is one of the common XML
         syntax errors that
        <a href="#Feed_CommonXMLFixups" class="code">CommonXMLFixups</a>
        will correct.)</p>

        <p>Another use for <span class="code">PreparseEdit</span> is
        fixing incorrectly formatted links in the RSS feed. Consider
        the following <span class="code">&lt;link&gt;</span> element,
        for fictitious site <span class="url">news.example.com</span>:</p>

        <blockquote><pre>&lt;link&gt;http://news.example.com&amp;article=12573&lt;/link&gt;</pre></blockquote>

        <p>This is a perfectly parseable URL, but it happens to be wrong.
        It's missing a "/" between ".com" and "&amp;". It really ought to
        be:

        <blockquote><pre>&lt;link&gt;http://news.example.com/&amp;article=12573&lt;/link&gt;</pre></blockquote>

        <p>A quick
        <span class="code">PreparseEdit</span> rule can fix it, though:</p>
        <blockquote><pre>PreparseEdit: 's|(news.example.com)([^/]+)|$1/$2|</pre></blockquote>

        <p>Note the use of a different delimiter in the edit command
        ("|", instead of "/"). Any non-alphabetic character will work.</p>

        <p>Multiple instances of this parameter are permitted, as
        long as each instance's name begins with the string
        "PreparseEdit" and contains a unique suffix.</p>

        <p>The substitution syntax supports perl-style $1, $2, etc.,
        grouping syntax. However, because the "$" character also
        introduces a configuration file variable reference, you must
        escape the "$" to use it in a regular expression. For
        instance, use either:</p>

        <blockquote><pre>s/^([a-z]+)foo(.*)\$/\$1bar\$2/</pre></blockquote>
        <p>or</p>

        <blockquote><pre>'s/^([a-z]+)foo(.*)$/$1bar$2/'</pre></blockquote>

        <p>If there are backslashes in the string, you must escape
        them, as well, preferably by single-quoting the value. See
        <a href="#CfgRawValues">Suppressing Metacharacter Expansion and Variable Substitution</a>
        for more details. To get the equivalent
        of Perl 5 expression.</p>

        <blockquote><pre>s/^\*.*$//</pre></blockquote>

        <p>you must specify</p>

        <blockquote><pre>'s/^\*.*$//'</pre></blockquote>

        <p>This substitution syntax supports the following perl-like
        modifiers, which are appended to the end of the substitution
        command:</p>

        <blockquote>
        <table summary="" class="bordered uncolored">
          <tr valign="top">
            <td align="left" class="code">g&nbsp;</td>
            <td>Substitute for all occurrences of the regular
                expression, not just the first one</td>
          </tr>

          <tr valign="top">
            <td align="left" class="code">i&nbsp;</td>
            <td>Do case-insensitive pattern matching. Case-sensitive
              pattern matching is the default.</td>
          </tr>

          <tr valign="top">
            <td align="left" class="code">m&nbsp;</td>
            <td>Treat the string is consisting of multiple lines.
                This modifier changes the meaning of "^" and "$" so that
                they match just after or just before, respectively, a
                line terminator or the end of the input sequence. By
                default these expressions only match at the beginning
                and the end of the entire input sequence.</td>
          </tr>
        </table>
        </blockquote>

        <p>The modifiers can be concatenated. Thus,</p>

        <blockquote><pre>'s/abc/xyz/ig'</pre></blockquote>

        <p>will match and replace all occurrences of the string "abc",
        whether upper-, lower- or mixed-case.</p>

        <p>Hint: When <a href="#opt-logging">logging is enabled</a>,
        <i>curn</i> will log the parsed expression at the "debug"
        log level.</p>

    </td>
    <td align="left">No</td>
    <td align="left">None</td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Feed_PruneURLs"></a><span class="code">PruneURLs</span><br/>
      <a href="#PlugIn_EditParsedFeedURL" class="plug-in-flag">plug-in</a></td>
</td>
    <td align="left">Boolean</td>
    <td align="left">Specifies that all URLs should be pruned of their
      HTTP parameters. This action can also be accomplished with
      <a href="#Feed_EditItemURL" class="code">EditItemURL</a> and
      <a href="#Feed_EditFeedURL" class="code">EditFeedURL</a> directives;
      <span class="code">PruneURLs</span> is convenient shorthand for a
      common operation.
    </td>
    <td align="left">No</td>
    <td align="left">None</td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Feed_ReplaceEmptySummaryWith"></a><span class="code">ReplaceEmptySummaryWith</span><br/><a href="#PlugIn_EmptyArticleSummary" class="plug-in-flag">plug-in</a></td>
    <td align="left">String</td>
    <td align="left">
      Tells <i>curn</i> what to do when the summary for a feed
      article is missing. Legal values:

      <ul>
	<li><i>nothing</i>: Leave the summary blank. This is the default.
	<li><i>content</i>: Replace the summary with the article's content,
            if there is any content.
	<li><i>title</i>: Replace the summary with the article's title.
      </ul>

      This per-feed setting overrides the
      <a href="#Cfg_ReplaceEmptySummaryWith">global setting</a>.
    </td>
    <td align="left">No</td>
    <td align="left" class="code">nothing</td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Feed_SaveAs"></a><span class="code">SaveAs</span><br/><a href="#PlugIn_SaveAs" class="plug-in-flag">plug-in</a></td>
    <td align="left">[options] Path</td>
    <td align="left">If set, this parameter specifies the path to
      a file where <i>curn</i> should save the raw XML contents of
      the feed, whenever it downloads the feed. This can be useful
      if you have a master version of <i>curn</i> that downloads
      a bunch of feeds, with multiple slave versions of <i>curn</i>
      that then run against the downloaded files. (See
      <a href="#Bandwidth">Being Bandwidth Friendly</a> for a more
      detailed discussion of this tactic.)
      <br><br>
      This configuration item takes a command line-style value:
     <blockquote><pre>SaveAs: [--backups <i>total_backups</i>] [--encoding <i>encoding</i>] <i>path</i></pre></blockquote>

     or

     <blockquote><pre>SaveAs: [-b <i>total_backups</i>] [-e <i>encoding</i>] <i>path</i></pre></blockquote>

     The parameters have the following meanings:

     <ul>
       <li><i>total_backups</i> specifies how many backups (i.e., previous
	   versions) of the generated RSS file to keep. For instance, a value
	   of 5 means "keep 5 previous versions of the file, plus the one
	   from the current run." This is the best way to keep RSS files from
	   previous <i>curn</i> runs. The backup files have version numbers
	   preceding their extensions. For instance, if the output file is
	   <span class="filename">foo.xml</span>, and <i>total_backups</i> is
	   2, <i>curn</i> will keep <span class="filename">foo.0.xml</span>
	   and <span class="filename">foo.1.xml</span>. The file with the
	   largest version number is the oldest one. If not specified, this
	   parameter defaults to 0, which means "no backups".<br><br>
       <li><i>encoding</i> is optional and specifies the desired encoding of the file. It defaults to "utf-8".<br><br>
       <li><i>path</i> is the path to the file where the raw RSS data should be written.
     </ul>

      Note: Often, <i>curn</i> can't tell whether there's any new data in a feed without downloading
      it. (This is true, for instance, if the remote HTTP server doesn't supply a valid
      <span class="code">Last-Modified</span> header, or if it doesn't honor the
      <span class="code">If-Modified-Since</span> header.) If <i>curn</i> decides it has to
      download a feed, and the feed has a configured <span class="code">SaveAs</span> value, the
      feed will be saved <b>even if <i>curn</i> later decides there's no new data in the feed.</b>
    </td>
    <td align="left">No</td>
    <td align="left">None</td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Feed_SaveAsEncoding"></a><span class="code">SaveAsEncoding</span><br/><a href="#PlugIn_SaveAs" class="plug-in-flag">plug-in</a></td>
    <td align="left">String</td>
    <td align="left">If set, and if
      <a href="#Feed_SaveAs" class="code">SaveAs</a> parameter is also
      set, then this parameter specifies the character
      encoding to use when saving the feed to the file.
      If <span class="code">SaveAs</span> is not set for the feed,
      then any <span class="code">SaveAsEncoding</span> parameter is
      ignored.<br><br>
      <b>WARNING:</b> This parameter is deprecated. Use the
      <span class="code"><i>--encoding</i></span> option to the
      <a href="#Feed_SaveAs" class="code">SaveAs</a>
      parameter, instead.
    <td align="left">No</td>
    <td align="left">"utf-8". Note that this default value is the same
      as the default value of the
      <a href="#Feed_ForceEncoding">ForceEncoding</a>, for
      <span class="code">file</span> URLs. This makes it easy to have
      one instance of <i>curn</i> save RSS feeds for other instances to
      parse.</td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Feed_SaveOnly"></a><span class="code">SaveOnly</span><br/><a href="#PlugIn_SaveAs" class="plug-in-flag">plug-in</a></td>
    <td align="left">Boolean</td>
    <td align="left">If set, and if
     <a href="#Feed_SaveAs" class="code">SaveAs</a> is also set,
      then the feed will be downloaded and saved, but not parsed and
      not included in the generated output. This parameter can be
      useful when <a href="#Bandwidth">Being Bandwidth Friendly</a>.
    <td align="left">No</td>
    <td align="left" class="code">false</td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Feed_SaveAsRSS"></a><span class="code">SaveAsRSS</span><br/><a href="#PlugIn_SaveAsRSS" class="plug-in-flag">plug-in</a></td>
    <td align="left">[options] Path</td>
    <td align="left">If set, this parameter specifies that the feed should be rewritten in the specified
     RSS format and saved to the specified file. This configuration item takes a command line-style value:
     <blockquote><pre>SaveAsRSS: [--backups <i>total_backups</i>] [--type <i>rsstype</i>] [--encoding <i>encoding</i>] <i>path</i></pre></blockquote>

     or

     <blockquote><pre>SaveAsRSS: [-b <i>total_backups</i>] [-t <i>rsstype</i>] [-e <i>encoding</i>] <i>path</i></pre></blockquote>

     The parameters have the following meanings:

     <ul>
       <li><i>total_backups</i> specifies how many backups (i.e., previous
	   versions) of the generated RSS file to keep. For instance, a value
	   of 5 means "keep 5 previous versions of the file, plus the one
	   from the current run." This is the best way to keep RSS files from
	   previous <i>curn</i> runs. The backup files have version numbers
	   preceding their extensions. For instance, if the output file is
	   <span class="filename">foo.xml</span>, and <i>total_backups</i> is
	   2, <i>curn</i> will keep <span class="filename">foo.0.xml</span>
	   and <span class="filename">foo.1.xml</span>. The file with the
	   largest version number is the oldest one. If not specified, this
	   parameter defaults to 0, which means "no backups".<br><br>
       <li><i>rsstype</i> is the type of RSS output to generate. Currently, "rss1", "rss2" and "atom" are the supported values.<br><br>
       <li><i>encoding</i> is optional and specifies the desired encoding of the file. It defaults to "utf-8".<br><br>
       <li><i>path</i> is the path to the file where the RSS output should be written.
     </ul>
     Note that only the new data in the feed is converted to RSS.
    <td align="left">No</td>
    <td align="left" class="code">None</td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Feed_SaveRSSOnly"></a><span class="code">SaveRSSOnly</span><br/><a href="#PlugIn_SaveAsRSS" class="plug-in-flag">plug-in</a></td>
    <td align="left">Boolean</td>
    <td align="left">If set, and if
     <a href="#Feed_SaveAsRSS" class="code">SaveAsRSS</a> is also set,
     then the feed will be downloaded and parsed, and the RSS output will be generated, but the
     feed will <i>not</i> be passed to any output handlers (or, for that matter, any other plug-ins).
    <td align="left">No</td>
    <td align="left" class="code">false</td>
  </tr>

  <tr valign="top">
    <td align="left" class="code"><a name="Feed_SavedBackups"></a>SavedBackups</td>
    <td align="left">Positive integer</td>
    <td align="left">Number of saved backups to keep. If this value is
      non-zero, the handler will back the <span class="code">SaveAs</span>
     file up before overwriting it. Up to <span class="code">SavedBackups</span>
     total backed-up files will be kept. A value of 0 disables the feature.
    <td align="left">No</td>
    <td align="left">0</td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Feed_ShowAuthors"></a><span class="code">ShowAuthors</span>
    <br/><a href="#PlugIn_ShowAuthors" class="plug-in-flag">plug-in</a></td>
    <td align="left">Boolean</td>
    <td align="left">
      If set to <span class="code">true</span>, this configuration item instructs <i>curn</i>
      to display author version for this feed, if available.
      This value overrides the global
      <a href="#Cfg_ShowAuthors" class="code">ShowAuthors</a> parameter.
    </td>
    <td align="left">No</td>
    <td align="left">The value of the global
      <a href="#Cfg_ShowAuthors" class="code">ShowAuthors</a> parameter.
    </td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Feed_ShowDates"></a><span class="code">ShowDates</span>
    <br/><a href="#PlugIn_ShowDates" class="plug-in-flag">plug-in</a></td>
    <td align="left">Boolean</td>
    <td align="left">
      If set to <span class="code">true</span>, this configuration item instructs <i>curn</i>
      to display any dates associated with this feed, if available.
      This value overrides the global
      <a href="#Cfg_ShowDates" class="code">ShowDates</a> parameter.
    </td>
    <td align="left">No</td>
    <td align="left">The value of the global
      <a href="#Cfg_ShowDates" class="code">ShowDates</a> parameter.
    </td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Feed_SortBy"></a><span class="code">SortBy</span><br/><a href="#PlugIn_SortArticles" class="plug-in-flag">plug-in</a></td>
    <td align="left">String</td>
    <td align="left">
      How to sort items in this feed. This value locally overrides the
      global <a href="#Cfg_SortBy" class="code">SortBy</a> parameter
      in the <a href="#CfgCurnSection" class="code">[curn]</a> section.
      Legal values:

      <ul>
        <li><span class="code">time</span>: Sort by timestamp, if
            present. Current time is assumed for items that don't have
            timestamps.
        <li><span class="code">title</span>: Sort by item title, if
            present. Any item without a title is sorted as if its
            title were the empty string ("").
        <li><span class="code">none</span>: Don't sort (i.e., leave
            items in the order they appear in the XML).
      </ul>
    </td>
    <td align="left">No</td>
    <td align="left">
      The value of the global
      <a href="#Cfg_SortBy" class="code">SortBy</a>
      parameter in the <span class="code">[curn]</span> section.</td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Feed_SummaryOnly"></a><span class="code">SummaryOnly</span><br/><a href="#PlugIn_FeedSummaryOnly" class="plug-in-flag">plug-in</a></td>
    <td align="left">Boolean</td>
    <td align="left">
      Some RSS feeds provide a description for each item, in addition
      to the (brief) title. Setting <span class="code">SummaryOnly</span>
      to <span class="code">true</span> suppresses display of the description. This parameter
      overrides the global
      <a href="#Cfg_SummaryOnly" class="code">SummaryOnly</a> parameter.
      <br/><br/>
      <b>WARNING:</b> This parameter is deprecated. Use the
      <a href="#Feed_ReplaceEmptySummaryWith" class="code">ReplaceEmptySummaryWith</a>
      parameter, instead.
    </td>
    <td align="left">No</td>
    <td align="left">The value of the global
      <a href="#Cfg_SummaryOnly" class="code">SummaryOnly</a> parameter.
    </td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Feed_TitleOverride"></a><span class="code">TitleOverride</span><br/><a href="#PlugIn_OverrideFeedTitle" class="plug-in-flag">plug-in</a></td>
    <td align="left">String</td>
    <td align="left">Specifies a string to be used as the site's
      title, instead of the title supplied in the RSS XML. Useful
      when the real site-supplied title is not suitable.
    </td>
    <td align="left">No</td>
    <td align="left">None</td>
  </tr>

  <tr valign="top">
    <td align="left" class="code">URL</td>
    <td align="left">String</td>
    <td align="left">The fully-qualified URL for the feed. For local
    files, use a "<span class="code">file:</span>" URL.
    </td>
    <td align="left">Yes</td>
    <td align="left">None</td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="Feed_UserAgent"></a><span class="code">UserAgent</span><br/><a href="#PlugIn_UserAgent" class="plug-in-flag">plug-in</a></td>
    <td align="left">String</td>
    <td align="left">
      Specifies the HTTP <span class="code">User-Agent</span> header to use when
      retrieving this feed. This local value overrides the global
      <a href="#Cfg_UserAgent" class="code">UserAgent</a> parameter
      in the <a href="#CfgCurnSection" class="code">[curn]</a> section.
      This configuration parameter permits you to have <i>curn</i>
      masquerade as a known browser, and it's useful for sites that
      refuse access to robots and spiders and other unknown web clients.
    </td>
    <td align="left">No</td>
    <td align="left">
      The value of the global
      <a href="#Cfg_UserAgent" class="code">UserAgent</a>
      parameter in the <span class="code">[curn]</span> section.</td>
  </tr>

  </tbody>
</table>
<br clear="all"/>

<!-- ********************************************************************** -->
<h2><a name="CfgOutputHandlers"></a>Configuring Output Handlers</h2>

<h3><a name="CfgOutputHandlerSections"></a>Output Handler Sections</h3>

<p>As <i>curn</i> processes each RSS feed, it parses the XML and loads the
new items into internal data structures. When it has finished processing
the XML, it hands the parsed data structures to one or more output
handlers. Output handlers are so called because they generally produce output
that's to be displayed or emailed to the user&#8212;generally, but not
always. An output handler may choose to save its output to a file, but not
send the output back to <i>curn</i>; each of the built-in output handlers
does exactly that if its <span class="code">SaveAs</span> configuration
parameter is set and its
<span class="code">SaveOnly</span> configuration parameters is <tt>true</tt>.
Alternatively, the output handler may choose to convert the internal data
structures to output that it publishes somewhere (e.g., via a network
connection to an HTTP server).</p>

<p>Each output handler is specified in its own section in the configuration
file. The name of the section must start with the string "OutputHandler".
If more than one output handler is present, then each section name must also
have additional characters, to make the section name unique. The following
section names are all valid for output handler sections.</p>

<ul>
  <li><span class="code">OutputHandler</span> (if there's only one output
      handler)
  <li><span class="code">OutputHandlerHTML</span>
  <li><span class="code">OutputHandlerText</span>
  <li><span class="code">OutputHandler1</span>
  <li><span class="code">OutputHandler_asdf</span>
</ul>

<p> If no <span class="code">OutputHandler</span> sections are present in
the configuration file, <i>curn</i> skips the RSS XML parsing phase.
(There's not reason to parse the XML if there are no output handlers to
process the parsed feed data.) If there are no output handlers, <i>curn</i>
may or may not download individual feeds. If a given feed has no
<a href="#Feed_SaveAs" class="code">SaveAs</a>
setting, and there are no output handlers, then <i>curn</i> skips the feed
entirely. After all, there's no sense wasting time downloading the feed, if
the feed isn't being parsed or saved. However, if the feed does have a
<span class="code">SaveAs</span> setting, <i>curn</i> will download
and save the XML (assuming it has changed) even if XML parsing is disabled.</p>

<p>All output handler sections take two variables. In addition, individual
output handlers can require configuration items of their own. The two
variables common to all output handlers are described below.</p>

<table summary="" class="outlined striped" align="center" width="90%">
  <tr valign="bottom" class="col-headers">
    <th align="left">Variable</th>
    <th align="left">Argument type</th>
    <th align="left">Description</th>
    <th align="left">Required?</th>
    <th align="left">Default Value</th>
  </tr>

  <tbody>
  <tr valign="top">
    <td align="left" class="code">Class</td>
    <td>String</td>
    <td align="left">Identifies Java class that implements the output
    handler. (The class must implement the
    <a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/OutputHandler.html" class="code">org.clapper.curn.OutputHandler</a>
    interface. See
    <a href="#NewOutputHandler">Writing Your Own Output Handler</a>
    for details.)
    </td>
    <td align="left">Yes</td>
    <td align="left">&nbsp;</td>
  </tr>

  <tr valign="top">
    <td align="left" class="code"><a name="OutputHandler_Disabled">Disabled</a></td>
    <td>Boolean</td>
    <td align="left">If <span class="code">true</span>, the output handler is skipped.
    If <span class="code">false</span>, the output handler is processed. This variable
    provides a simple way to disable an output handler without having
    to comment its entire section out.
    </td>
    <td align="left">No</td>
    <td align="left" class="code">false</td>
  </tr>
  </tbody>
</table>
<br clear="all"/>

<p>There are some output handler
<a href="#CfgOutputHandlerExamples">examples</a> following the next
section.</p>

<h3><a name="CfgPredefinedOutputHandlers"></a>Predefined Output Handlers</h3>

<p><i>curn</i> comes bundled with the following built-in output handlers.</p>

<h4><a name="FreeMarkerOutputHandler" class="code">FreeMarkerOutputHandler</a></h4>

<dl class="dlSummary">
  <dt>Class
  <dd class="code">org.clapper.curn.output.freemarker.FreeMarkerOutputHandler

  <dt>Purpose
  <dd>Uses the <a href="http://freemarker.sourceforge.net/">FreeMarker</a>
      template engine and a configured template to generate output.
</dl>

<h5>Using the FreeMarker output handler</h5>

<p>The <span class="code">FreeMarkerOutputHandler</span>, introduced in
<i>curn</i> version 2.6, is both simple and flexible. It uses the
<a href="http://freemarker.sourceforge.net/">FreeMarker</a> template engine
to convert a template to an output file. FreeMarker templates can be used
to generate nearly any kind of textual output file, from HTML and XML to
simple text. In fact, the
<a href="#HTMLOutputHandler" class="code">HTMLOutputHandler</a>,
<a href="#TextOutputHandler" class="code">TextOutputHandler</a>, and
<a href="#SimpleSummaryOutputHandler" class="code">SimpleSummaryOutputHandler</a>
have been reimplemented to use the
<span class="code">FreeMarkerOutputHandler</span> in conjunction with
built-in templates that produce the appropriate kind of output.</p>

<table summary="" class="outlined striped cell-outlined" align="center" width="90%">
  <tr class="title">
    <th colspan="5">Additional Configuration Items</th>
  </tr>
  <tr valign="bottom" class="col-headers">
    <th align="left">Variable</th>
    <th align="left">Argument type</th>
    <th align="left">Explanation</th>
    <th align="left">Required?</th>
    <th align="left">Default value</th>
  </tr>
  <tbody>
  <tr valign="top">
    <td align="left" class="code">AllowEmbeddedHTML</td>
    <td align="left">Boolean</td>
    <td align="left">Whether or not the specified
    <a href="#Freemarker_TemplateFile">template</a> supports
    embedded HTML. If embedded HTML is found within an RSS item, it will
    be included in the generated output <b>only</b> if (a) this parameter
    is <span class="code">true</span>, and (b) the
    <a href="#Feed_AllowEmbeddedHTML" class="code">AllowEmbeddedHTML</a>
    parameter for the feed is also <tt>true</tt>. Otherwise, embedded
    HTML will be stripped from the item.
    </td>
    <td align="left">No</td>
    <td align="left" class="code">false</td>
  </tr>

  <tr valign="top">
    <td align="left" class="code">Encoding</td>
    <td align="left">String</td>
    <td align="left">Specify the character encoding to use
    when writing the output file.
    </td>
    <td align="left">No</td>
    <td align="left">"utf-8"</td>
  </tr>

  <tr valign="top">
    <td align="left" class="code">SaveAs</td>
    <td align="left">File name or path name</td>
    <td align="left">Save a copy of the generated HTML to the
    specified file. The argument is the path to the file. <b>WARNING:
    The syntax of this parameter is different from the syntax of the
    <a href="#Feed_SaveAs" class="code">SaveAs</a> parameter for a feed.</b>
    </td>
    <td align="left">No</td>
    <td align="left">None (i.e., no copy is saved)
    </td>
  </tr>
  <tr valign="top">
    <td align="left" class="code">SaveOnly</td>
    <td align="left">Boolean</td>
    <td align="left">If <span class="code">true</span> and if
    <span class="code">SaveAs</span> is defined, then save a copy
    of the generated HTML, but don't make it available to the user.
    (i.e., Don't display it on standard output, and don't email
    it.)
    </td>
    <td align="left">No</td>
    <td align="left" class="code">false</td>
  </tr>
  <tr valign="top">
    <td align="left" class="code">ShowCurnInfo</td>
    <td align="left">Boolean</td>
    <td align="left">Whether or not to display the <i>curn</i>
    version, <i>curn</i> configuration file path, and other
    <i>curn</i>-related information at the bottom of the generated
    HTML.
    </td>
    <td align="left">No</td>
    <td align="left" class="code">true</td>
  </tr>
  <tr valign="top">
    <td align="left" class="code"><a name="Freemarker_TemplateFile"></a>TemplateFile</td>
    <td align="left">Two strings</td>
    <td align="left">Specifies the location of the FreeMarker template file.
      The location is specified with three parameters:
      <ul>
	<li>the <i>type</i>, which may be <tt>file</tt>,
	    <tt>classpath</tt>, <tt>url</tt> or <tt>builtin</tt>
	<li>an <i>identifier</i> string
	<li>a <i>MIME type</i> for the generated output. This parameter, if omitted, defaults
	    to "text/plain"
      </ul>

      <p>The form of the identifier string depends on the <i>type</i> value.</p>

      <!--
          <dl class="dlSummary"> would work well here, except IE (6) misparses
          it and screws up the surrounding table.
      -->

      <table summary="" class="unbordered" align="center">
	<tr valign="top">
	<td class="code"><a href="#builtin-templates">builtin</a></td>
	<td>The identifier specifies one of the built-in <i>curn</i>
	    FreeMarker templates that are bundled in the <i>curn</i> jar
	    file. There are three legal values:
	    <ul>
	      <li><span class="code">html</span>: the HTML template, which
	          generates <a href="#HTMLOutputHandler">HTML output</a></li>
	      <li><span class="code">summary</span>: a plain text template
		  that generates a simple
		  <a href="#SimpleSummaryOutputHandler">text summary</a></li>
	      <li><span class="code">text</span>: a template that
		  generates output containing the same information as the
		  HTML template, but in
		  <a href="#TextOutputHandler">plain text</a> form
	      </li>
	    </ul>

	    Examples:
	    <blockquote><pre>
TemplateFile: builtin html
TemplateFile: builtin summary</pre></blockquote>
	</td>
        </tr>

	<tr valign="top">
	<td class="code">classpath</td>
	<td>The identifier must be a relative path to a template file that can
	    be found by searching the directories and jar files in the
	    Java classpath.
	    <p>Examples:</p>
	    <blockquote><pre>
TemplateFile: classpath org/clapper/curn/output/freemarker/HTML.ftl
TemplateFile: classpath com/example/mycurn/output/text.ftl</pre></blockquote>
	</td>
	</tr>

	<tr valign="top">
        <td class="code">file</td>
        <td>The identifier must be the path
	    (relative or absolute) to the template file.
	    <p>Examples:</p>
	    <blockquote><pre>
TemplateFile: file 'C:\curn\html.ftl'
TemplateFile: file "${system:user.home}\\curn\\text.ftl"
TemplateFile: file ../.curn/summary.ftl</pre></blockquote>

	  <b>NOTE:</b>
	  <ol>
	    <li>Note the use of single quotes in the first example; they escape
	        the special meaning of the backslash character.</li>
 	    <li>If there <i>any</i> chance that the file name will contain
		white space&#8212;either <i>before</i> or <i>after</i>
		variable substitution&#8212;you <i>must</i> enclose it in either single
		or double quotes. Otherwise, the white space in the file name
		will confuse <i>curn</i>. (If the value contains a variable substitution
		or metacharacters, then you must use double quotes, since
		variable and metacharacter expansion don't occur within
		single quotes.) So, in the second example, above,
		<span class="code">${system:user.home}\\curn\\text.ftl</span>
		is double-quoted, in case the home directory is something
		like <span class="filename">C:\My Documents</span>.
 </li>
	  </ol>
	</td>
	</tr>

	<tr valign="top">
	<td class="code">url</td>
	<td>The identifier must be a URL that specifies the location of the
	    FreeMarker template to use.

	    <p>Examples:</p>
	    <blockquote><pre>
TemplateFile: url http://localhost/curn-templates/html.ftl
TemplateFile: url ftp://ftp.example.com/curn-templates/text.ftl
TemplateFile: url "${program:cwd.url}/curn/bin/html.ftl"</pre></blockquote>

	  Note the use of double quotes in the third example. As with the
	  <span class="code">file</span> type, if there <i>any</i> chance
	  that the URL will contain white space&#8212;either <i>before</i>
	  or <i>after</i> variable substitution&#8212;you <i>must</i>
	  enclose it in either single or double quotes. Otherwise, the
	  white space in the file name will confuse <i>curn</i>. So, in
	  that last example above,
	  <span class="code">${program:cwd:url}/curn/bin/html.ftl</span>
	  might very well expand to
	  <span class="filename">file:/C:/Program Files/clapper.org/curn/bin/html.ftl</span>
	  on a Windows system. Double-quoting it is necessary, because of the
	  blank in <span class="filename">Program Files</span>.
	</td>
	</tr>
      </table>
    </td>
    <td align="left">Yes</td>
    <td align="left">&nbsp;</td>
  </tr>
  <tr valign="top">
    <td align="left" class="code">Title</td>
    <td align="left">String</td>
    <td align="left">If set, this string overrides the title
    and the topmost heading in the generated HTML.
    </td>
    <td align="left">No</td>
    <td align="left" class="code">RSS Feeds</td>
  </tr>
  <tr valign="top">
    <td align="left" class="code">TOCItemThreshold</td>
    <td align="left">Positive integer</td>
    <td align="left">The total number of items (not feeds, but
    individual items) that must be displayed before curn will
    generate a table of contents header in the HTML. A value of 0
    causes curn to generate a table of contents regardless of how
    many items are displayed.
    </td>
    <td align="left">No</td>
    <td align="left">A very large number, which effectively disables the table of contents entirely. </td>
  </tr>
  </tbody>
</table>
<br clear="all"/>

<p>You can also write your own FreeMarker template, to change the output
format. See the subsection entitled
<a href="#WriteFreeMarkerTemplate">Writing Your Own FreeMarker template</a>,
in the <a href="#ExtendingCurn">Extending <i>curn</i></a> section, below.</p>x

<h4><a name="HTMLOutputHandler" class="code">HTMLOutputHandler</a></h4>

<dl class="dlSummary">
  <dt>Class
  <dd class="code">org.clapper.curn.output.html.HTMLOutputHandler

  <dt>Purpose
  <dd>Produces an HTML description of the new RSS items. You can find a
      sample of its output <a href="output/HTMLOutput.html">here</a>.

  <dt>Note
  <dd>Prior to version 2.6, this output handler used custom code and the
      <a href="http://xmlc.objectweb.org/">XMLC</a> library to generate
      its HTML output. However, that approach made it difficult to customize
      the HTML output for individual sites. As of <i>curn</i>, version 2.6,
      the <span class="code">HTMLOutputHandler</span> is implemented in
      terms of the
      <a href="#FreeMarkerOutputHandler" class="code">FreeMarkerOutputHandler</a>.
      The <span class="code">HTMLOutputHandler</span> class uses the
      <span class="code">FreeMarkerOutputHandler</span>'s
      built-in HTML template, so the output from the
      <span class="code">HTMLOutputHandler</span> class is identical to the
      output from the <span class="code">FreeMarkerOutputHandler</span>
      class when the "builtin html" template is used.
      You can continue to use the
      <span class="code">HTMLOutputHandler</span> class, but it is no longer
      maintained. Plus, the <span class="code">FreeMarkerOutputHandler</span>
      class is more flexible.
</dl>

<table summary="" class="outlined striped cell-outlined" align="center" width="90%">
  <tr class="title">
    <th colspan="5">Additional Configuration Items</th>
  </tr>
  <tr valign="bottom" class="col-headers">
    <th align="left">Variable</th>
    <th align="left">Argument type</th>
    <th align="left">Explanation</th>
    <th align="left">Required?</th>
    <th align="left">Default value</th>
  </tr>
  <tbody>
  <tr valign="top">
    <td align="left" class="code">HTMLEncoding</td>
    <td align="left">String</td>
    <td align="left">Specify the character encoding to use
    when writing the HTML. The encoding will be stored in an
    HTML &lt;META&gt; tag, and it will be used by the Java runtime
    when opening the output file (to ensure proper translation of
    characters from the in-memory Unicode character set). This parameter
    is mapped to the <a href="#FreeMarkerOutputHandler" class="code">FreeMarkerOutputHandler</a>'s
    <span class="code">encoding</span> parameter.
    </td>
    <td align="left">No</td>
    <td align="left">"utf-8"</td>
  </tr>
  <tr valign="top">
    <td align="left" class="code">SaveAs</td>
    <td align="left">File name or path name</td>
    <td align="left">Save a copy of the generated HTML to the
    specified file. The argument</td>
    <td align="left">No</td>
    <td align="left">None (i.e., no copy is saved)
    </td>
  </tr>
  <tr valign="top">
    <td align="left" class="code">SaveOnly</td>
    <td align="left">Boolean</td>
    <td align="left">If <span class="code">true</span> and if
    <span class="code">SaveAs</span> is defined, then save a copy
    of the generated HTML, but don't make it available to the user.
    (i.e., Don't display it on standard output, and don't email
    it.)
    </td>
    <td align="left">No</td>
    <td align="left" class="code">false</td>
  </tr>
  <tr valign="top">
    <td align="left" class="code">ShowCurnInfo</td>
    <td align="left">Boolean</td>
    <td align="left">Whether or not to display the <i>curn</i>
    version, <i>curn</i> configuration file path, and other
    <i>curn</i>-related information at the bottom of the generated
    HTML.
    </td>
    <td align="left">No</td>
    <td align="left" class="code">true</td>
  </tr>
  <tr valign="top">
    <td align="left" class="code">Title</td>
    <td align="left">String</td>
    <td align="left">If set, this string overrides the title
    and the topmost heading in the generated HTML.
    </td>
    <td align="left">No</td>
    <td align="left" class="code">RSS Feeds</td>
  </tr>
  <tr valign="top">
    <td align="left" class="code">TOCItemThreshold</td>
    <td align="left">Positive integer</td>
    <td align="left">The total number of items (not feeds, but
    individual items) that must be displayed before curn will
    generate a table of contents header in the HTML. A value of 0
    causes curn to generate a table of contents regardless of how
    many items are displayed.
    </td>
    <td align="left">No</td>
    <td align="left">A very large number, which effectively disables the table of contents entirely. </td>
  </tr>
  </tbody>
</table>
<br clear="all"/>

<h4><a name="TextOutputHandler" class="code">TextOutputHandler</a></h4>

<dl class="dlSummary">
  <dt>Class
  <dd class="code">org.clapper.curn.output.TextOutputHandler

  <dt>Purpose
  <dd>Produces a plain text description of the new RSS items. You can
      find a sample of its output
      <a href="output/TextOutput.txt">here</a>.

  <dt>Note
  <dd>As of <i>curn</i>, version 2.6, this output handler is implemented in
      terms of the
      <a href="#FreeMarkerOutputHandler" class="code">FreeMarkerOutputHandler</a>.
      It forces use of the <span class="code">FreeMarkerOutputHandler</span>'s
      built-in "text" template. You can continue to use the
      <span class="code">TextOutputHandler</span> class, but it is no longer
      maintained. Plus, the <span class="code">FreeMarkerOutputHandler</span>
      class is more flexible.
</dl>

<table summary="" class="outlined striped cell-outlined" align="center" width="90%">
  <tr class="title">
    <th colspan="5">Additional Configuration Items</th>
  </tr>
  <tr valign="bottom" class="col-headers">
    <th align="left">Variable</th>
    <th align="left">Argument type</th>
    <th align="left">Explanation</th>
    <th align="left">Required?</th>
    <th align="left">Default value</th>
  </tr>
  <tbody>
  <tr valign="top">
    <td align="left" class="code">SaveAs</td>
    <td align="left">File name or path name</td>
    <td align="left">Save a copy of the generated text to the
    specified file. The argument</td>
    <td align="left">No</td>
    <td align="left">None (i.e., no copy is saved)
    </td>
  </tr>
  <tr valign="top">
    <td align="left" class="code">SaveOnly</td>
    <td align="left">Boolean</td>
    <td align="left">If <span class="code">true</span> and if
    <span class="code">SaveAs</span> is defined, then save a copy
    of the generated text, but don't make it available to the user.
    </td>
    <td align="left">No</td>
    <td align="left" class="code">false</td>
  </tr>
  <tr valign="top">
    <td align="left" class="code">ShowCurnInfo</td>
    <td align="left">Boolean</td>
    <td align="left">Whether or not to display the <i>curn</i>
    version, <i>curn</i> configuration file path, and other
    <i>curn</i>-related information at the bottom of the generated
    output.
    </td>
    <td align="left">No</td>
    <td align="left" class="code">true</td>
  </tr>
  </tbody>
</table>
<br clear="all"/>

<h4><a name="SimpleSummaryOutputHandler" class="code">SimpleSummaryOutputHandler</a></h4>

<dl class="dlSummary">
  <dt>Class
  <dd class="code">org.clapper.curn.output.SimpleSummaryOutputHandler

  <dt>Purpose
  <dd>Produces a plain text summary of the new RSS items. For each
      RSS feed that has new items, this output handler shows the feed's
      name, its URL, and the number of new items. It does not show the
      items themselves. You can find
      a sample of its output <a href="output/SummaryOutput.txt">here</a>.

  <dt>Note
  <dd>As of <i>curn</i>, version 2.6, this output handler is implemented in terms of the
      <a href="#FreeMarkerOutputHandler" class="code">FreeMarkerOutputHandler</a>.
      It forces use of the <span class="code">FreeMarkerOutputHandler</span>'s
      built-in "summary" template. You can continue to use the
      <span class="code">SimpleSummaryOutputHandler</span> class, but it is no longer
      maintained. Plus, the <span class="code">FreeMarkerOutputHandler</span>
      class is more flexible.
</dl>

<table summary="" class="outlined striped cell-outlined" align="center" width="90%">
  <tr class="title">
    <th colspan="5">Additional Configuration Items</th>
  </tr>
  <tr valign="bottom" class="col-headers">
    <th align="left">Variable</th>
    <th align="left">Argument type</th>
    <th align="left">Explanation</th>
    <th align="left">Required?</th>
    <th align="left">Default value</th>
  </tr>
  <tbody>
  <tr valign="top">
    <td align="left" class="code">SaveAs</td>
    <td align="left">File name or path name</td>
    <td align="left">Save a copy of the generated text to the
    specified file. The argument is a relative or absolute path
    to the file where the feed's XML should be saved.</td>
    <td align="left">No</td>
    <td align="left">None (i.e., no copy is saved)
    </td>
  </tr>
  <tr valign="top">
    <td align="left" class="code">SaveOnly</td>
    <td align="left">Boolean</td>
    <td align="left">If <span class="code">true</span> and if
    <span class="code">SaveAs</span> is defined, then save a copy
    of the generated text, but don't make it available to the user.
    </td>
    <td align="left">No</td>
    <td align="left" class="code">false</td>
  </tr>
  <tr valign="top">
    <td align="left" class="code">Message</td>
    <td align="left">String</td>
    <td align="left">Static text that is to be included in the
    output. The text appears right after the heading line and
    before the actual summary of the RSS feeds. The
    <a href="output/SummaryOutput.txt">sample output</a> was
    created using a <span class="code">Message</span> value that
    points to a URL, where (presumably) the output from the
    HTML handler has been saved. See
    <a href="#CfgOutputHandlerExample3">Example 3</a>, below.
    </td>
    <td align="left">No</td>
    <td align="left">Nothing</td>
  </tr>
  <tr valign="top">
    <td align="left" class="code">ShowCurnInfo</td>
    <td align="left">Boolean</td>
    <td align="left">Whether or not to display the <i>curn</i>
    version, <i>curn</i> configuration file path, and other
    <i>curn</i>-related information at the bottom of the generated
    output.
    </td>
    <td align="left">No</td>
    <td align="left" class="code">true</td>
  </tr>
  </tbody>
</table>
<br clear="all"/>

<h4><a name="ScriptOutputHandler" class="code">ScriptOutputHandler</a></h4>

<dl class="dlSummary">
  <dt>Class
  <dd class="code">org.clapper.curn.script.ScriptOutputHandler

  <dt>Purpose
  <dd>Provides an output handler calls a script via the Apache Jakarta
      <a href="http://jakarta.apache.org/bsf/">Bean Scripting Framework (BSF)</a> or the Java 6 (JSR 223) <span class="code">javax.script</span> scripting framework. (The Java 6 scripting framework is only available if you're running <i>curn</i> via Java 6.) By default, the ScriptOutputHandler first tries to use the <span class="code">javax.script</span> infrastructure; if that doesn't work, it tries to the BSF infrastructure. This handler supports any scripting language supported by the underlying scripting infrastructure. For complete details on writing a script output handler,
      See <a href="#NewScriptOutputHandler">Writing a Script Output Handler</a>, below.
</dl>
<table summary="" class="outlined striped cell-outlined" align="center" width="90%">
  <tr class="title">
    <th colspan="5">Additional Configuration Items</th>
  </tr>
  <tr valign="bottom" class="col-headers">
    <th align="left">Variable</th>
    <th align="left">Argument type</th>
    <th align="left">Explanation</th>
    <th align="left">Required?</th>
    <th align="left">Default value</th>
  </tr>
  <tbody>
  <tr valign="top">
    <td align="left" class="code">Script</td>
    <td align="left">File name or path name</td>
    <td align="left">Path to the script to be invoked. The
    script will be called once, as if from the command line,
    except that additional global objects will be available
    via BSF.</td>
    <td align="left">Yes</td>
    <td align="left">None</td>
  </tr>
  <tr valign="top">
    <td align="left" class="code">Language</td>
    <td align="left">String</td>
    <td align="left">
    The scripting language, as recognized by BSF. This
    handler supports all the scripting language engines that
    are built into the BSF distribution. Of course, the jar
    files for the scripting languages themselves must be available at
    runtime, for those languages to be
    available. (See the section entitled
    <a href="#InstallingSupportSoftware" class="sectionRef">Installing Support Software</a> for details.)
    <br><br>
    The following values represent some of the languages available for
    this parameter. The BSF values comes from the
    <span class="filename">Languages.properties</span> file
    distributed with BSF version 2.3.0. The JSR 223 languages are the set
    of languages supported by the JSR 223 engines at
    <a href="https://scripting.dev.java.net/" class="url">https://scripting.dev.java.net/</a>, as of the date this document was last updated. Consult that
    web site for details on available JSR 223 languages.
    <br><br>
    NOTE: In all cases, except Rhino, the actual script language itself
    does <i>not</i> come with the scripting infrastructure; you have to download
    the language separately. The scripting infrastructure merely contains
    bindings to (a.k.a., engines for) the various supported scripting languages.

    <table summary="" class="bordered uncolored" cellspacing="2" align="center" width="90%">
      <tr valign="top">
        <th>Language&nbsp;&nbsp;</th>
	<th><i>curn</i> <span class="code">ScriptOutputHandler Language</span>
	    parameter values for BSF&nbsp;&nbsp;</th>
	<th><i>curn</i> <span class="code">ScriptOutputHandler Language</span>
	    parameter values for JSR 223</th>
      </tr>

      <tr valign="top">
        <td>AWK (via <a href="http://jawk.sourceforge.net/">Jawk</a>)</td>
        <td>&nbsp;</td>
        <td>jawk</td>
      </tr>

      <tr valign="top">
        <td><a href="http://www.beanshell.org/">BeanShell</a></td>
        <td>java</td>
        <td>beanshell</td>
      </tr>

      <tr valign="top">
        <td><a href="http://groovy.codehaus.org/">Groovy</a></td>
        <td>groovy *</td>
        <td>groovy</td>
      </tr>

      <tr valign="top">
        <td><a href="http://www.tcl.tk/software/java/">Jacl (Java TCL)</a></td>
        <td>jacl</td>
        <td>jacl</td>
      </tr>

      <tr valign="top">
        <td>Javascript, via the <a href="http://www.mozilla.org/rhino/">Mozilla Rhino engine</a></td>
        <td>javascript</td>
        <td>javascript</td>
      </tr>

      <tr valign="top">
        <td><a href="http://www.judoscript.com">JudoScript</a></td>
        <td>judoscript</td>
        <td>judoscript</td>
      </tr>

      <tr valign="top">
        <td><a href="http://www.jython.org/">Jython</a></td>
        <td>jython</td>
        <td>jython</td>
      </tr>

      <tr valign="top">
        <td><a href="http://www2.hursley.ibm.com/netrexx/">NetRexx</a></td>
        <td>netrexx</td>
        <td>&nbsp;</td>
      </tr>

      <tr valign="top">
        <td><a href="http://pnuts.org">Pnuts</a></td>
        <td>pnuts *</td>
        <td>pnuts</td>
      </tr>

      <tr valign="top">
        <td>Ruby (via <a href="http://jruby.sourceforge.net/">JRuby</a>)</td>
        <td>ruby</td>
        <td>ruby</td>
      </tr>

      <tr valign="top">
        <td>XSLT Stylesheets (as a component of Apache
                XML project's Xalan and Xerces)</td>
        <td>xslt</td>
        <td>xslt</td>
      </tr>

      <tr valign="bottom" align="center">
        <td colspan="3">* <i>Requires third-party engine implementation available
        from the language web site.</i></td>
      </tr>
    </table>
    </td>
    <td align="left">Yes</td>
    <td align="left" class="code">false</td>
  </tr>
  <tr valign="top">
    <td align="left" class="code">SaveAs</td>
    <td align="left">File name or path name</td>
    <td align="left">Save a copy of the generated text to the
    specified file. The argument is a relative or absolute path
    to the file where the feed's XML should be saved.</td>
    <td align="left">No</td>
    <td align="left">None (i.e., no copy is saved)
    </td>
  </tr>
  <tr valign="top">
    <td align="left" class="code">SaveOnly</td>
    <td align="left">Boolean</td>
    <td align="left">If <span class="code">true</span> and if
    <span class="code">SaveAs</span> is defined, then save a copy
    of the generated text, but don't make it available to the user.
    </td>
    <td align="left">No</td>
    <td align="left" class="code">false</td>
  </tr>
  <tr valign="top">
    <td align="left" class="code"><a name="#Cfg_ScriptingAPI">ScriptingAPI:</a></td>
    <td align="left">String</td>
    <td align="left">Specifies which scripting infrastructure to use. Legal values are:<br><br>
        <table summary="" class="bordered uncolored" cellspacing="2" align="center" width="50%">
          <tr valign="top">
	    <td align="top" class="code">bsf</td>
	    <td align="top">Use Bean Scripting Framework, and abort if it's
	                    not available.</td>
	  </tr>
          <tr valign="top">
	    <td align="top" class="code">javax.script</td>
	    <td align="top">Use JSR 223 Java 6 scripting framework, and abort if it's
	                    not available.</td>
	  </tr>
	</table>
    </td>
    <td align="left">No</td>
    <td align="left">Default behavior: <i>curn</i> first tries to use the JSR 223
                     (<span class="code">javax.script</span>) infrastructure;
                     if that doesn't work, it tries to use BSF. If neither framework
                     is available, and a <span class="code">ScriptOutputHandler</span> is specified, <i>curn</i> aborts.</td>
  </tr>
  <tr valign="top">
    <td align="left" class="code">ShowCurnInfo</td>
    <td align="left">Boolean</td>
    <td align="left">Whether or not to display the <i>curn</i>
    version, <i>curn</i> configuration file path, and other
    <i>curn</i>-related information at the bottom of the generated
    output.<br><br>

    Note: There's no guarantee that a given script will honor
    this setting.
    </td>
    <td align="left">No</td>
    <td align="left" class="code">true</td>
  </tr>
  </tbody>
</table>
<br clear="all"/>

<h3><a name="CfgOutputHandlerExamples"></a>Examples</h3>

<p><a name="CfgOutputHandlerExample1"><span class="exampleHeader">Example 1</span></a>:
The output handler sections from a <i>curn</i> configuration file that
produces HTML output. If <i>curn</i> is called with email addresses, the
HTML output will be mailed to the specified email addresses. The HTML
output is not saved anywhere.</p>

<table summary="" class="bordered uncolored" align="center">
  <tr valign="top">
    <td align="left">
<blockquote><pre>[OutputHandler]
Class: org.clapper.curn.output.html.HTMLOutputHandler
Disabled: false</pre></blockquote>
    </td>
  </tr>
</table>

<p><a name="CfgOutputHandlerExample2"><span class="exampleHeader">Example 2</span></a>:
The output handler sections from a <i>curn</i> configuration file that
produces HTML output and plain text output. If <i>curn</i> is called with
email addresses, the text output and the HTML output will be mailed to the
specified email addresses as "multipart/alternative" attachments. The
output is not saved anywhere.</p>

<table summary="" class="bordered uncolored" align="center">
  <tr valign="top">
    <td align="left">
<blockquote><pre>[OutputHandlerText]
Class: org.clapper.curn.output.TextOutputHandler

[OutputHandlerHTML]
Class: org.clapper.curn.output.html.HTMLOutputHandler
</pre></blockquote>
    </td>
  </tr>
</table>

<p><a name="CfgOutputHandlerExample3"><span class="exampleHeader">Example 3</span></a>:
The output handler sections from a <i>curn</i> configuration file that
produces HTML output to a file (but not to the user), and displays (or emails)
the user a text summary that contains a link to the HTML file.</p>

<table summary="" class="bordered uncolored" align="center">
  <tr valign="top">
    <td align="left">
<blockquote><pre>[OutputHandlerSummary]
Class: org.clapper.curn.output.SimpleSummaryOutputHandler
# Message assumes that generated HTML is available via the web server running
# on internal machine "foo", at the specified location.
Message: See http://foo/rss/news.html

[OutputHandlerHTML]
Class: org.clapper.curn.output.html.HTMLOutputHandler
# Below path is assumed to correspond to URL http://foo/rss/news.html
SaveAs: /usr/local/www/htdocs/rss/news.html
SaveOnly: true
</pre></blockquote>
    </td>
  </tr>
</table>

<p><a name="CfgOutputHandlerExample4"><span class="exampleHeader">Example 4</span></a>:
The feed and output handler sections from a <i>curn</i> configuration file that
retrieves and downloads XML feeds, caching them in a known location, without
displaying them. (See
<a href="#Bandwidth">Being Bandwidth Friendly</a> for reasons why you might
want to do this.)</p>

<table summary="" class="bordered uncolored" align="center">
  <tr valign="top">
    <td align="left">
<blockquote><pre>[vars]
feedDir: ${system:user.home}/.curn/feeds

[curn]
...

[FeedWired]
URL: http://www.wired.com/news_drop/netcenter/netcenter.rdf
SaveAs: ${vars:feedDir}/wired.rdf

[Feed_yahoo_top]
URL: http://rss.news.yahoo.com/rss/topstories
SaveAs: ${vars:feedDir}/yahoo_top_stories.xml

[Feed_cnn_top]
URL: http://csociety.purdue.org/~jacoby/XML/CNN_TOP_STORIES.xml
SaveAs: ${vars:feedDir}/CNN_TOP_STORIES.xml
</pre></blockquote>
    </td>
  </tr>
</table>

<!-- ********************************************************************** -->
<h1><a name="SchedulingCurn">Having <i>curn</i> Run on a Schedule</a></h1>

<p>You can run <i>curn</i> manually, at the command line, whenever you feel
like checking your news feeds. However, this is less than useful. The best
way to run <i>curn</i> to have your computer's background scheduler process
(e.g., <i>cron</i>(8) on UNIX-like systems, or the Windows Scheduler on
Windows) run <i>curn</i> for you automatically, every so often.</p>

<h2><a name="UsingCron">Running <i>curn</i> from <i>cron</i>(8) on UNIX-like Systems</a></h2>

<p>I typically run <i>curn</i> three times a day, via <i>cron</i>, on
weekdays and once on weekends, and I have it mail me the output. I use my
personal crontab, rather than the system-wide
<span class="filename">/etc/crontab</span> file.
Here's a sample crontab entry that does this:</p>

<table summary="" class="bordered uncolored" align="center">
  <tr valign="top">
    <td align="left">
<blockquote><pre>0 8,12,16 * * 1-5  /usr/local/curn/bin/curn $HOME/.curn/my.cfg
0 16 * * 0,6  /usr/local/curn/bin/curn $HOME/.curn/my.cfg</pre></blockquote>
    </td>
  </tr>
</table>

<h2><a name="UsingWindowsScheduler">Running <i>curn</i> via the Windows Scheduler</a></h2>

<p>Currently, this task is left as an exercise to the reader. (I don't use
Windows often enough to play with the scheduler, so I haven't gotten around
to running <i>curn</i> that way. When I do find the time and inclination to
experiment with running <i>curn</i> from the Windows Scheduler, I'll update
this section. Unless, of course, someone else wants to supply the relevant
details...)

<!-- ********************************************************************** -->
<h1><a name="Bandwidth"></a>Being "Bandwidth Friendly"</h1>

<p>When pulling down RSS documents from remote HTTP servers, <i>curn</i>
does its best to minimize the amount of bandwidth it consumes. By default,
it uses the following strategies to do so (though most can be overridden by
configuration parameters and command-line parameters).</p>

<ul>
  <li>Uses the cache to determine how to set the HTTP
      <span class="code">If-Modified-Since</span> header, instructing the
      remote HTTP server to send the RSS document only if it has changed
      since the last time <i>curn</i> retrieved it. (The HTTP server isn't
      required to honor that header.)

  <li>Requests that the remote HTTP server compress the RSS data in
      transit, by setting the HTTP <span class="code">Accept-Encoding</span>
      header to <span class="code">gzip</span>. Again, the HTTP server isn't
      required to honor that header; some do, some don't.
</ul>

<p>But there are other things you can do to be polite to remote HTTP
servers.</p>

<h4><a name="NotTooOften">Don't Run <i>curn</i> Too Often</a></h4>

<p>I run <i>curn</i> three times a day. In practice, that's more than
sufficient to keep up with the daily news feeds I want to read. Your needs
may vary, but if you're using <i>curn</i> to poll remote RSS feeds every
five minutes, you probably fall into the "impolite RSS feed user"
category.</p>

<h4><a name="ConsolidateCommonFeeds"></a>Consolidate Common Feeds</h4>

<p>Suppose you have a number of users, all of whom run <i>curn</i> several
times a day. Further suppose that there's significant commonality in the
RSS feeds that they want to read. Rather than have each user poll the common
remote HTTP servers individually, you could run a single instance of
<i>curn</i> that downloads and saves those feeds several times a day. You could
then instruct the individual users to point their <i>curn</i> configuration
files at the local copies of the RSS feeds, instead of the remote ones.</p>

<p>For instance, suppose the following URLs (for a fictitious RSS
aggregator service) are commonly downloaded by people on your local
network:</p>

<blockquote><pre>
http://www.example.org/rss/nytimes_front_page.xml
http://www.example.org/rss/bbc_world_news.rdf
http://www.example.org/rss/big_jimmys_blog.xml
</pre>
</blockquote>

<p>You could run <i>curn</i> periodically with the following configuration
file, to download each of those feeds without producing any output.</p>

<table summary="" class="bordered uncolored" align="center">
  <tr valign="top">
    <td align="left">
<blockquote><pre>
[var]

# "feedDir" dumps to a directory that's accessible internally via URL
# http://hub.ourdivision.example.com/rssfeeds/

feedDir: /usr/local/apache/htdocs/rssfeeds

# curnDir: where this file and the cache live

curnDir: /usr/local/etc/curn

[curn]

CacheFile: ${var:curnDir}/common.cache
MaxThreads: 15
ParserClass: org.clapper.curn.parser.rome.RSSParserAdapter
GzipDownload: true

#####################################
# No output handlers are configured #
#####################################

[Feed_nytimes_front]

# New York Times front page. Accessible internally as:
# http://hub.ourdivision.example.com/rssfeeds/nytimes_front_page.xml

URL: http://www.example.org/rss/nytimes_front_page.xml
SaveAs: ${var:feedDir}/nytimes_front_page.xml


[Feed_bbc_news_world]

# BBC World News page. Accessible internally as:
# http://hub.ourdivision.example.com/rssfeeds/bbc_world_news.rdf

URL: http://www.example.org/rss/bbc_world_news.rdf
SaveAs: ${var:feedDir}/bbc_world_news.rdf


[Feed_big_jimmy]

# Big Jimmy's Blog. (Why is this blowhard so popular?)
# Accessible internally as:
# http://hub.ourdivision.example.com/rssfeeds/big_jimmys_blog.xml

URL: http://www.example.org/rss/big_jimmys_blog.xml
SaveAs: ${var:feedDir}/big_jimmys_blog.xml
</pre></blockquote>
    </td>
  </tr>
</table>

<p>Note that you could use <i>curn</i> in this manner even if your users
are not using <i>curn</i> to read their RSS feeds. You could still run your
periodic instance of <i>curn</i> to download the common feeds to a directory
that's part of an internal web site, and instruct your users to point whatever
RSS readers they're using to those internal web pages, instead of the external
ones.</p>

<!-- ********************************************************************** -->
<h1><a name="ExtendingCurn">Extending <i>curn</i></a></h1>

<p>This section is intended for Java programmers who want to extend
<i>curn</i>'s capabilities by writing additional output handlers, integrating
a different RSS parser, or even writing a new command-line or GUI front-end
to <i>curn</i>'s main logic.</p>

<p>Roughly speaking, <i>curn's</i> processing is divided into the following
phases:</p>

<ol>
  <li><b>startup</b>: Initialization

  <li><b>configuration</b>: Read the configuration file (which includes the
      set of RSS feeds, the output handlers to use, the RSS parser to use,
      various cache-control values, and other things), load the on-disk
      cache into memory, and initialize various data structures.

  <li><b>feed download</b>: Download the configured RSS feeds, assuming they
      have changed.

  <li><b>feed parsing</b>: Parse the downloaded RSS feeds, assuming (a) a
      <a href="#Cfg_ParserClass">parser class</a> and at least one
      <a href="#CfgOutputHandlers">output handler</a> have been configured.
      (If there's no parser, or no output handlers, then <i>curn</i> is
      running in download-only mode, and there's no need to waste time parsing
      the XML.)

  <li><b>output</b>: Pass the parsed feed data to the configured output
      handlers

  <li><b>shutdown</b>: Cleanup.

</ol>

<p>Since <i>curn</i> permits you to specify the parsing and output handler
classes in its configuration file, you can easily extend <i>curn's</i>
capabilities by writing your output handler or integrating a different
RSS parser. In addition, as of version 3.0, <i>curn</i> supports
general-purpose <a href="#Plug-ins">plug-ins</a> that can intercept
various phases of <i>curn</i> processing.</p>

<h2><a name="UnsupportedParser"></a>Using an Unsupported RSS Parser</h2>

<p>Suppose you've found (or written) an RSS parser that you prefer to use
instead of
<a href="https://rome.dev.java.net/">ROME</a> or
<a href="http://informa.sourceforge.net/">Informa</a>.
(Perhaps it's faster than one of those, or perhaps it
supports some new RSS syntax that neither ROME nor Informa support. Or,
perhaps you're just playing around.)
Integrating that parser with <i>curn</i> requires writing some adapter classes
that implement some interfaces and extend some classes provided with the
<i>curn</i> software. Those classes are:</p>

<table summary="" class="outlined striped" align="center" width="100%">

  <tbody>
  <tr valign="bottom" class="col-headers">
    <th align="left">Class</th>
    <th align="left">Abstract Class or Interface?</th>
    <th align="left">Description</th>
  </tr>

  <tr valign="top">
    <td align="left"><a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/parser/RSSParser.html" class="code">org.clapper.curn.parser.RSSParser</a></td>
    <td align="left">Interface</td>
    <td align="left">
      Defines a simplified view of an RSS parser. Classes implementing
      this interface must provide a default public constructor and
      a <a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/parser/RSSParser.html##parseRSSFeed(java.io.InputStream)" class="code">parseRSSFeed()</a> method
    </td>
  </tr>

  <tr valign="top">
    <td align="left"><a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/parser/RSSChannel.html" class="code">org.clapper.curn.parser.RSSChannel</a></td>
    <td align="left">Abstract class</td>
    <td align="left">
      Defines a simplified view of an RSS channel (a.k.a., a parsed
      feed). <span class="code">RSSParser.parseRSSFeed()</span>
      must return an object that extends the
      <span class="code">RSSChannel</span> class.
    </td>
  </tr>

  <tr valign="top">
    <td align="left"><a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/parser/RSSItem.html" class="code">org.clapper.curn.parser.RSSItem</a></td>
    <td align="left">Abstract class</td>
    <td align="left">
      Defines a simplified view of an RSS item (a.k.a., one of the items
      within a parsed feed). The <span class="code">RSSChannel</span>
      class's <span class="code">getItems()</span> method returns a
      collection of objects that extend the
      <span class="code">RSSItem</span> class.
    </td>
  </tr>
  </tbody>
</table>

<p>Typically, integrating a new parser means writing a set of
<a href="http://c2.com/cgi/wiki?AdapterPattern">adapter</a> classes that
implement the above interfaces or extend the above classes, and map the
necessary calls onto methods in the real underlying parser. For a sample
integration, see the classes in the <i>curn</i> source code package
<a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/parser/informa/package-summary.html" class="code">org.clapper.curn.parser.informa</a>. Those classes implement a simple adapter for the third-party
<a href="http://informa.sourceforge.net/">Informa</a> RSS parser.</p>

<p>Note: If you've written an adapter for an unsupported RSS parser engine,
you'll have to make your adapter classes and the RSS parser classes available
to <i>curn</i>. It's not sufficient to add the appropriate jar files to
your <span class="env_var">CLASSPATH</span> environment variable.
Please refer to the section entitled
<a href="#InstallingSupportSoftware" class="sectionRef">Installing Supporting Software</a> for details.</p>

<h2><a name="Plug-ins"></a>Plug-ins</h2>

<p>As of version 3.0, <i>curn</i> supports plug-ins. <i>curn</i> plug-ins
can intercept various phases of <i>curn</i> processing and can enhance or
modify <i>curn</i>'s behavior. This section discusses
<i>curn</i>'s plug-in support.</p>

<h3><a name="PlugInOverview"></a>Overview of Plug-In Support</h3>

<p>If invoked properly (e.g., via the <i>curn</i> shell script or the
<i>curn.bat</i> DOS script created by the <i>curn</i> installer), <i>curn</i>
will search for and load plug-ins before it begins doing its real work.
<i>curn</i> looks for plug-ins in the following directories:</p>

<ul>
  <li><span class="filename"><i>curn_home</i>/plugins</span>
  <li><span class="filename"><i>user_home</i>/curn/plugins</span>
  <li><span class="filename"><i>user_home</i>/.curn/plugins</span>
</ul>

<p><a name="PlugInSearch"></a><i>curn</i> searches all jar files, zip files,
and subdirectories in each of those directories, looking for any
non-abstract, public class that implements one or more of the <i>curn</i>
Java plug-in interfaces. <i>curn</i> then attempts to load and instantiate
each plug-in. Once a plug-in has been instantiated, its capabilities are
available. Most plug-ins are dormant; that is, they don't do anything
unless activated by a plug-in-specific configuration entry.</p>

<p>After <i>curn</i> loads all the plug-ins it can find, it sorts them
by "sort key" (a special field that each plug-in is required to provide),
case-blind comparison. All plug-ins within a given execution phase are,
therefore, invoked in alphabetical order by sort key. This bit of processing
trivia is useful if you need to ensure that one plug-in fires before another
plug-in.</p>

<h3><a name="StockPlugIns"></a>Stock Plug-ins</h3>

<p><i>curn</i> ships with a set of stock plug-ins.
Some of those plug-ins implement capabilities that were formerly in the
<i>curn</i> core code; others provide new functionality. These plug-ins
are automatically available (provided you don't delete the
<span class="filename">curn-plugins.jar</span> file that's shipped with
<i>curn</i>). The following table summarizes the stock plug-ins. All
stock plug-ins are in the
<span class="code">org.clapper.curn.plugins</span> package.</p>

<table summary="" class="outlined striped" width="90%" align="center">

  <tr valign="bottom" class="col-headers">
    <th align="left">Plug-in Name</th>
    <th align="left">Class name</th>
    <th align="left">Explanation</th>
    <th align="left">Plug-in Configuration Parameters</th>
  </tr>

  <tbody>
  <tr valign="top">
    <td align="left"><a name="PlugIn_AllowEmbeddedHTML"></a>Allow Embedded HTML</td>
    <td align="left" class="code">AllowEmbeddedHTMLPlugIn</td>
    <td align="left">Enables or disables embedded HTML in a feed's output.</td>
    <td align="left">
      <a href="#Feed_AllowEmbeddedHTML" class="code">AllowEmbeddedHTML</a>
    </td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="PlugIn_ArticleFilter"></a>Article Filter</td>
    <td align="left" class="code">ArticleFilterPlugIn</td>
    <td align="left">Filter items (articles) from a feed, based on regular
    expressions.</td>
    <td align="left"><a href="#Feed_ArticleFilter" class="code">ArticleFilter</a></td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="PlugIn_CommonXMLFixups"></a>Common XML Fixups</td>
    <td align="left" class="code">CommonXMLFixupsPlugIn</td>
    <td align="left">Fix some common syntax errors in downloaded XML. See
       the configuration parameters for details on these fixups.
    </td>
    <td align="left">
      <a href="#Feed_CommonXMLFixups" class="code">CommonXMLFixups</a>
    </td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="PlugIn_DisableFeed"></a>Disable Feed</td>
    <td align="left" class="code">DisableFeedPlugIn</td>
    <td align="left">Disable a feed, without having to comment it out or remove it from the configuration.</td>
    <td align="left"><a href="#Feed_Disabled" class="code">Disabled</a> (feed)</td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="PlugIn_DisableOutputHandler"></a>Disable Output Handler</td>
    <td align="left" class="code">DisableOutputHandlerPlugIn</td>
    <td align="left">Disable an output handler, without having to comment it out or remove it from the configuration.</td>
    <td align="left"><a href="#OutputHandler_Disabled" class="code">Disabled</a> (output handler)</td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="PlugIn_EditParsedFeedURL"></a>Edit Parsed Feed URL</td>
    <td align="left" class="code">ParsedFeedURLEditPlugIn</td>
    <td align="left">Edit the parsed feed data, changing the feed URL
    and/or the individual item (article) URLs.</td>
    <td align="left">
      <a href="#Feed_EditFeedURL" class="code">EditFeedURL</a><br/>
      <a href="#Feed_EditItemURL" class="code">EditItemURL</a><br/>
      <a href="#Feed_PruneURLs" class="code">PruneURLs</a></td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="PlugIn_EmailOutput"></a>Email Output</td>
    <td align="left" class="code"><a name="EmailOutputPlugIn"></a>EmailOutputPlugIn</td>
    <td align="left">Email any output created by the output handlers to
    one or more recipients.</td>
    <td align="left">
      <a href="#Cfg_SMTPHost" class="code">SMTPHost</a><br/>
      <a href="#MailOutputTo" class="code">MailOutputTo</a><br/>
      <a href="#Cfg_MailFrom" class="code">MailFrom</a><br/>
      <a href="#Cfg_MailSubject" class="code">MailSubject</a>
    </td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="PlugIn_EmptyArticleSummary"></a>Empty Article Summary</td>
    <td align="left" class="code">Empty Article Summary PlugIn</td>
    <td align="left">How to handle an empty summary in an article.</td>
    <td align="left">
      <a href="#Feed_ReplaceEmptySummaryWith" class="code">ReplaceEmptySummaryWith</a>
    </td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="PlugIn_FeedMaxSummarySize"></a>Feed Max Summary Size</td>
    <td align="left" class="code">FeedMaxSummarySizePlugIn</td>
    <td align="left">Truncate a feed's summary to a maximum number of characters.</td>
    <td align="left"><a href="#Feed_MaxSummarySize" class="code">MaxSummarySize</a>
</td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="PlugIn_FeedSummaryOnly"></a>Feed Summary Only</td>
    <td align="left" class="code">FeedSummaryOnlyPlugIn</td>
    <td align="left">Optionally strips the full content for a
      feed, leaving only the summary.</td>
    <td align="left"><a href="#Feed_SummaryOnly" class="code">SummaryOnly</a>
  </tr>

  <tr valign="top">
    <td align="left"><a name="PlugIn_GzipDownload"></a>Gzip Download</td>
    <td align="left" class="code">GzipDownloadPlugIn</td>
    <td align="left">Optionally requests that web sites gzip (compress)
    the XML content before sending it to <i>curn</i>, to save network
    bandwidth.</td>
    <td align="left"><a href="#Feed_GzipDownload" class="code">GzipDownload</a></td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="PlugIn_IgnoreOldArticles"></a>Ignore Old Articles</td>
    <td align="left" class="code">IgnoreOldArticlesPlugIn</td>
    <td align="left">Suppress articles in a feed that are older than a
    specified iterval.</td>
    <td align="left"><a href="#Feed_IgnoreArticlesOlderThan" class="code">IgnoreArticlesOlderThan</a></td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="PlugIn_IgnoreDuplicateArticles"></a>Ignore Duplicate Articles</td>
    <td align="left" class="code">IgnoreDuplicateArticlesPlugIn</td>
    <td align="left">Suppress duplicate articles in a feed, based on a
    comparison of the article titles.</td>
    <td align="left"><a href="#Feed_IgnoreDuplicateTitles" class="code">IgnoreDuplicateTitles</a></td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="PlugIn_OverrideFeedTitle"></a>Override Feed Title</td>
    <td align="left" class="code">TitleOverridePlugIn</td>
    <td align="left">Overrides the title of a feed.</td>
    <td align="left"><a href="#Feed_TitleOverride" class="code">TitleOverride</a></td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="PlugIn_RawFeedEdit"></a>Raw Feed Edit</td>
    <td align="left" class="code">RawFeedEditPlugIn</td>
    <td align="left">Apply regular expression edits to a feed's XML
    before it's parsed.</td>
    <td align="left"><a href="#Feed_PreparseEdit" class="code">PreparseEdit</a></td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="PlugIn_SaveAs"></a>Save As</td>
    <td align="left" class="code"><a name="RawFeedSaveAsPlugIn"></a>RawFeedSaveAsPlugIn</td>
    <td align="left">Save a feed's XML to a file.</td>
    <td align="left">
      <a href="#Feed_SaveAs" class="code">SaveAs</a><br/>
      <a href="#Feed_SaveAsEncoding" class="code">SaveAsEncoding</a><br/>
      <a href="#Feed_SaveOnly" class="code">SaveOnly</a><br/>
    </td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="PlugIn_SaveAsRSS"></a>Save As RSS</td>
    <td align="left" class="code"><a name="SaveAsRSSPlugIn"></a>SaveAsRSSPlugIn</td>
    <td align="left">Convert any new data in the feed to a specified RSS format, and save
    the result to a file.</td>
    <td align="left">
      <a href="#Feed_SaveAsRSS" class="code">SaveAsRSS</a><br/>
      <a href="#Feed_SaveRSSOnly" class="code">SaveRSSOnly</a><br/>
    </td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="PlugIn_ShowAuthors"></a>Show Authors</td>
    <td align="left" class="code">ShowAuthorsPlugIn</td>
    <td align="left">Enable or disable the display of the author(s) of
      a feed and a feed's articles.</td>
    <td align="left"><a href="#Feed_ShowAuthors" class="code">ShowAuthors</a>
    </td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="PlugIn_ShowDates"></a>Show Dates</td>
    <td align="left" class="code">ShowDatesPlugIn</td>
    <td align="left">Enable or disable the display of the dates for
      a feed and a feed's articles.</td>
    <td align="left"><a href="#Feed_ShowDates" class="code">ShowDates</a>
    </td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="PlugIn_SortArticles"></a>Sort Articles</td>
    <td align="left" class="code">SortArticlesPlugIn</td>
    <td align="left">Control how a feed article's are sorted.</td>
    <td align="left"><a href="#Feed_SortBy" class="code">SortBy</a>
    </td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="PlugIn_UserAgent"></a>User Agent</td>
    <td align="left" class="code">UserAgentPlugIn</td>
    <td align="left">Specify the HTTP user-agent to send when downloading
    a feed.</td>
    <td align="left"><a href="#Feed_UserAgent" class="code">UserAgent</a></td>
  </tr>

  <tr valign="top">
    <td align="left"><a name="PlugIn_ZipOutput"></a>Zip Output</td>
    <td align="left" class="code"><a name="ZipOutputPlugIn"></a>ZipOutputPlugIn</td>
    <td align="left">Zip any output created by the output handlers into a
    configured zip file.</td>
    <td align="left">
      <a href="#Cfg_ZipOutputTo" class="code">ZipOutputTo</a><br/>
    </td>
  </tr>

  </tbody>
</table>

<h3><a name="PlugInInstallation"></a>Installing Plug-ins</h3>

<p>Installing a custom plug-in (i.e., not one of <i>curn</i>'s
<a href="#StockPlugIns">stock plug-ins</a>) is simple: Copy the plug-in's
jar or zip file to one of the directories listed in the
<a href="#PlugInOverview" class="sectionRef">Overview of Plug-In Support</a> section.</p>

<h3><a name="PlugInWriting"></a>Writing <i>curn</i> Plug-ins</h3>

<h4><a name="PlugInAPI"></a><i>curn</i> Plug-in API</h4>

<p><i>curn</i> automatically invokes plug-ins at various phases of
its execution. A plug-in that is registered for a particular phase
will be called during that phase of processing. A given plug-in class
can be associated with multiple phases of execution. In fact, most
<i>are</i>, if only to permit them to intercept their plug-in-specific
configuration parameters.</p>

<p>Each plug-in phase is represented by its own Java interface, and
each interface has exactly one method. Each plug-in interface, in turn,
extends the <i>curn</i> parent
<a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/PlugIn.html" class="code">PlugIn</a> interface, which defines some
additional methods that all plug-ins must provide.</p>

<p>A plug-in that intercepts multiple <i>curn</i> processing phases must
implement the interfaces for each of the phases. Here are the plug-in
phases, with their associated interfaces and methods, in execution
order.</p>

<table summary="" class="outlined striped" width="90%" align="center">

  <tr valign="bottom" class="col-headers">
    <th align="left">Plug-in interface</th>
    <th align="left">Plug-in method</th>
    <th align="left">Description</th>
  </tr>

  <tbody>
  <tr valign="top">
    <td align="left"><a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/StartupPlugIn.html" class="code">StartupPlugIn</a></td>
    <td align="left"><span class="code">runStartupPlugIn()</span></td>
    <td>Called immediately after <i>curn</i> has started, but before it has
        loaded its configuration file or its cache. Intercepting this phase
        is useful if a plug-in needs to perform initialization.</td>
  </tr>

  <tr valign="top">
    <td align="left"><a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/MainConfigItemPlugIn.html" class="code">MainConfigItemPlugIn</a></td>
    <td align="left"><span class="code">runMainConfigItemPlugIn()</span></td>
    <td>Called immediately after <i>curn</i> has read and processed a
        configuration item in the main <span class="code">[curn]</span> configuration
        section. All configuration items are passed, one by one, to each
        loaded plug-in. If a plug-in class is not interested in a
        particular configuration item, its
        <span class="code">runMainConfigItemPlugIn()</span> method should simply return
        without doing anything. Note that some configuration items may
        simply be variable assignment; there's no real way to distinguish a
        variable assignment from a true configuration item.
        <br/><br/>
        A plug-in that wants to provide a configuration item in the main
        <span class="code">[curn]</span> configuration section must implement
        this interface.
    </td>

  </tr>

  <tr valign="top">
    <td align="left"><a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/FeedConfigItemPlugIn.html" class="code">FeedConfigItemPlugIn</a></td>
    <td align="left"><span class="code">runFeedConfigItemPlugIn()</span></td>
    <td>Called immediately after <i>curn</i> has read and processed a
        configuration item in a "Feed" configuration section. All
        configuration items are passed, one by one, to each loaded plug-in.
        If a plug-in class is not interested in a particular configuration
        item, its <span class="code">runFeedConfigItemPlugIn()</span> method should simply
        return without doing anything. Note that some configuration items
        may simply be variable assignment; there's no real way to
        distinguish a variable assignment from a true configuration
        item.
        <br/><br/>
        A plug-in that wants to provide a per-feed configuration item
        must implement this interface.
    </td>
  </tr>

  <tr valign="top">
    <td align="left"><a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/OutputHandlerConfigItemPlugIn.html" class="code">OutputHandlerConfigItemPlugIn</a></td>
    <td align="left"><span class="code">runOutputHandlerConfigItemPlugIn()</span></td>
    <td>Called immediately after <i>curn</i> has read and processed a
        configuration item in an "OutputHandler" configuration section. All
        configuration items are passed, one by one, to each loaded plug-in.
        If a plug-in class is not interested in a particular configuration
        item, its <span class="code">runOutputHandlerConfigItemPlugIn()</span> method should
        simply return without doing anything. Note that some configuration
        items may simply be variable assignment; there's no real way to
        distinguish a variable assignment from a true configuration
        item.
        <br/><br/>
        A plug-in that wants to provide a per-output handler configuration item
        must implement this interface.
    </td>
  </tr>

  <tr valign="top">
    <td align="left"><a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/UnknownSectionConfigItemPlugIn.html" class="code">UnknownSectionConfigItemPlugIn</a></td>
    <td align="left"><span class="code">runUnknownSectionConfigItemPlugIn()</span></td>
    <td>Called immediately after <i>curn</i> has read and processed a
        configuration item in an unknown configuration section. All
        configuration items are passed, one by one, to each loaded plug-in.
        If a plug-in class is not interested in a particular configuration
        item, its <span class="code">runUnknownSectionConfigItemPlugIn()</span> method should
        simply return without doing anything. Note that some configuration
        items may simply be variable assignment; there's no real way to
        distinguish a variable assignment from a true configuration
        item.
        <br/><br/>
        A plug-in that requires its own configuration file section
        must implement this interface.
    </td>
  </tr>

  <tr valign="top">
    <td align="left"><a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/PostConfigPlugIn.html" class="code">PostConfigPlugIn</a></td>
    <td align="left"><span class="code">runPostConfigPlugIn()</span></td>
    <td>Called after the entire configuration has been read and parsed, but
        before any feeds are processed. Intercepting this event is useful
        for plug-ins that want to adjust the configuration. For instance:
        <ul>
	  <li>The <i>curn</i> command-line wrapper intercepts this plug-in
	      phase so it can adjust the configuration to account for
	      command line options.
	  <li>The <a href="#RawFeedSaveAsPlugIn" class="code">RawFeedSaveAsPlugIn</a>
	      intercepts this plug-in phase so that it can validate
	      its configuration parameters against each other.
	</ul>
     </td>
  </tr>

  <tr valign="top">
    <td align="left"><a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/CacheLoadedPlugIn.html" class="code">CacheLoadedPlugIn</a></td>
    <td align="left"><span class="code">runCacheLoadedPlugIn()</span></td>
    <td>Called after the <i>curn</i> cache has been read (and after any
        expired entries have been purged), but before any feeds are processed.
      </td>
  </tr>

  <tr valign="top">
    <td align="left"><a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/PreFeedDownloadPlugIn.html" class="code">PreFeedDownloadPlugIn</a></td>
    <td align="left"><span class="code">runPreFeedDownloadPlugIn()</span></td>
    <td>Called just before a feed is downloaded. This method can return
        <span class="code">false</span> to signal <i>curn</i> that the feed should be
        skipped. The plug-in method can also set values on the
        <span class="code">URLConnection</span> used to download the plug-in, via
        <span class="code">URL.setRequestProperty()</span>. (Note that <i>all</i> URLs, even
        <span class="code">file:</span> URLs, are passed into this method. Setting a request
        property on the <span class="code">URLConnection</span> object for a <span class="code">file:</span>
        URL will have no effect&#8212;though it isn't specifically harmful.)

        <p>Possible uses for a pre-feed download plug-in include:</p>

        <ul>
          <li>filtering on feed URL to prevent downloading non-matching feeds
          <li>changing the default User-Agent value
          <li>setting a non-standard HTTP header field
        </ul>
      </td>
  </tr>

  <tr valign="top">
    <td align="left"><a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/PostFeedDownloadPlugIn.html" class="code">PostFeedDownloadPlugIn</a></td>
    <td align="left"><span class="code">runPostFeedDownloadPlugIn()</span></td>
    <td> Called immediately after a feed is downloaded. This method can
        return <span class="code">false</span> to signal <i>curn</i> that the feed should be
        skipped. For instance, a plug-in that filters on the unparsed XML
        feed content could use this method to weed out non-matching feeds
        before they are downloaded.
      </td>
  </tr>

  <tr valign="top">
    <td align="left"><a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/PostFeedParsePlugIn.html" class="code">PostFeedParsePlugIn</a></td>
    <td align="left"><span class="code">runPostFeedParsePlugIn()</span></td>
    <td>Called immediately after a feed is parsed, but before it is
        otherwise processed. A post-feed parse plug-in has access to the
        <i>parsed</i> RSS feed data, via an <a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/RSSChannel.html" class="code">RSSChannel</a> object. This
        method can return <span class="code">false</span> to signal <i>curn</i> that the
        feed should be skipped. For instance, a plug-in that filters on the
        parsed feed data could use this method to weed out non-matching
        feeds before they are downloaded. Similarly, a plug-in that edits
        the parsed data (removing or editing individual items, for
        instance) could use method to do so.</td>
  </tr>

  <tr valign="top">
    <td align="left"><a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/PreFeedOutputPlugIn.html" class="code">PreFeedOutputPlugIn</a></td>
    <td align="left"><span class="code">runPreFeedOutputPlugIn()</span></td>
    <td>Called immediately before a parsed feed is passed to an output
        handler. A pre-feed output plug-in cannot affect the feed's
        processing. (The time to stop the processing of a feed is in one of
        the other, preceding phases.) This method will be called multiple
        times for each feed if there are multiple output handlers.</td>
  </tr>

  <tr valign="top">
    <td align="left"><a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/PostFeedOutputPlugIn.html" class="code">PostFeedOutputPlugIn</a></td>
    <td align="left"><span class="code">runPostFeedOutputPlugIn()</span></td>
    <td>Called immediately after a parsed feed is passed to an output
        handler. A post-feed output plug-in cannot affect the feed's
        processing. (The time to stop the processing of a feed is in one of
        the other, preceding phases.) This method will be called multiple
        times for each feed if there are multiple output handlers.</td>
  </tr>

  <tr valign="top">
    <td align="left"><a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/PostOutputHandlerFlushPlugIn.html" class="code">PostOutputHandlerFlushPlugIn</a></td>
    <td align="left"><span class="code">runPostOutputHandlerFlushPlugIn()</span></td>
    <td>Called immediately after an output handler is flushed (i.e., after
        it has been called to process all feeds and its output has been
        written to a temporary file), but before that output is
        displayed, emailed, etc.
      </td>
  </tr>

  <tr valign="top">
    <td align="left"><a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/PostOutputPlugIn.html" class="code">PostOutputPlugIn</a></td>
    <td align="left"><span class="code">runPostOutputPlugIn()</span></td>
    <td>Called after <i>curn</i> has flush <i>all</i> output handlers. A
        post-output plug-in is a useful place to consolidate the output from
        all output handlers. For instance, such a plug-in might pack all the
        output into a zip file, or email it. (The
        <a href="#EmailOutputPlugIn" class="code">EmailOutputPlugIn</a>
        works exactly this way.)
      </td>
  </tr>

  <tr valign="top">
    <td align="left"><a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/PreCacheSavePlugIn.html" class="code">PreCacheSavePlugIn</a></td>
    <td align="left"><span class="code">runPreCacheSavePlugIn()</span></td>
    <td>Called right before the <i>curn</i> cache is to be saved. A plug-in
        might choose to edit the cache at this point.</td>
  </tr>

  <tr valign="top">
    <td align="left"><a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/ShutdownPlugIn.html" class="code">ShutdownPlugIn</a></td>
    <td align="left"><span class="code">runShutdownPlugIn()</span></td>
    <td> Called just before <i>curn</i> gets ready to exit. This method
         allows plug-ins to perform any clean-up they require.</td>
  </tr>
  </tbody>
</table>

<p>A plug-in class doesn't have to do anything special to register itself
with <i>curn</i>. Merely implementing the appropriate interfaces is sufficient,
as long as <i>curn</i> can <a href="#PlugInSearch">find the plug-in class</a>
at run-time.</p>

<h4><a name="ExamplePlugIn"></a>A Simple Example Plug-in</h4>

<p>Of course, there's nothing quite like an example to clarify things. So,
here's a simple plug-in that:</p>

<ul>
  <li>defines a <span class="code">ZipOutputTo</span> configuration
      parameter, in the <span class="code">[curn]</span> section, that
      specifies the path to a zip file
  <li>takes all output files written by the output handlers and zips
      them up into the specified zip file
</ul>

<p>It uses a convenience class,
<a href="http://www.clapper.org/software/java/util/javadocs/util/api/org/clapper/util/io/Zipper.html" class="code">org.clapper.util.io.Zipper</a>,
to simplify the chore of writing the zip file. Here's the source (with
comments stripped out). Note that this is a stripped-down version of the
actual <a href="#ZipOutputPlugIn" class="code">ZipOutputPlugIn</a>.</p>

<table summary="" class="bordered uncolored" align="center">
  <tr>
    <td>
<blockquote><pre>
import org.clapper.curn.Curn;
import org.clapper.curn.CurnConfig;
import org.clapper.curn.CurnException;
import org.clapper.curn.MainConfigItemPlugIn;
import org.clapper.curn.OutputHandler;
import org.clapper.curn.PostOutputPlugIn;

import org.clapper.util.config.ConfigurationException;
import org.clapper.util.logging.Logger;

import org.clapper.util.io.Zipper;
import org.clapper.util.text.TextUtil;

import java.io.File;
import java.io.IOException;

import java.util.ArrayList;
import java.util.Collection;

public class ZipOutputPlugIn
    implements MainConfigItemPlugIn,
               PostOutputPlugIn
{
    private static final String VAR_ZIP_FILE = "ZipOutputTo";

    private File zipFile = null;
    private static Logger log = new Logger (ZipOutputPlugIn.class);

    public ZipOutputPlugIn()
    {
    }

    public String getPlugInName()
    {
        return "Zip Output";
    }

    public String getPlugInSortKey()
    {
        return getPlugInName();
    }

    public void initPlugIn()
	throws CurnException
    {
    }

    public void runMainConfigItemPlugIn (String     sectionName,
                                         String     paramName,
                                         CurnConfig config)
	throws CurnException
    {
        try
        {
            if (paramName.equals (VAR_ZIP_FILE))
            {
                String zipFilePath = config.getConfigurationValue (sectionName,
                                                                   paramName);
                this.zipFile = new File (zipFilePath);
            }
        }

        catch (ConfigurationException ex)
        {
            throw new CurnException (ex);
        }
    }

    public void runPostOutputPlugIn (Collection&lt;OutputHandler&gt; outputHandlers)
	throws CurnException
    {
        if (zipFile != null)
        {
            log.debug ("Zipping output to \"" + zipFile.getPath() + "\"");
            zipOutput (outputHandlers);
        }
    }

    /*----------------------------------------------------------------------*\
                              Private Methods
    \*----------------------------------------------------------------------*/

    private void zipOutput (Collection&lt;OutputHandler&gt; outputHandlers)
        throws CurnException
    {
        try
        {
            boolean haveFiles = false;

            // First, figure out whether we have any output or not.

            for (OutputHandler handler : outputHandlers)
            {
                if (handler.hasGeneratedOutput())
                {
                    haveFiles = true;
                    break;
                }
            }

            if (! haveFiles)
            {
                // None of the handlers produced any output.

                log.error ("Warning: None of the output handlers "
                         + "produced any zippable output.");
            }

            else
            {
                // Create the zip file.

                Zipper zipper = new Zipper (zipFile, /* flatten */ true);

                for (OutputHandler handler : outputHandlers)
                {
                    File file = handler.getGeneratedOutput();
                    if (file != null)
                    {
                        log.debug ("Zipping \"" + file.getPath() + "\"");
                        zipper.put (file);
                    }
                }

                zipper.close();
            }
        }

        catch (IOException ex)
        {
            throw new CurnException (ex);
        }
    }
}

</pre></blockquote>
    </td>
  </tr>
</table>

<p>To activate this plug-in, simply ensure that
<a href="#PlugInSearch">it is available to <i>curn</i> at startup</a>, and
add this configuration directive to the <span class="code">[curn]</span>
section of the configuration file:</p>

<table summary="" class="bordered uncolored" align="center">
  <tr valign="top">
    <td align="left">
<blockquote><pre>
# Unix
ZipOutputTo: /tmp/curn.zip

# Windows
#ZipOutputTo: c:\\temp\\curn.zip
</pre></blockquote>
    </td>
  </tr>
</table>
<br clear="all"/>

<p>For more examples, please see the source code for the
<a href="#StockPlugIns">stock plug-ins</a> delivered with <i>curn</i>.</p>

<h4><a name="PlugInMetadata"></a>Persisting Data from a Plug-in</h4>

<p>Beginning with <i>curn</i> 3.1, plug-ins (and output handlers, for that matter)
can save runtime metadata to the
<i>curn</i> metadata store (formerly called the "cache") and restore that
data in a subsequent <i>curn</i> run. To be able to save and restore metadata,
a plug-in must:</p>

<ul>
  <li>implement the 
<a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/PersistentDataClient.html" class="code">org.clapper.curn.PersistentDataClient</a> interface or extend the <a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/AbstractPersistentDataClient.html" class="code">org.clapper.curn.AbstractPersistentDataClient</a> class
  <li>register itself as a persistent data handler by calling <a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/DataPersister.html" class="code">org.clapper.curn.DataPersister</a> class's <span class="code">addPersistentDataClient()</span> method, typically from the plug-in's
      <span class="code">initPlugIn()</span> method
</ul>

<p>Once the plug-in is registered as a persistent data client, <i>curn</i> will:</p>

<ul>
  <li>Ask the plug-in for its name/value pairs to be saved, just before
      <i>curn</i> exits
  <li>Present the plug-in with name/value pairs to be parsed, just after
      <i>curn</i> starts up and reads the metadata (cache) file.
</ul>

<p>The following code fragment shows how a plug-in might register itself.</p>

<blockquote><pre>
import org.clapper.curn.DataPersister;
import org.clapper.curn.DataPersisterFactory;
import org.clapper.curn.AbstractPersistentDataClient;

...

public class MyPlugIn implements AbstractPersistentDataClient, ...
{
    ...
    public void initPlugIn() throws CurnException
    {
        DataPersister dataPersister = DataPersisterFactory.getInstance();
        dataPersister.addPersistentDataClient(this);
    }
    ...
}
</pre>
</blockquote>

<a name="CustomizingOutput"></a><h2>Customizing <i>curn</i>'s Output</h2>

<a name="WriteFreeMarkerTemplate"></a><h3>Writing Your Own FreeMarker Template</h3>

<p>Because FreeMarker relies on external templates to create the final
document, and because <i>curn</i> makes it easy to use custom-crafted
templates, you easily create your own custom documents, or your own branded
HTML output, without having to write your own output handler. To create your
own <i>curn</i> FreeMarker template, you must understand two things:</p>

<ul>
  <li>How to create a FreeMarker template
  <li><i>curn</i>'s specific FreeMarker data model
</ul>

<p>A tutorial on FreeMarker is beyond the scope of this document. The remainder
of this section assumes you have some familiarity with FreeMarker. If you
don't know how FreeMarker works, please consult the on-line
<a href="http://freemarker.sourceforge.net/docs/index.html">FreeMarker documentation</a>
before reading this section.</p>

<p>A FreeMarker template relies on the presence of a tree of data, supplied by
the program. FreeMarker calls this data tree a "data model". The
<span class="code">FreeMarkerOutputHandler</span> creates a
<i>curn</i>-specific
FreeMarker data model for use within a template. The
<span class="code">FreeMarkerOutputHandler</span> is as much as data-mapper
as an output handler: It maps <i>curn</i>'s internal RSS data structures
into a FreeMarker data model, then invokes the FreeMarker template engine
to transform the template and data-model into a document.</p>

<p>The <i>curn</i> FreeMarker data model is described below. The data model
notation used here is similar to the notation used within the FreeMarker
documentation.</p>

<table summary="" class="bordered colored" align="center">
<tr>
<td>
<pre>
<b>Tree</b>                                         <b>Description</b>

(root)
 |
 +-- curn
 |    |
 |    +-- showToolInfo ....................... [boolean] whether or not
 |    |                                        to display curn information
 |    |                                        in the output
 |    |
 |    +-- version ............................ [String] version of curn
 |    |
 |    +-- buildID ............................ [String] curn's build ID
 |
 +-- totalItems .............................. [int] total items for all channels
 |
 +-- dateGenerated ........................... [Date] date generated
 |
 +-- extraText ............................... [String] extra text, from the config
 |
 +-- encoding ................................ [String] encoding, from the config
 |
 +-- tableOfContents ......................... hash of table-of-contents data
 |    |
 |    +-- needed ............................. [boolean] whether a table of contents is needed
 |    |
 |    +-- (channels) ......................... sequence of channel table of contents items
 |          |
 |          +-- channel ...................... table of contents entry for one channel
 |          |     |
 |          |     +-- title .................. [String] channel title
 |          |     |
 |          |     +-- totalItems ............. [int] total items in channel
 |          |     |
 |          |     +-- channelAnchor .......... [String] HTML anchor name for channel
 |          |
 |          +-- channel
 ...        ...
 |
 +-- (channels) .............................. sequence of channel (feed) data
 |      |
 |      +-- channel .......................... hash for a single channel (feed)
 |      |       |
 |      |       +-- index .................... [int] channel's index in list
 |      |       |
 |      |       +-- totalItems ............... [int] total items in channel
 |      |       |
 |      |       +-- title .................... [String] channel title
 |      |       |
 |      |       +-- description .............. [String] channel description, or "" if not available
 |      |       |
 |      |       +-- anchorName ............... [String] HTML anchor name for channel
 |      |       |
 |      |       +-- url ...................... [String] channel's URL (as published in the feed's XML)
 |      |       |
 |      |       +-- configuredURL ............ [String] channel/feed URL (as listed in the <i>curn</i> configuration file)
 |      |       |
 |      |       +-- id ....................... [String] channel's unique ID (which might just be the URL)
 |      |       |
 |      |       +-- date ..................... [Date] channel's last-modified date (might be missing)
 |      |       |
 |      |       +-- rssFormat ................ [String] RSS format of channel (Atom, RSS 0.92, etc.).
 |      |       |                              Empty if not to be shown.
 |      |       |
 |      |       +-- author .......             [String] the author or authors of the item, combined in a single string, or ""
 |      |       |
 |      |       +-- (authors) ................ sequence of (String) names of authors of the feed
 |      |       |
 |      |       +-- (items) .................. sequence of channel items
 |      |             |
 |      |             +-- item ............... entry for one item
 |      |             |     |
 |      |             |     +-- index ........ [int] item's index in channel
 |      |             |     |
 |      |             |     +-- title ........ [String] item's title
 |      |             |     |
 |      |             |     +-- url .......... [String] item's URL (as published in the feed's XML)
 |      |             |     |
 |      |             |     +-- date ......... [Date] the date (might be missing)
 |      |             |     |
 |      |             |     +-- author ....... [String] the author or authors of the item, combined in a single string, or ""
 |      |             |     |
 |      |             |     +-- authors ...... a sequence of individual (String) author names. Might be empty.
 |      |             |     |
 |      |             |     +-- description .. [String] description/summary
 |      |             |
 |      |             +-- item
 |      |             |
...    ...           ...
 |      |
 |      +-- channel
 |      |
...    ...
</pre>
</td>
</tr>
</table>

<p>The <span class="code">FreeMarkerOutputHandler</span> also places three
FreeMarker methods in the data model, as well:</p>

<table summary="" class="outlined striped cell-outlined" align="center" width="80%">
  <tr class="title">
    <th colspan="4">Methods in the Data Model</th>
  </tr>

  <tr valign="bottom" class="col-headers">
    <th align="left">Method Name</th>
    <th align="left">Explanation</th>
    <th align="left">Arguments</th>
    <th align="left">Examples</th>
  </tr>

  <tbody>

  <tr valign="top">
    <td align="left" class="code">wrapText</td>
    <td align="left">Wraps text at the end of the line, on word boundaries.
       Uses the <i>org.clapper.util</i> Java Utility Library's
       <a href="http://www.clapper.org/software/java/util/javadocs/util/api/org/clapper/util/io/WordWrapWriter.html" class="code">WordWrapWriter</a>
       class.
    </td>
    <td align="left">
      <ul class="nobullet">
	<li><span class="code">stringToWrap</span>: Required. Specifies the
	    string to wrap.
	<li><span class="code">indentation</span>: Optional. How many blanks
	    to indent the string from the left margin. Each wrapped line,
	    including the first, is indented by this much. Defaults to 0.
	<li><span class="code">lineLength</span>: Optional. The length of the
	    line. Defaults to 79.
      </ul>
    </td>
    <td class="code" nowrap>
      ${wrapText (item.title, 4)}<br/>
      ${wrapText (item.description, 4, 50)}
    </td>
  </tr>

  <tr valign="top">
    <td align="left" class="code">indentText</td>
    <td align="left">Indents the specified string.</td>
    <td align="left">
      <ul class="nobullet">
	<li><span class="code">string</span>: Required. Specifies the
	    string to indent.
	<li><span class="code">indentation</span>: Required. How many blanks
	    to indent the string from the left margin.
      </ul>
    </td>
    <td class="code" nowrap>
      ${indentText (item.url, 4)}<br/>
      ${indentText (channel.url, 8)}
    </td>
  </tr>

  <tr valign="top">
    <td align="left" class="code">stripHTML</td>
    <td align="left">Strips all HTML tags from the specified string. Especially
      useful for plain text templates.</td>
    <td align="left">
      <ul class="nobullet">
	<li><span class="code">string</span>: Required. Specifies the
	    string to strip.
      </ul>
    </td>
    <td class="code" nowrap>
      ${stripHTML (item.description)}
    </td>
  </tr>

  <tr valign="top">
    <td align="left" class="code">escapeHTML</td>
    <td align="left">Escape special HTML characters in the specified string. For instance,
     "&amp;" is converted to "&amp;amp;", "&lt;" is converted to "&amp;lt;", etc.</td>
    <td align="left">
      <ul class="nobullet">
	<li><span class="code">string</span>: Required. Specifies the
	    string to convert.
      </ul>
    </td>
    <td class="code" nowrap>
      ${escapeHTML (item.description)}
    </td>
  </tr>
  </tbody>
</table>

<p>Below is a sample template, which is largely identical to the
<a href="#builtin-templates">built-in text template</a>. This template
illustrates the use of the data model. You can a version of
the text template, as well as the HTML template and the simple summary
template, by following these links:</p>

<a name="builtin-templates"></a>
<ul>
  <li><a href="HTML.txt">HTML</a>
  <li><a href="Text.txt">Text</a>
  <li><a href="Summary.txt">Simple Summary</a>
</ul>

<table summary="" class="bordered" align="center">
  <tr>
    <th class="title">Sample FreeMarker template</th>
  </tr>
  <tr>
    <td>
<pre>
${title}
&lt;#if extraText != ""&gt;
${wrapText (extraText)}
&lt;/#if&gt;

&lt;#list channels as channel&gt;
---------------------------------------------------------------------------
${wrapText (channel.title, 0)}
${channel.url}
&lt;#if channel.date?exists&gt;
${channel.date?string("E, dd MMM, yyyy 'at' HH:mm:ss")}
&lt;/#if&gt;

&lt;#list channel.items as item&gt;
${wrapText (item.title, 4)}
${indentText (item.url, 4)}
&lt;#assign desc = stripHTML(item.description)&gt;
&lt;#if desc != ""&gt;

${wrapText (desc, 8)}
&lt;/#if&gt;

&lt;/#list&gt;
&lt;/#list&gt;

---------------------------------------------------------------------------
&lt;#if (curn.showToolInfo)&gt;
curn, ${curn.version}
Generated ${dateGenerated?string("EEEEEE, dd MMMM, yyyy 'at' HH:mm:ss zzz")}
&lt;/#if&gt;
</pre>
    </td>
  </tr>
</table>

<h3><a name="NewOutputHandler"></a>Writing Your Own Output Handler</h3>

<p>There are two ways to write your own output handler: You can write a
Java class that implements the output handler, or you can write a script
using a scripting language supported by the Apache Jakarta
<a href="http://jakarta.apache.org/bsf/">Bean Scripting Framework</a> (BSF).
Both approaches are discussed below.</p>

<p>But&#8212;before you write your own output handler, consider whether you
can accomplish the same ends by writing a
<a href="http://freemarker.sourceforge.net/docs/dgui_template.html">FreeMarker template</a>
and using the
<a href="#FreeMarkerOutputHandler" class="code">FreeMarkerOutputHandler</a>.
If you're planning to create a different output
file format (as opposed to writing an output handler to send data over
a network connection or to a database), then there's a good chance that
writing a FreeMarker template will be simpler and faster.</p>

<h4><a name="NewJavaOutputHandler"></a>Writing a Java Output Handler</h4>

<p>Writing a new output handler is reasonably straightforward:</p>

<ul>
  <li>First, write a Java class the implements the
      <a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/OutputHandler.html" class="code">org.clapper.curn.OutputHandler</a>
      interface.
  <li>Compile the class, place it in a jar file, and put the jar file 
      someplace where <i>curn</i> can find it. (See the section entitled
      <a href="#InstallingSupportSoftware" class="sectionRef">Installing Supporting Software</a> for details on where to place the jar file.)
  <li>Specify your new output handler in your <i>curn</i>
      <a href="#ConfigFile">configuration file</a>.
</ul>

<p>To illustrate the concept, let's look at an output handler that simply
writes each channel and its items as plain text. (As it turns out,
this example is a stripped down version of the existing
<a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/output/TextOutputHandler.html" class="code">org.clapper.curn.output.TextOutputHandler</a> class. The real source code has more
comments and documentation and also implements a common base class.)</p>

<p>First, let's look at the top of the class and the required
<span class="code">init()</span> method:</p>

<table summary="" class="bordered uncolored" align="center">
  <tr valign="top">
    <td align="left">
<blockquote><pre>
import org.clapper.curn.CurnConfig;
import org.clapper.curn.CurnException;
import org.clapper.curn.ConfigureOutputHandler;
import org.clapper.curn.OutputHandler;
import org.clapper.curn.FeedInfo;

import org.clapper.curn.parser.RSSChannel;
import org.clapper.curn.parser.RSSItem;

import org.clapper.util.io.WordWrapWriter;
import org.clapper.util.text.TextUtil;
import org.clapper.util.text.Unicode;
import org.clapper.util.misc.Logger;

import org.clapper.util.config.ConfigurationException;
import org.clapper.util.config.NoSuchSectionException;

import java.io.IOException;
import java.io.InputStream;
import java.io.FileInputStream;
import java.io.FileWriter;
import java.io.File;
import java.io.FileNotFoundException;

import java.util.Date;
import java.util.ArrayList;
import java.util.Collection;
import java.util.Iterator;

public class MyOutputHandler
{
    private static final String HORIZONTAL_RULE =
                      "---------------------------------------"
                    + "---------------------------------------";

    private WordWrapWriter  out         = null;
    private CurnConfig      config      = null;
    private String          message     = null;
    private Collection      channels    = new ArrayList();
    private int             totalItems  = 0;
    private File            outputFile  = null;
    private boolean         saveOnly    = false;

    private static Logger log = new Logger (MyOutputHandler.class);

    public MyOutputHandler()
    {
    }

    /**
     * Initializes the output handler for another set of RSS channels.
     *
     * @param config     the parsed <i>curn</i> configuration data
     * @param cfgHandler the ConfiguredOutputHandler wrapper object that
     *                   contains this object; the wrapper has some useful
     *                   metadata, such as the object's configuration section
     *                   name and extra variables.
     *
     * @throws ConfigurationException  configuration error
     * @throws CurnException           some other initialization error
     */
    public void init (CurnConfig              config,
                      ConfiguredOutputHandler cfgHandler)
        throws ConfigurationException,
               CurnException
    {
        String sectionName = cfgHandler.getSectionName();
        String saveAs      = null;

        this.config = config;

        try
        {
            if (sectionName != null)
            {
                saveAs = config.getOptionalStringValue (sectionName,
                                                        "SaveAs",
                                                        null);
                saveOnly = config.getOptionalBooleanValue (sectionName,
                                                           "SaveOnly",
                                                           false);
                message = config.getOptionalStringValue (sectionName,
                                                         "Message",
                                                         null);
                if (saveOnly &amp;&amp; (saveAs == null))
                {
                    throw new ConfigurationException (sectionName,
                                                      "SaveOnly can only be "
                                                    + "specified if SaveAs "
                                                    + "is defined.");
                }
            }
        }

        catch (NoSuchSectionException ex)
        {
            throw new ConfigurationException (ex);
        }

        if (saveAs != null)
            outputFile = new File (saveAs);

        else
        {
            try
            {
                outputFile = File.createTempFile ("curn", null);
                outputFile.deleteOnExit();
            }

            catch (IOException ex)
            {
                throw new CurnException ("Can't create temporary file.");
            }
        }

        try
        {
            log.debug ("Opening output file \"" + outputFile + "\"");
            out = new WordWrapWriter (new FileWriter (outputFile));
        }

        catch (IOException ex)
        {
            throw new CurnException ("Can't open file \""
                                   + outputFile.getPath()
                                   + "\" for output",
                                     ex);
        }

        channels.clear();
        totalItems = 0;
    }
</pre></blockquote>
    </td>
  </tr>
</table>

<p><i>curn</i> calls the <span class="code">init()</span> method right
after instantiating the output handler class. One of the
<span class="code">init()</span> method's primary responsibilities is to
handle any special handler-specific configuration variables. It does so by:</p>

<ol>
  <li>asking the <span class="code">ConfiguredOutputHandler</span> object
      for the section name that's associated with the output handler class
  <li>requesting the specific configuration variable values from that
      section
  <li>processing the results, if any
</ol>

<p>The <span class="code">init()</span> method also performs any other
initialization required by the output handler class.</p>

<p><b>Note</b>: The sample <span class="code">init()</span> method, above,
does a little more work than it needs to do. As it turns out, the
<i>curn</i> API provides a useful abstract base class called
<a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/FeedInfo.html" class="code">org.clapper.curn.output.FileHandler</a> that
implements the <span class="code">OutputHandler</span> interface.
<span class="code">FileOutputHandler</span> provides an
<span class="code">init()</span> method that:

<ul>
  <li>automatically handles the "SaveAs" and "SaveOnly" configuration
      parameters
  <li>handles creation of the output file, much the same way the sample
      <span class="code">init()</span> method, above, does
  <li>provides some useful protected methods for the subclass, such as
      <span class="code">getOutputFile()</span> (which returns the
      file to which the subclass should write its output).
</ul>

<p><span class="code">FileOutputHandler</span> requires that the subclass
provide:

<ul>
  <li>an <span class="code">initOutputHandler()</span> method, to handle
      subclass initialization. This method takes the same parameters as the
      <span class="code">init()</span> method.
  <li>the output methods (e.g., <span class="code">displayChannel()</span>),
      discussed below
</ul>

<p>With that in mind, let's simplify our original
<span class="code">init()</span> method and class definition.
Changes from the original, above, are marked in bold.</p>

<table summary="" class="bordered uncolored" align="center">
  <tr valign="top">
    <td align="left">
<blockquote><pre>
import org.clapper.curn.CurnConfig;
import org.clapper.curn.CurnException;
import org.clapper.curn.ConfigureOutputHandler;
import org.clapper.curn.OutputHandler;
import org.clapper.curn.FeedInfo;

<b>import org.clapper.curn.output.FileOutputHandler;</b>

import org.clapper.curn.parser.RSSChannel;
import org.clapper.curn.parser.RSSItem;

import org.clapper.util.io.WordWrapWriter;
import org.clapper.util.text.TextUtil;
import org.clapper.util.text.Unicode;
import org.clapper.util.misc.Logger;

import org.clapper.util.config.ConfigurationException;
import org.clapper.util.config.NoSuchSectionException;

import java.io.IOException;
import java.io.InputStream;
import java.io.FileInputStream;
import java.io.FileWriter;
import java.io.File;
import java.io.FileNotFoundException;

import java.util.Date;
import java.util.ArrayList;
import java.util.Collection;
import java.util.Iterator;

public class MyOutputHandler <b>extends FileOutputHandler</b>
{
    private static final String HORIZONTAL_RULE =
                      "---------------------------------------"
                    + "---------------------------------------";

    private WordWrapWriter  out         = null;
    private CurnConfig      config      = null;
    private String          message     = null;
    private Collection      channels    = new ArrayList();
    private int             totalItems  = 0;
    private File            outputFile  = null;
    private boolean         saveOnly    = false;

    private static Logger log = new Logger (MyOutputHandler.class);

    public MyOutputHandler()
    {
    }

<b>    /**
     * Perform any subclass-specific initialization. Subclasses must
     * override this method.
     *
     * @param config     the parsed <i>curn</i> configuration data
     * @param cfgHandler the ConfiguredOutputHandler wrapper
     *                   containing this object; the wrapper has some useful
     *                   metadata, such as the object's configuration section
     *                   name and extra variables.
     *
     * @throws ConfigurationException  configuration error
     * @throws CurnException           some other initialization error
     */
    public void initOutputHandler (CurnConfig              config,
                                   ConfiguredOutputHandler cfgHandler)
        throws ConfigurationException,
               CurnException</b>
    {
        String sectionName = cfgHandler.getSectionName();

        this.config = config;

        try
        {
<b>            if (sectionName != null)
            {
                // Only need to handle the "Message" parameter. The
                // FileOutputHandler parent class handles "SaveAs" and
                // "SaveOnly"

                message = config.getOptionalStringValue (sectionName,
                                                         "Message",
                                                         null);
            }</b>
        }

        catch (NoSuchSectionException ex)
        {
            throw new ConfigurationException (ex);
        }

        <b>outputFile = super.getOutputFile()</b>
        try
        {
            log.debug ("Opening output file \"" + outputFile + "\"");
            out = new WordWrapWriter (new FileWriter (outputFile));
        }

        catch (IOException ex)
        {
            throw new CurnException ("Can't open file \""
                                   + outputFile.getPath()
                                   + "\" for output",
                                     ex);
        }

        channels.clear();
        totalItems = 0;
    }
</pre></blockquote>
    </td>
  </tr>
</table>


<p>Next, let's look at the output-related methods. There are several
output-related methods that are required by the
<span class="code">OutputHandler</span> interface:</p>

<ul>
  <li><span class="code">displayChannel()</span>: Displays the output for
      a parsed channel. This method takes the parsed
      <span class="code">RSSChannel</span> object and a special
      <a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/FeedInfo.html" class="code">org.clapper.curn.FeedInfo</a>
      object that contains the configuration information about the feed
      (i.e., its URL, its title, etc.).
  <li><span class="code">flush()</span>: Flushes the output and closes the
      output files
  <li><span class="code">getContentType()</span> returns the MIME type
      associated with the generated output.
  <li><span class="code">hasGeneratedOutput()</span>: returns
      <span class="code">true</span> if the handler generated output that
      the user should see, <span class="code">false</span> otherwise.
      In this handler's case, <span class="code">hasGeneratedOutput()</span>
      is provided by the parent <span class="code">FileOutputHandler</span>
      class; it returns <span class="code">true</span> if the output file
      has a non-zero length <i>and</i> the <span class="code">SaveOnly</span>
      configuration parameter has not been set. (Recall that "SaveOnly"
      says that the generated output should only be saved, not displayed.)
  <li><span class="code">getGeneratedOutput()</span>: Returns an
      <span class="code">InputStream</span> for reading the generated output
      (if <span class="code">hasGeneratedOutput()</span> returns
      <span class="code">true</span>) or null otherwise. Again, we don't
      have to implement that method in our sample output handler, because the
      parent <span class="code">FileOutputHandler</span> provides it for us.
</ul>

<p>Here's the code for the methods our sample class must implement:</p>

<table summary="" class="bordered uncolored" align="center">
  <tr valign="top">
    <td align="left">
<blockquote><pre>
    public void displayChannel (RSSChannel  channel,
                                FeedInfo    feedInfo)
        throws CurnException
    {
        Collection items = channel.getItems();

        indentLevel = setIndent (0);

        if ((items.size() != 0) || (! config.beQuiet()))
        {
            // Emit a site (channel) header.

            out.println();
            out.println (HORIZONTAL_RULE);

            out.println (convert (channel.getTitle()));
            out.println (channel.getLink().toString());

            Date date = channel.getPublicationDate();
            if (date != null)
                out.println (date.toString());

            if (config.showRSSVersion())
                out.println ("(Format: " + channel.getRSSFormat() + ")");
        }

        if (items.size() != 0)
        {
            // Now, process each item.

            String s;

            for (Iterator it = items.iterator(); it.hasNext(); )
            {
                RSSItem item = (RSSItem) it.next();

                setIndent (++indentLevel);

                out.println ();

                s = item.getTitle();
                out.println ((s == null) ? "(No Title)" : convert (s));

                s = item.getAuthor();
                if (s != null)
                    out.println ("By " + convert (s));

                out.println (item.getLink().toString());

                Date date = item.getPublicationDate();
                if (date != null)
                    out.println (date.toString());

                s = item.getSummary();
                if (TextUtil.stringIsEmpty (s))
                {
                    // Hack for feeds that have no summary but have
                    // content. If the content is small enough, use it
                    // as the summary.

                    s = item.getFirstContentOfType (new String[]
                                                    {
                                                        "text/plain",
                                                        "text/html"
                                                    });
                    if (! TextUtil.stringIsEmpty (s))
                    {
                        s = s.trim();
                        if (s.length() > CONTENT_AS_SUMMARY_MAXSIZE)
                            s = null;
                    }

                    else
                    {
                        s = s.trim();
                    }

                    if (s != null)
                    {
                        out.println();
                        setIndent (++indentLevel);
                        out.println (convert (s));
                        setIndent (--indentLevel);
                    }
                }

                setIndent (--indentLevel);
            }
        }

        else
        {
            if (! config.beQuiet())
            {
                setIndent (++indentLevel);
                out.println ();
                out.println ("No new items");
                setIndent (--indentLevel);
            }
        }

        setIndent (0);
    }

    private int setIndent (int level)
    {
        StringBuffer buf = new StringBuffer();

        for (int i = 0; i < level; i++)
            buf.append ("    ");

        out.setPrefix (buf.toString());

        return level;
    }

    public void flush() throws CurnException
    {
        out.println ();
        out.println (HORIZONTAL_RULE);
        out.println ("curn, version " + Version.VERSION);
        out.println ("Generated " + new Date().toString());
        out.flush();
        out = null;
    }

    public String getContentType()
    {
        return "text/plain";
    }
</pre></blockquote>
    </td>
  </tr>
</table>

<p>This particular output handler's
<span class="code">displayChannel()</span> method summarizes the channel
and item data, writing it to the output file that the
<span class="code">init()</span> method opened. The
<span class="code">flush()</span> method simply finishes the display.</p>

<p>With this model, it's possible to create output handlers that produce
all kinds of output, including (for instance):</p>

<ul>
  <li>HTML
  <li>XML (e.g., for converting all incoming RSS feeds to one type of RSS feed)
  <li>data sent over a network connection
  <li>etc.
</ul>

<h4><a name="NewScriptOutputHandler"></a>Writing a Script Output Handler</h4>

<p>Writing a script output handler is even simpler, in a way, than writing
a Java output handler. You simply write a script in a supported language,
then configure an instance of the
<a href="#CfgScriptOutputHandler" class="code">ScriptOutputHandler</a> class
to point to your script.</p>

<h5><a name="SupportedScriptingLanguages"></a>Supported Scripting Languages</h5>

<p>The
<a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/output/script/ScriptOutputHandler.html" class="code">ScriptOutputHandler</a>
uses the Apache Jakarta
<a href="http://jakarta.apache.org/bsf/">Bean Scripting Framework (BSF)</a> or
the JSR 223 scripting engine 
to call scripts. It currently supports any scripting language that has a binding
to either scripting infrastructure. See
the <a href="#CfgScriptOutputHandler">configuration
section for the <span class="code">ScriptOutputHandler</span> class</a>
for the list of sample languages.</p>

<p class="alert" align="center">Note: <i>curn</i> comes bundled with a compatible version of the
BSF <span class="filename">bsf.jar</span> file. If you're running Java 6, and
you want JSR 223 support for languages other than Javascript, please see
<a href="https://scripting.dev.java.net/" class="url">https://scripting.dev.java.net/</a>.</p>

<h5><a name="WritingScript"></a>Writing the Script</h5>

<p>The <span class="code">ScriptOutputHandler</span> class's

<a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/output/script/ScriptOutputHandler.html#displayChannel(org.clapper.curn.parser.RSSChannel,%20org.clapper.curn.FeedInfo)" class="code">displayChannel()</a>
method doesn't actually generated any output. Instead, it buffers the
channels so that the
<a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/output/script/ScriptOutputHandler.html#flush()" class="code">flush()</a>
method can invoke the script. That way, the overhead of invoking the
script occurs only once.</p>

<p>The <span class="code">ScriptOutputHandler</span> object exposes a
special <span class="code">curn</span> object to the invoked script; that
object contains the following fields and methods, all of which are
available to the script. The <span class="code">curn</span> object is
exposed via <span class="code">BSFManager.declareBean()</span>, which
means it is a global variable that is automatically accessible to the
script, without the need for the script to call any methods to find it.</p>

<table summary="" border="outlined striped" align="center" width="90%">
  <tr valign="top" class="col-headers">
    <th align="left"><span class="code">curn</span> field or method name</th>
    <th align="left">Corresponding "registered" BSF bean (for backward compatibility)</th>
    <th align="left">Java type</th>
    <th align="left">Explanation</th>
  </tr>

  <tr valign="top">
    <td class="code">curn.channels</td>
    <td class="code">channels</td>
    <td class="code">java.util.Collection</td>
    <td>An <span class="code">Collection</span> of special internal
        objects that wrap both
        <a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/parser/RSSChannel.html" class="code">RSSChannel</a>
        and
        <a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/FeedInfo.html" class="code">FeedInfo</a>
        objects. The wrapper objects provide two methods:

        <ul>
          <li><span class="code">getChannel()</span>
              gets the <span class="code">RSSChannel</span> object
          <li><span class="code">getFeedInfo()</span>
              gets the <span class="code">FeedInfo</span> object.
              This object contains useful metadata about the channel.
        </ul>
      </td>
  </tr>

  <tr valign="top">
    <td class="code">curn.outputPath</td>
    <td class="code">outputPath</td>
    <td class="code">java.lang.String</td>
    <td>The path to the output file. The script should write its
        output to that file. Overwriting the file is fine. If the
        script generates no output, then it can ignore the file.</td>
  </tr>

  <tr valign="top">
    <td class="code">curn.config</td>
    <td class="code">config</td>
    <td><a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/CurnConfig.html" class="code">CurnConfig</a></td>
    <td>The <span class="code">org.clapper.curn.CurnConfig</span> object
        that represents the parsed configuration data. Useful in
        conjunction with the "configSection" object, to parse
        additional parameters from the configuration.</td>
  </tr>

  <tr valign="top">
    <td class="code">curn.configSection</td>
    <td class="code">configSection</td>
    <td class="code">java.lang.String</td>
    <td>The name of the configuration file section in which the output
        handler was defined. Useful if the script wants to access
        additional script-specific configuration data.</td>
  </tr>

  <tr valign="top">
    <td class="code">curn.setMIMEType()</td>
    <td>&nbsp;</td>
    <td>&nbsp;</td>
    <td>The script should call this method and pass it the MIME type that
        corresponds to the generated output. If the script generates no
        output, then it can ignore this method.</td>

  </tr>

  <tr valign="top">
    <td>&nbsp;</td>
    <td class="code">mimeType</td>
    <td class="code">java.lang.PrintWriter</td>
    <td>A <span class="code">PrintWriter</span> object to which the
        script should print the MIME type that corresponds to the
        generated output. If the script generates no output, then it can
        ignore this object.</td>
  </tr>

  <tr valign="top">
    <td class="code">curn.logger</td>
    <td class="code">logger</td>
    <td class="code">org.clapper.util.misc.Logger</td>
    <td>A <span class="code">Logger</span> object, useful for logging
        messages to the <i>curn</i> log file.</td>
  </tr>

  <tr valign="top">
    <td>&nbsp;</td>
    <td class="code">version</td>
    <td class="code">java.lang.String</td>
    <td>Full <i>curn</i> version string, in case the script wants to
        include it in the generated output</td>
  </tr>

  <tr valign="top">
    <td class="code">curn.getVersion()</td>
    <td>&nbsp;</td>
    <td class="code">java.lang.String</td>
    <td>Method that returns the full <i>curn</i> version string, in case
        the script wants to include it in the generated output</td>
  </tr>
</table>

<p>Here's a sample <a href="http://www.jython.org/">Jython</a> script
that shows how to put it all together. This script reimplements most of the
functionality of the
<a href="http://www.clapper.org/software/java/curn/javadocs/curn/api/org/clapper/curn/output/TextOutputHandler.html" class="code">org.clapper.curn.output.TextOutputHandler</a>
Java class that comes with <i>curn</i>. (Note that the script uses a
<span class="code">org.clapper.util.io.WordWrapWriter</span> object for
its output. While the word-wrapping functionality could have been implemented
directly in Jython, this strategy both saves time and demonstrates how easily
you can use existing Java classes from a Jython script.)</p>

<p>Class documentation, copyrights, etc., have been stripped from the
script for brevity. You can find the complete script, along with a
<a href="http://jruby.sourceforge.net/">JRuby</a> implementation
of the same functionality, in the <i>curn</i> source bundle, in directory
<span class="filename">src/org/clapper/curn/output/script</span>.</p>

<table summary="" class="bordered uncolored" align="center">
  <tr>
    <td>
<blockquote><pre>
import sys
from org.clapper.curn import CurnException
from org.clapper.util.io import WordWrapWriter

HORIZONTAL_RULE = "---------------------------------------" \
                + "---------------------------------------"


def process_channels():
    """
    Process the channels passed in through the Bean Scripting Framework.
    """

    # If we didn't care about wrapping the output, we'd just use:
    #
    #     out = open (self.outputPath, "w")
    #
    # But it'd be nice to wrap long summaries on word boundaries at
    # the end of an 80-character line. For that reason, we use the
    # Java org.clapper.util.io.WordWrapWriter class.

    out = WordWrapWriter (open (curn.outputPath, "w"))
    out.setPrefix ("")

    msg = curn.config.getOptionalStringValue (curn.configSection,
                                              "Message",
                                              None)

    totalNew = 0

    # First, count the total number of new items

    for channel_wrapper in curn.channels:
        channel = channel_wrapper.getChannel()
        totalNew = totalNew + channel.getItems().size()

    if totalNew > 0:
        # If the config file specifies a message for this handler,
        # display it.

        if msg != None:
            out.println (msg)
            out.println ()

        # Now, process the items

        indentation = 0
        for channel_wrapper in curn.channels:
            channel = channel_wrapper.getChannel()
            channel = channel_wrapper.getChannel()
            feed_info = channel_wrapper.getFeedInfo()
            process_channel (out, channel, feed_info, indentation)

        curn.setMIMEType ("text/plain")

        # Output a footer

        indent (out, indentation)
        out.println ()
        out.println (HORIZONTAL_RULE)
        out.println (curn.getVersion())
        out.flush()

def process_channel (out, channel, feed_info, indentation):
    """
    Process all items within a channel.
    """
    curn.logger.debug ("Processing channel \"" + str (channel.getTitle()) + "\"")

    # Print a channel header

    indent (out, indentation)
    out.println (HORIZONTAL_RULE)
    out.println (channel.getTitle())
    out.println (channel.getLinks()[0].toString())
    out.println (str (channel.getItems().size()) + " item(s)")

    date = channel.getPublicationDate()
    if date != None:
        out.println (str (date))

    if curn.config.showRSSVersion():
        out.println ("(Format: " + channel.getRSSFormat() + ")")

    indentation = indentation + 1
    indent (out, indentation)
    for item in channel.getItems():

        # These are RSSItem objects

        out.println()
        out.println (item.getTitle())
        out.println (str (item.getLinks()[0]))

        date = item.getPublicationDate();
        if date != None:
            out.println (str (date))

        out.println()

        summary = item.getSummary()
        if summary != None:
            indent (out, indentation + 1)
            out.println (summary)
            indent (out, indentation)

def indent (out, indentation):
    """
    Apply a level of indentation to a WordWrapWriter, by changing
    the WordWrapWriter's prefix string.

    out         - the org.clapper.util.io.WordWrapWriter
    indentation - the numeric indentation level
    """

    prefix = ""
    for i in range (indentation):
        prefix = prefix + "    "

    out.setPrefix (prefix)

# ---------------------------------------------------------------------------

process_channels()
</pre></blockquote>
    </td>
  </tr>
</table>

<h5><a name="ConfigScriptOutputHandler"></a>Configuring the Script Output Handler</h5>

<p>The <a href="#CfgScriptOutputHandler">configuration section for the
<span class="code">ScriptOutputHandler</span> class</a> provides a detailed
description of the configuration parameters. Here is a sample configuration
entry for our <span class="code">TextOutputHandler.py</span> Jython script.</p>

<table summary="" class="bordered uncolored" align="center">
  <tr>
    <td>
<blockquote><pre>
[OutputHandlerJythonScript]

Class: org.clapper.curn.output.script.ScriptOutputHandler
#SaveAs: ${system:user.home}/curn/rss-py.txt
#SaveOnly: true
Language: jython
Script: ${system:user.home}/curn/TextOutputHandler.py
Message: Copy saved in file ${system:user.home}/curn/rss-py.txt
</pre></blockquote>
    </td>
  </tr>
</table>

<h2><a name="InstallingSupportSoftware"></a>Installing Supporting Software</h2>

<p>As noted in the <a href="#PlugInOverview" class="sectionRef">Overview of Plug-In Support</a>
section, <i>curn</i> searches for plug-ins in the following directories:</p>

<ul>
  <li><span class="filename"><i>curn_home</i>/plugins</span>
  <li><span class="filename"><i>user_home</i>/curn/plugins</span>
  <li><span class="filename"><i>user_home</i>/.curn/plugins</span>
</ul>

<p><i>curn</i> implicitly adds those directories to the internal class path
used by the <i>curn</i> custom <a href="#ClassLoader">class loader</a>.
<i>curn</i> also loads the following directories into its class loader:</p>

<ul>
  <li><span class="filename"><i>curn_home</i>/lib</span>
  <li><span class="filename"><i>user_home</i>/curn/lib</span>
  <li><span class="filename"><i>user_home</i>/.curn/lib</span>
</ul>

<p>If you've written or installed a plug-in, output handler or RSS parser
adapter that requires some third-party support software (e.g., a
third-party RSS parser engine), or if you want to enable logging using a
non-bundled logging framework such as
<a href="#Log4J" class="sectionRef">Log4J</a>), you'll have to install the
appropriate support jars somewhere where <i>curn</i> can find them. If you
install the jars in the <span class="filename">lib</span> directory
underneath the <i>curn</i> installation directory, then they'll be available
to any user who runs that <i>curn</i> installation. However, if you don't
have permission to update that directory, or you only want to make your
extensions available to you, then you can install your software in the
appropriate <span class="filename">lib</span> directory under your home
directory.</p>

<div class="alert">

As of version 3.0, non-bundled plug-ins <i>must</i> be placed in one of the
sanctioned <span class="filename">plug-in</span> directories and
non-bundled third-party software <i>must</i> be placed in one of the
sanctioned <span class="filename">lib</span> directories. You
<i>cannot</i> simply add the appropriate jars to your
<span class="env_var">CLASSPATH</span> environment variable.
To support plug-ins
properly, <i>curn</i>'s plug-in architecture uses a different Java
<a href="http://java.sun.com/j2se/1.5.0/docs/api/java/lang/ClassLoader.html">class loader</a>
that does not honor the <span class="env_var">CLASSPATH</span> setting.
</div>

<!-- ********************************************************************** -->

<h1><a name="Troubleshooting"></a>Troubleshooting</h1>

<p>In the event of problems, your first step should be to enable logging.
The next section discusses <i>curn</i>'s logging infrastructure.</p>

<h2><a name="Logging"></a>Logging</h2>

<p><i>curn</i> issues log messages via the
<a href="http://jakarta.apache.org/commons/logging/index.html">Jakarta Commons Logging API</a> (JCL),
so it'll log to any JCL-compatible logging framework. The two most popular
frameworks are
<a href="http://logging.apache.org/">Log4J</a> and the
<span class="code">java.util.logging</span> framework that comes with
the Java JDK or J2SE runtime.</p>

<p><i>curn</i>'s
graphical installer automatically installs the JCL jars, but it does not
install Log4J (or any other third-party logging framework); so, by default,
<i>curn</i> will log via the <span class="code">java.util.logging</span>
API.</p>

<p>When initialized at runtime, some underlying logging frameworks will
automatically begin logging if they find an appropriate configuration file
in some default location. To prevent this behavior, <i>curn</i> does not
initialize the JCL layer unless the
<a href="#opt-logging" class="code">--logging</a> command-line parameter is
specified. If <span class="code">--logging</span> is not specified, <i>curn</i>
will not issue log messages even if default logging configuration files are
present.</p>

<p>All <i>curn</i> Java classes are in packages within the
<span class="code">org.clapper.curn</span> namespace.</p>

<p>Each logging framework has its own initialization files; the following
two sections show how you might enable logging for the two more popular
logging frameworks, <span class="code">java.util.logging</span> and Log4J.</p>

<h3><a name="java.util.logging"></a>java.util.logging</h3>

<div class="alert">

<p>Note: Please be aware that, as of <i>curn</i> 3.0, there are some subtle
"issues" with JDK logging. If you happened to be using the
<a href="http://www.clapper.org/software/java/util/javadocs/util/api/org/clapper/util/logging/JavaUtilLoggingTextFormatter.html" class="code">org.clapper.util.logging.JavaUtilLoggingTextFormatter</a>
class to format your output, you're out of luck.
In general, 
you're far better off using <a href="#Log4J">Log4J</a>. The gory details,
for those who care about such things, follow.</p>

<p><i>curn</i> now uses a special  
<a href="#PleaseUseTheScript">bootstrap mechanism</a> to enable the use
of plug-ins. As part of this bootstrap logic, <i>curn</i> installs its own
class loader. However, the built-in JDK logging API doesn't play well in
that environment. It always uses the system class loader&#8212;the
<span class="env_var">CLASSPATH</span>-driven class loader&#8212;to find its classes. Normally, this isn't
too much of a problem, but <i>curn</i> doesn't rely on <span class="env_var">CLASSPATH</span> to find
its code; instead, it uses its own class loader. Among the jar files
<i>curn</i>'s class loader searches is the <i>org.clapper.util</i> utility
library, the very library that contains the 
<span class="code">JavaUtilLoggingTextFormatter</span> class. If you try
to ensure that the <i>org.clapper.util</i> utility library is in the <span class="env_var">CLASSPATH</span>
(and, therefore, available to the JDK logging API), you run the risk of causing
problems with <i>curn</i>'s runtime environment.</p>

<p>Further, any third-party formatters you are using (such as the
<a href="#smtphandler" class="code">SMTPHandler</a> formatter), you have to
ensure that the jar files containing those formatters are listed in the
classpath. To do that, you'll have to modify the
<a href="#curn-script">shell script or Windows command file</a> used to
invoke <i>curn</i>.</p>

<p>If you're not using the
<span class="code">JavaUtilLoggingTextFormatter</span> class
in the <i>org.clapper.util</i> library, and you're not using any
third-party formatters, then this warning probably
doesn't apply to you.</p>
</div>

<p>This section assumes that you're using a properties file to configure
the logging framework; if you're using a custom logging configuration class,
you'll have to work out the configuration details yourself.</p>

<p>When you use the <span class="code">java.util.logging</span> framework
with <i>curn</i>, you
must specify the location of the logging configuration file with
system property <span class="code">java.util.logging.config.file</span>.
file. According to the Javadoc for the
<a href="http://java.sun.com/j2se/1.5.0/docs//api/java/util/logging/LogManager.html" class="code">LogManager</a> class, the property may be set via
the Preferences API or as a command-line property definition passed to the
<span class="code">java</span> command.

<p>To invoke <i>curn</i> on a Unix-like system, so that it
logs through the <span  class="code">java.util.logging</span> framework, you
might use a command line like this:</p>

<blockquote>
<pre>java -Djava.util.logging.config.file=/home/bmc/curn/logging.properties org.clapper.curn.Tool --logging /home/bmc/curn/curn.cfg</pre>
</blockquote>

<p>The <a href="#curn-script" class="code">curn</a> shell script installed
by the graphical installer understands <span class="code">-D</span> parameters;
if you use the shell script, you can shorten the above command to:</p>

<blockquote>
<pre>curn -Djava.util.logging.config.file=/home/bmc/curn/logging.properties --logging /home/bmc/curn/curn.cfg</pre>
</blockquote>

<p>Alternatively, you can set those values in the
<span class="env_var">CURN_JAVA_VM_ARGS</span> environment variable, and
<i>curn</i> will automatically supply them to the Java virtual machine.
For example:</p>

<blockquote>
<pre>export CURN_JAVA_VM_ARGS="-Djava.util.logging.config.file=/home/bmc/curn/logging.properties"
curn --logging /home/bmc/.curn/curn.cfg</pre>
</blockquote>

<p>The Windows <a href="#curn-script" class="code">curn.bat</a> command file
currently does not understand <span class="code">-D</span> parameters, so you
must use the
<span class="env_var">CURN_JAVA_VM_ARGS</span> environment variable method.
For instance:

<blockquote>
<pre>set CURN_JAVA_VM_ARGS=-Djava.util.logging.config.file=/home/bmc/curn/logging.properties
curn --logging %HOME%\.curn\curn.cfg</pre>
</blockquote>

<p>Here's a configuration file that writes logs all messages at the
"info" level or lower, to a file. (Change "INFO" to "FINEST" to get messages
at the debug level.)</p>

<table class="outlined" align="center" summary="">
  <tr><td><pre>
handlers=java.util.logging.FileHandler
.level=FINEST

# %h is replaced with the user's home directory
java.util.logging.FileHandler.pattern = %h/curn/log.out
java.util.logging.FileHandler.level=FINEST
java.util.logging.FileHandler.count = 1
java.util.logging.FileHandler.formatter = java.util.logging.SimpleFormatter

org.clapper.curn.level=INFO</pre>
  </td></tr>
</table>

<a name="smtphandler"></a>
<p>If you want to have exceptions mailed to you (which can be useful when
running <i>curn</i> from a scheduler, such as <i>cron</i>(8)), then download
and install the <a href="http://smtphandler.sourceforge.net/">SMTPHandler</a> class from
<a href="http://smtphandler.sourceforge.net/" class="url">smtphandler.sourceforge.net</a>, and use this configuration file, instead:</p>

<table class="outlined" align="center" summary="">
  <tr><td><pre>
handlers=java.util.logging.FileHandler
.level=FINEST

# %h is replaced with the user's home directory
java.util.logging.FileHandler.pattern = %h/curn/log.out
java.util.logging.FileHandler.level=FINEST
java.util.logging.FileHandler.count = 1
java.util.logging.FileHandler.formatter = java.util.logging.SimpleFormatter

smtphandler.SMTPHandler.level=WARNING
smtphandler.SMTPHandler.smtpHost=<b>your_smtp_host_here</b>
smtphandler.SMTPHandler.to=<b>your_email_address_here</b>
smtphandler.SMTPHandler.from=<b>your_email_address_here</b>
smtphandler.SMTPHandler.subject=[SMTPHandler] curn error
smtphandler.SMTPHandler.bufferSize=4096
smtphandler.SMTPHandler.formatter=smtphandler.SMTPHandler

org.clapper.curn.level=INFO</pre>
  </td></tr>
</table>

<p>Note that both files use the
<span class="code">org.clapper.util.misc.JDK14TextLogFormatter</span>
formatter class, instead of the JDK-supplied
<span class="code">java.util.logging.SimpleFormatter</span>. I don't care
for the text format that <span class="code">SimpleFormatter</span> produces,
so I use a formatter in from utility library that produces output that's
similar to the default Log4J text formatter.</p>

<p>Obviously, you can use any formatter you wish, including the
<span class="code">java.util.logging.XMLFormatter</span> class.</p>

<h3><a name="Log4J"></a>Log4J</h3>

<p>Before you can use the Log4J framework with <i>curn</i>, you must install
the  <span class="filename">log4j.jar</span> file so that <i>curn</i> can find
it. (You can download that file from
<a href="http://logging.apache.org/log4j/" class="url">http://logging.apache.org/log4j/</a>.) See the section entitled
<a href="#InstallingSupportSoftware" class="sectionRef">Installing Support Software</a>
for details on where to install <span class="filename">log4j.jar</span>.</p>

<p>When you use the Log4J framework with <i>curn</i>, you must specify the
location of the logging configuration file using
system property <span class="code">log4j.configuration</span>
Unlike the <a href="#java.util.logging" class="code">java.util.logging</a>
framework, the argument to <span class="code">log4j.configuration</span> is
not a pathname; it's URL.</p>

<p>To invoke <i>curn</i> on a Unix-like system, so that it
logs through the Log4J framework, you might use a command line like this:</p>

<blockquote>
<pre>java -Dlog4j.configuration=file:///home/bmc/curn/logging.properties org.clapper.curn.Tool --logging /home/bmc/curn/curn.cfg</pre>
</blockquote>

<p>The <a href="#curn-script" class="code">curn</a> shell script installed
by the graphical installer understands <span class="code">-D</span> parameters;
if you use the shell script, you can shorten the above command to:</p>

<blockquote>
<pre>curn -Djava.util.logging.config.file=/home/bmc/curn/logging.properties --logging /home/bmc/curn/curn.cfg</pre>
</blockquote>

<p>Alternatively, you can set those values in the
<span class="env_var">CURN_JAVA_VM_ARGS</span> environment variable, and
<i>curn</i> will automatically supply them to the Java virtual machine.
For example:</p>

<blockquote>
<pre>export CURN_JAVA_VM_ARGS="-Djava.util.logging.config.file=/home/bmc/curn/logging.properties"
curn --logging /home/bmc/.curn/curn.cfg</pre>
</blockquote>

<p>The Windows <a href="#curn-script" class="code">curn.bat</a> command file
currently does not understand <span class="code">-D</span> parameters, so you
must use the
<span class="env_var">CURN_JAVA_VM_ARGS</span> environment variable method.
For instance:

<blockquote>
<pre>set CURN_JAVA_VM_ARGS=-Djava.util.logging.config.file=/home/bmc/curn/logging.properties
curn --logging %HOME%\.curn\curn.cfg</pre>
</blockquote>

<p>Here's a configuration file that writes logs all messages at the
"info" level or lower, to a file. (Change "info" to "debug" to get messages
at the debug level.)</p>

<table class="outlined" align="center" summary="">
  <tr><td><pre>
log4j.rootLogger=info, File
log4j.appender.File=org.apache.log4j.FileAppender
log4j.appender.File.layout=org.apache.log4j.PatternLayout

log4j.appender.File.file=${user.home}/curn/log.out

# Overwrite the file each time
log4j.appender.File.append=false

# Print the date in ISO 8601 format
log4j.appender.File.layout.ConversionPattern=%d %-5p (%c{1}): %m%n

log4j.logger.org.clapper.curn=info</pre>
  </td></tr>
</table>

<p>If you want to have exceptions mailed to you (which can be useful when
running <i>curn</i> from a scheduler, such as <i>cron</i>(8)), then you
have to use the Log4J <span class="code">LevelRangeFilter</span> class to
filter the messages going to individual Log4J appenders. You can't use a
properties-based configuration file in this case, because Log4J's
properties file configurator
<a href="http://wiki.apache.org/logging-log4j/LogToAppenderByLevel">doesn't support filters.</a>
Instead, you must
use an XML configuration file, such as the one shown below.</p>

<table class="outlined" align="center" summary="">
  <tr><td><pre>
&lt;?xml version="1.0" encoding="UTF-8" ?&gt;
&lt;!DOCTYPE log4j:configuration SYSTEM "log4j.dtd"&gt;
&lt;log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/"&gt;

  &lt;appender name="logfile" class="org.apache.log4j.FileAppender"&gt;
    &lt;param name="File" value="${user.home}/.curn/log.out"/&gt;
    &lt;layout class="org.apache.log4j.PatternLayout"&gt;
      &lt;param name="ConversionPattern" value="=%d %-5p (%c{1}): %m%n"/&gt;
    &lt;/layout&gt;
  &lt;/appender&gt;

  &lt;appender name="mail" class="org.apache.log4j.net.SMTPAppender"&gt;
    &lt;param name="BufferSize" value="4096"/&gt;
    &lt;param name="From" value="bmc@clapper.org"/&gt;
    &lt;param name="To" value="bmc@clapper.org"/&gt;
    &lt;param name="Subject" value="curn log message"/&gt;
    &lt;param name="SMTPHost" value="mail.inside.clapper.org"/&gt;
    &lt;layout class="org.apache.log4j.PatternLayout"&gt;
      &lt;param name="ConversionPattern" value="=%d %-5p (%c{1}): %m%n"/&gt;
    &lt;/layout&gt;

    &lt;filter class="org.apache.log4j.varia.LevelRangeFilter"&gt;
      &lt;param name="LevelMin" value="error"/&gt;
      &lt;param name="AcceptOnMatch" value="true"/&gt;
    &lt;/filter&gt;
  &lt;/appender&gt;

  &lt;logger name="org.clapper.curn"&gt;
    &lt;level value="debug"/&gt;
    &lt;appender-ref ref="mail"/&gt;
    &lt;appender-ref ref="logfile"/&gt;
  &lt;/logger&gt;

  &lt;root&gt;
    &lt;level value="fatal"/&gt;
    &lt;appender-ref ref="logfile"/&gt;
    &lt;appender-ref ref="mail"/&gt;
  &lt;/root&gt;
&lt;/log4j:configuration&gt;
</pre>
  </td></tr>
</table>

<p>Note that both files use the
<span class="code">org.clapper.util.misc.JDK14TextLogFormatter</span>
formatter class, instead of the JDK-supplied
<span class="code">java.util.logging.SimpleFormatter</span>. I don't care
for the text format that <span class="code">SimpleFormatter</span> produces,
so I use a formatter in from utility library that produces output that's
similar to the default Log4J text formatter.</p>

<p>Obviously, you can use any formatter you wish, including the
<span class="code">java.util.logging.XMLFormatter</span> class.</p>


<!-- ********************************************************************** -->
<h1><a name="AppendixA"></a>Appendix A: Similar Products and Tools</h1>

<p>Adam Sampson's <a href="http://offog.org/code/rawdog.html"><i>rawdog</i></a>
(RSS Aggregator Without Delusions Of Grandeur) is similar in spirit,
features, and invocation. It's written in Python. Like <i>curn</i>,
<i>rawdog</i> is intended to be run from a scheduler such as <i>cron</i>.</p>

<!-- ********************************************************************** -->
<h1><a name="AppendixB"></a>Appendix B: Copyrights</h1>

<p><i>curn</i> is copyright &copy; 2004-2007 Brian M. Clapper. All rights
reserved. This software is licensed under a
<a href="http://www.clapper.org/software/java/curn/docs/LICENSE">BSD-style license.</a></p>

<p><i>curn</i> uses software (Freemarker) developed by the
<a href="http://www.visigoths.org/">Visigoth Software Society</a>
(<a href="http://www.visigoths.org/" class="url">http://www.visigoths.org/</a>).It is licensed under a BSD-style license.</p>

<p><i>curn</i> uses the <a href="http://asm.objectweb.org/">ASM Bytecode Manipulation Library</a>, which is copyright &copy; 2000-2005 INRIA, France Telecome. All rights reserved.</p>

<p><i>curn</i> uses the Java Mail API and the Java Beans Activation Framework,
which are copyright &copy; Sun Microsystems, Inc.</p>

<p><i>curn</i> uses the Apache
<a href="http://jakarta.apache.org/bsf/">Jakarta Bean Scripting Framework (BSF)</a>,
<a href="http://jakarta.apache.org/commons/logging/">the Jakarta Commons Logging API</a>, and the
<a href="http://xerces.apache.org/xerces2-j/">Apache Xerces XML parser API</a>.
All are copyright &copy; The Apache Software Foundation.</p>

<p><i>curn</i> is integrated with the
<a href="http://informa.sourceforge.net/">Informa RSS parser</a> (though it does not
use that parser by default). Informa is copyright &copy; 2002 Niko Schmuck.</p>

<p><i>curn</i> is integrated with the
<a href="http://rome.java.dev.net/">ROME RSS parser</a> (though it does not
use that parser by default). ROME is copyright &copy; 2004 Sun Microsystems, Inc and is licensed under the
<a href="http://www.apache.org/licenses/LICENSE-2.0">Apache License, Version 2.0</a>.
</p>

<!-- ********************************************************************** -->
<h1><a name="EndNotes"></a>End Notes</h1>

<p class="endnote"><a name="Note1"></a>[1] Normally, adding attachments to
an email message results in a "multipart/mixed" message. According to
<a href="http://www.ietf.org/rfc/rfc1341.txt">RFC 1341</a>, the
differences between "multipart/mixed" and "multipart/alternative"
messages are:</p>
<div class="endnote">
        <table summary="" border="0">
          <tr valign="top">
            <td>multipart/mixed</td>
            <td>Intended for use when the body parts (i.e., the text and the
                attachments) are independent and intended to be displayed
                serially. For example, to send a text message with an
                attached image, you would use a "multipart/mixed" message.
          </tr>

          <tr valign="top">
            <td>multipart/alternative</td>
            <td>Each of the parts (i.e., the main text part and the
                attachments) is an alternative version of the same
                information. The most typical "multipart/alternative"
                message contains a plain text part (i.e., MIME type
                "text/plain") and an HTML text part. Both contain the same
                text, but the HTML part has a "richer" version of it. The
                recipient's mail client should either display the "best"
                version of the message, based on the user's environments
                and preferences; or, it should offer the user a choice of
                which part to view. A mail reader that's capable of
                displaying HTML might choose to ignore the plain text part
                and display only the HTML attachment; by contrast, a mail
                reader that cannot render HTML might choose to display
                only the plain text part.</td>
           </tr>
        </table>
</div>

<p class="endnote"><a name="Note2"></a>[2]
<i>curn</i>'s configuration file is parsed by a subclass of the
<a href="http://www.clapper.org/software/java/util/javadocs/util/api/org/clapper/util/config/Configuration.html" class="code">org.clapper.util.config.Configuration</a>
class, so it implicitly supports all the features provided by that class.

<p class="endnote"><a name="Note3"></a>[3]
It's also possible, though hairy, to escape the special meaning of special
characters via the backslash character. For instance, you can escape the
variable substitution lead-in character, '$', with a backslash. e.g., "\$".
This technique is not recommended, however, because you have to
double-escape any backslash characters that you want to be preserved
literally. For instance, to get "\t", you must specify "\\\\t". To get a
literal backslash, specify "\\\\". (Yes, that's four backslashes, just to
get a single unescaped one.) This double-escaping is a regrettable side
effect of how the configuration file parses variable values: It makes two
separate passes over the value, one for metacharacter expansion and another
for variable expansion. Each of those passes honors and processes backslash
escapes. This problem would go away if the configuration file parser parsed
both metacharacter sequences and variable substitutions itself, in one
pass. It doesn't currently do that, because I wanted to make use of the
existing
<a href="http://www.clapper.org/software/java/util/javadocs/util/api/org/clapper/util/text/XStringBuffer.html"
class="code">org.clapper.util.text.XStringBuffer</a> class's 
<a href="http://www.clapper.org/software/java/util/javadocs/util/api/org/clapper/util/text/XStringBuffer.html#decodeMetacharacters()"
class="code">decodeMetacharacters()</a> method and the 
<a href="http://www.clapper.org/software/java/util/javadocs/util/api/org/clapper/util/text/UnixShellVariableSubstituter.html"
class="code">org.clapper.util.text.UnixShellVariableSubstituter</a> class.
In general, you're better off just sticking with single quotes. I may
eventually fix this problem, but single quotes work now and will continue
to work regardless.

<hr/>
<pre>$Id$</pre>
</body>
</html>
